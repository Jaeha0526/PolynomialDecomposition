(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    375946,       9766]
NotebookOptionsPosition[    352020,       9384]
NotebookOutlinePosition[    352481,       9402]
CellTagsIndexPosition[    352438,       9399]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Polynomials", "Section",
 CellChangeTimes->{{3.828161936786806*^9, 3.828161941567064*^9}, {
  3.928718969127046*^9, 3.9287189778105106`*^9}, {3.9287191263683043`*^9, 
  3.928719129368809*^9}},ExpressionUUID->"47ea2f20-16d1-44f4-bbab-\
2e696ef77cb0"],

Cell[CellGroupData[{

Cell["Generate random polynomial", "Subsection",
 CellChangeTimes->{{3.910295424248437*^9, 3.910295432764516*^9}, {
  3.9287191516032867`*^9, 3.928719157336816*^9}, {3.928723027595667*^9, 
  3.928723031082911*^9}},ExpressionUUID->"5dc52680-a29f-4609-9f68-\
c037a1bab6ee"],

Cell["\<\
generate polynomial with Abs(coefficients) up to intMax and degree up to \
degree\
\>", "Text",
 CellChangeTimes->{{3.9287258853787107`*^9, 
  3.9287259355170355`*^9}},ExpressionUUID->"bd4ecb0d-e460-4b6d-b746-\
91de353d918f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial", "[", 
    RowBox[{
     RowBox[{"coeffMin_Integer", ":", "0"}], ",", "coeffMax_Integer", ",", 
     "degree_Integer", ",", "vars_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numVars", ",", "coeffs", ",", "terms", ",", "exponents"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numVars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exponents", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "degree"}], "]"}], ",", "numVars"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"coeffs", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RandomChoice", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "*", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"coeffMin", ",", "coeffMax"}], "}"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "exponents", "]"}], "-", "1"}]}], "]"}], 
        "\n", "~", "Join", "~", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RandomChoice", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "*", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", "coeffMin"}], "]"}], ",", "coeffMax"}], "}"}],
            "]"}]}], "}"}]}]}], ";", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "make", " ", "sure", " ", "the", " ", "max", " ", "degree", " ", 
        "term", " ", 
        RowBox[{"doesn", "'"}], "t", " ", "vanish"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"terms", "=", 
       RowBox[{"coeffs", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "#"}], ")"}]}], "&"}], "/@", "exponents"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "terms", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9102943629021096`*^9, 3.910294368967478*^9}, {
  3.9102944354620247`*^9, 3.910294446559577*^9}, {3.910294477039682*^9, 
  3.910294527138598*^9}, {3.9102945901587725`*^9, 3.910294594753267*^9}, {
  3.928725427565085*^9, 3.928725459003504*^9}, {3.928725776486603*^9, 
  3.928725776990258*^9}, {3.928725817197404*^9, 3.9287258281052294`*^9}, {
  3.9287260328307705`*^9, 3.928726062254898*^9}, {3.9356911402171497`*^9, 
  3.935691184899344*^9}, {3.937091839769278*^9, 3.93709184016482*^9}, {
  3.937092035891499*^9, 3.9370920600616426`*^9}, {3.9370921004995117`*^9, 
  3.937092129130714*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"d282661d-5bcf-47fb-8f77-38459f406031"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial", "[", 
  RowBox[{"8", ",", "5", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.927392154283261*^9, 3.927392167263013*^9}, 
   3.927392251851519*^9, {3.927393212611227*^9, 
   3.927393213340988*^9}},ExpressionUUID->"06c4cc07-ea2b-4731-acd5-\
c1e7922331b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "5"}], "+", 
  RowBox[{"4", " ", "x"}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox["x", "2"]}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["x", "3"]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["x", "4"]}], "-", 
  RowBox[{"5", " ", 
   SuperscriptBox["x", "5"]}], "-", 
  RowBox[{"3", " ", "y"}], "+", 
  RowBox[{"4", " ", "x", " ", "y"}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox["x", "2"], " ", "y"}], "-", 
  RowBox[{
   SuperscriptBox["x", "3"], " ", "y"}], "-", 
  RowBox[{"7", " ", 
   SuperscriptBox["x", "4"], " ", "y"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["y", "2"]}], "-", 
  RowBox[{"5", " ", "x", " ", 
   SuperscriptBox["y", "2"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["x", "3"], " ", 
   SuperscriptBox["y", "2"]}], "-", 
  RowBox[{"5", " ", 
   SuperscriptBox["x", "4"], " ", 
   SuperscriptBox["y", "2"]}], "-", 
  RowBox[{"7", " ", 
   SuperscriptBox["x", "5"], " ", 
   SuperscriptBox["y", "2"]}], "-", 
  RowBox[{"5", " ", 
   SuperscriptBox["y", "3"]}], "-", 
  RowBox[{"4", " ", "x", " ", 
   SuperscriptBox["y", "3"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["y", "3"]}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["x", "3"], " ", 
   SuperscriptBox["y", "3"]}], "-", 
  RowBox[{
   SuperscriptBox["x", "4"], " ", 
   SuperscriptBox["y", "3"]}], "+", 
  RowBox[{
   SuperscriptBox["x", "5"], " ", 
   SuperscriptBox["y", "3"]}], "-", 
  RowBox[{"7", " ", 
   SuperscriptBox["y", "4"]}], "-", 
  RowBox[{"6", " ", "x", " ", 
   SuperscriptBox["y", "4"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["y", "4"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["x", "3"], " ", 
   SuperscriptBox["y", "4"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["x", "4"], " ", 
   SuperscriptBox["y", "4"]}], "-", 
  RowBox[{
   SuperscriptBox["x", "5"], " ", 
   SuperscriptBox["y", "4"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["y", "5"]}], "+", 
  RowBox[{"5", " ", "x", " ", 
   SuperscriptBox["y", "5"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["x", "2"], " ", 
   SuperscriptBox["y", "5"]}], "-", 
  RowBox[{"6", " ", 
   SuperscriptBox["x", "3"], " ", 
   SuperscriptBox["y", "5"]}], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox["x", "4"], " ", 
   SuperscriptBox["y", "5"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["x", "5"], " ", 
   SuperscriptBox["y", "5"]}]}]], "Output",
 CellChangeTimes->{3.9287191799587717`*^9, 
  3.9287258719902115`*^9},ExpressionUUID->"15a5033b-f2dc-4766-a6ba-\
62db7d1663bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial", "[", 
  RowBox[{"3", ",", "2", ",", 
   RowBox[{"{", "y", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.927392884952552*^9, 3.927392888582435*^9}, {
  3.9356911970729713`*^9, 3.93569120359803*^9}, {3.9370920767908688`*^9, 
  3.937092076861104*^9}},
 CellLabel->
  "In[581]:=",ExpressionUUID->"a86103ba-d5be-4b49-806a-4b40f801e7d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", "y", "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["y", "2"]}]}]], "Output",
 CellChangeTimes->{
  3.9287191888067603`*^9, 3.928725875030543*^9, {3.93569119798284*^9, 
   3.935691206183474*^9}, {3.937092069913118*^9, 3.937092086587339*^9}, {
   3.937092118473161*^9, 3.9370921383717318`*^9}, 3.937654521507152*^9},
 CellLabel->
  "Out[581]=",ExpressionUUID->"3b304af7-08da-46d7-983f-711b5fa9f571"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$WithHighestCoeff1", "[", 
    RowBox[{
     RowBox[{"intMin_Integer", ":", "0"}], ",", "intMax_", ",", "degree_", 
     ",", "vars_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numVars", ",", "coeffs", ",", "terms", ",", "exponents"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numVars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exponents", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "degree"}], "]"}], ",", "numVars"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"coeffs", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RandomChoice", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "*", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"intMin", ",", "intMax"}], "}"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "exponents", "]"}], "-", "1"}]}], "]"}], 
        "~", "Join", "~", 
        RowBox[{"{", "1", "}"}]}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"terms", "=", 
       RowBox[{"coeffs", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "#"}], ")"}]}], "&"}], "/@", "exponents"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "terms", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.9102943629021096`*^9, 3.910294368967478*^9}, {
   3.9102944354620247`*^9, 3.910294446559577*^9}, {3.910294477039682*^9, 
   3.910294527138598*^9}, {3.9102945901587725`*^9, 3.910294594753267*^9}, {
   3.928722874392534*^9, 3.9287229078199205`*^9}, {3.928725949584319*^9, 
   3.928725949955789*^9}, {3.93569327450289*^9, 3.935693308378077*^9}, 
   3.935693350854281*^9, {3.937091061585359*^9, 3.937091080869906*^9}, {
   3.937091206550571*^9, 3.937091209057114*^9}, {3.937091325073715*^9, 
   3.937091325404924*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"6bb80cd8-247b-4956-9168-e1bf55b7bedf"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"RandomPolynomial$WithHighestCoeff1", "[", 
  RowBox[{"5", ",", "3", ",", 
   RowBox[{"{", "a", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RandomPolynomial$WithHighestCoeff1", "[", 
  RowBox[{"1", ",", "5", ",", "2", ",", "4", ",", 
   RowBox[{"{", "a", "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.927734269526569*^9, 3.927734294011536*^9}, {
   3.927734373316735*^9, 3.927734374496362*^9}, {3.927808774415358*^9, 
   3.927808776530246*^9}, 3.9287229194212465`*^9, {3.9356933251204367`*^9, 
   3.935693329757094*^9}, {3.937091097486487*^9, 3.937091133750141*^9}, {
   3.93709116805596*^9, 3.937091169412229*^9}},
 CellLabel->
  "In[1219]:=",ExpressionUUID->"652e8c0a-1b3f-49a8-9087-0cd3c1da80b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "5"}], " ", "a"}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "2"]}], "+", 
  SuperscriptBox["a", "3"]}]], "Output",
 CellChangeTimes->{{3.9287229198212357`*^9, 3.928722924363274*^9}, {
  3.9287259602067113`*^9, 3.928725962640104*^9}, {3.935693330153783*^9, 
  3.935693358192719*^9}, {3.9370910934043903`*^9, 3.937091226648343*^9}, {
  3.93709125845873*^9, 3.937091264252529*^9}, {3.937091329074498*^9, 
  3.9370913316592417`*^9}},
 CellLabel->
  "Out[1219]=",ExpressionUUID->"2c7013c1-8abd-460f-9a4a-5feb05022935"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], "-", 
  RowBox[{"3", " ", "a"}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["a", "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["a", "3"]}], "+", 
  SuperscriptBox["a", "4"]}]], "Output",
 CellChangeTimes->{{3.9287229198212357`*^9, 3.928722924363274*^9}, {
  3.9287259602067113`*^9, 3.928725962640104*^9}, {3.935693330153783*^9, 
  3.935693358192719*^9}, {3.9370910934043903`*^9, 3.937091226648343*^9}, {
  3.93709125845873*^9, 3.937091264252529*^9}, {3.937091329074498*^9, 
  3.937091331663286*^9}},
 CellLabel->
  "Out[1220]=",ExpressionUUID->"acaf100e-9d5e-4182-9828-1d65a974ad0a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$NoConst", "[", 
    RowBox[{
     RowBox[{"intMin_Integer", ":", "0"}], ",", "intMax_", ",", "degree_", 
     ",", "vars_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numVars", ",", "coeffs", ",", "terms", ",", "exponents"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numVars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exponents", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "degree"}], "]"}], ",", "numVars"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"coeffs", "=", 
       RowBox[{
        RowBox[{"{", "0", "}"}], "~", "Join", "~", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"RandomChoice", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "*", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"intMin", ",", "intMax"}], "}"}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "exponents", "]"}], "-", "2"}]}], "]"}], 
        "\n", "~", "Join", "~", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RandomChoice", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "*", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Max", "[", 
              RowBox[{"1", ",", "intMin"}], "]"}], ",", "intMax"}], "}"}], 
           "]"}]}], "}"}]}]}], ";", "\n", 
      RowBox[{"(*", " ", 
       RowBox[{
       "make", " ", "sure", " ", "that", " ", "the", " ", "highest", " ", 
        "degree", " ", "does", " ", "not", " ", "vanish"}], " ", "*)"}], "\n", 
      RowBox[{"terms", "=", 
       RowBox[{"coeffs", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "#"}], ")"}]}], "&"}], "/@", "exponents"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "terms", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.9102943629021096`*^9, 3.910294368967478*^9}, {
   3.9102944354620247`*^9, 3.910294446559577*^9}, {3.910294477039682*^9, 
   3.910294527138598*^9}, {3.9102945901587725`*^9, 3.910294594753267*^9}, {
   3.927734239031236*^9, 3.927734277437504*^9}, {3.927734320399848*^9, 
   3.927734359399213*^9}, {3.927808753485035*^9, 3.9278087690112047`*^9}, {
   3.928722947521467*^9, 3.928722999943108*^9}, {3.9287259545105486`*^9, 
   3.9287259548822*^9}, {3.9356934262870703`*^9, 3.935693472522745*^9}, {
   3.93709149534944*^9, 3.937091569421623*^9}, {3.937091612585915*^9, 
   3.93709162129362*^9}, 3.937091805830208*^9, 3.937092144354547*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"62705237-0577-434f-824e-1c32165b2fad"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Tuples", "[", 
  RowBox[{
   RowBox[{"Range", "[", 
    RowBox[{"0", ",", "3"}], "]"}], ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.937091464691338*^9, 3.937091485681292*^9}},
 CellLabel->
  "In[1230]:=",ExpressionUUID->"23511e11-a739-4801-9b1f-dd5abd84b904"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "3", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.937091475141391*^9, 3.937091486027019*^9}, 
   3.937091623364983*^9},
 CellLabel->
  "Out[1230]=",ExpressionUUID->"d0edc7ff-98b9-48e5-9d89-f6dfdb3fdba6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial$NoConst", "[", 
  RowBox[{"5", ",", "2", ",", 
   RowBox[{"{", "a", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.937091576003522*^9, 3.937091591591818*^9}, {
  3.937091633992591*^9, 3.937091636319798*^9}},
 CellLabel->
  "In[1241]:=",ExpressionUUID->"a8684af1-03d4-49ab-bff4-16b20dd4ac14"],

Cell[BoxData[
 RowBox[{"a", "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["a", "2"]}]}]], "Output",
 CellChangeTimes->{3.937091636835312*^9},
 CellLabel->
  "Out[1241]=",ExpressionUUID->"ec0dcd76-4dda-4c56-acd3-a0a638c213ec"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"RandomPolynomial$NoConst", "[", 
  RowBox[{"5", ",", "3", ",", 
   RowBox[{"{", "a", "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"RandomPolynomial$NoConst", "[", 
  RowBox[{"3", ",", "5", ",", "3", ",", 
   RowBox[{"{", "a", "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.928723013296027*^9, {3.935693475421879*^9, 3.935693477547715*^9}, {
   3.937090688202851*^9, 3.937090689220654*^9}, {3.937090719327743*^9, 
   3.937090758378504*^9}},
 CellLabel->
  "In[1101]:=",ExpressionUUID->"9844a4b9-2e81-4fdf-a83f-83eb46874303"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "5"}], " ", 
   SuperscriptBox["a", "2"]}], "+", 
  RowBox[{"5", " ", 
   SuperscriptBox["a", "3"]}]}]], "Output",
 CellChangeTimes->{{3.928723013910879*^9, 3.928723016245384*^9}, {
  3.9287259689692273`*^9, 3.9287259755574884`*^9}, {3.935693477938032*^9, 
  3.935693487186359*^9}, {3.937090655537547*^9, 3.9370906854690638`*^9}, {
  3.937090719874136*^9, 3.937090758872794*^9}},
 CellLabel->
  "Out[1101]=",ExpressionUUID->"5d9ffc44-ee7e-4ac1-b325-27d2a4c34216"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "3"}], " ", "a"}], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox["a", "2"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["a", "3"]}]}]], "Output",
 CellChangeTimes->{{3.928723013910879*^9, 3.928723016245384*^9}, {
  3.9287259689692273`*^9, 3.9287259755574884`*^9}, {3.935693477938032*^9, 
  3.935693487186359*^9}, {3.937090655537547*^9, 3.9370906854690638`*^9}, {
  3.937090719874136*^9, 3.93709075887599*^9}},
 CellLabel->
  "Out[1102]=",ExpressionUUID->"27a7a279-d431-4512-bc67-b66793bb538f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "possible", " ", "to", " ", "set", " ", "number", " ", "of", " ", 
    "terms"}], ",", " ", 
   RowBox[{"fix", " ", "total", " ", "degree"}], ",", " ", 
   RowBox[{"no", " ", "constant", " ", "term"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.931963634021542*^9, 3.9319636606278667`*^9}, {
   3.931963693775538*^9, 3.931963703408579*^9}, 3.931965856787633*^9, {
   3.931967466458075*^9, 
   3.931967469165677*^9}},ExpressionUUID->"acf96fd8-0899-4965-99e6-\
68413f8d7302"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$maxlength", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$maxlength", "[", 
    RowBox[{
     RowBox[{"coeffmin_Integer", ":", "0"}], ",", "coeffMax_Integer", ",", 
     "degree_Integer", ",", "vars_List", ",", "numterms_Integer"}], "]"}], ":=",
    "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numVars", ",", "coeffs", ",", "terms", ",", "exponents"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numVars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exponents", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "degree"}], "]"}], ",", "numVars"}], "]"}], ",", 
         RowBox[{
          RowBox[{"0", "<", 
           RowBox[{"Total", "[", "#", "]"}], "<=", "degree"}], "&"}]}], 
        "]"}]}], ";", "\n", 
      RowBox[{"exponents", "=", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"exponents", ",", "numterms"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coeffs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomChoice", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "*", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"coeffmin", ",", "coeffMax"}], "}"}], "]"}]}], ",", 
         RowBox[{"Length", "[", "exponents", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"terms", "=", 
       RowBox[{"coeffs", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "#"}], ")"}]}], "&"}], "/@", "exponents"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "terms", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9102943629021096`*^9, 3.910294368967478*^9}, {
  3.9102944354620247`*^9, 3.910294446559577*^9}, {3.910294477039682*^9, 
  3.910294527138598*^9}, {3.9102945901587725`*^9, 3.910294594753267*^9}, {
  3.928725427565085*^9, 3.928725459003504*^9}, {3.928725776486603*^9, 
  3.928725776990258*^9}, {3.928725817197404*^9, 3.9287258281052294`*^9}, {
  3.9287260328307705`*^9, 3.928726062254898*^9}, {3.931963568717085*^9, 
  3.931963640370986*^9}, {3.931963764624497*^9, 3.931963765487997*^9}, {
  3.931965626095025*^9, 3.9319656995813103`*^9}, {3.931965774232936*^9, 
  3.931965865487872*^9}, {3.931967480903026*^9, 3.931967481406573*^9}, {
  3.935670487801878*^9, 3.935670506581607*^9}, {3.935670564507903*^9, 
  3.935670588754968*^9}, {3.9356706551365643`*^9, 3.935670676468829*^9}, {
  3.9356707432794313`*^9, 3.935670746314154*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"f5c3b839-23a3-441d-9f55-c189dc41d02e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"RandomPolynomial$maxlength", "[", 
  RowBox[{"5", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "4"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"RandomPolynomial$maxlength", "[", 
  RowBox[{"9", ",", "10", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}], ",", "4"}], "]"}]}], "Input",
 CellChangeTimes->{{3.931966680718521*^9, 3.931966695431353*^9}, {
  3.931967492026464*^9, 3.9319675182645493`*^9}, {3.935670697305973*^9, 
  3.935670718365632*^9}},
 CellLabel->
  "In[152]:=",ExpressionUUID->"711d3f9e-c8d6-4956-a4e9-8f3064f7ed90"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "2"}], " ", 
   SuperscriptBox["x", "2"]}], "-", "y", "-", 
  RowBox[{"x", " ", "z"}], "-", 
  RowBox[{"2", " ", "y", " ", "z"}]}]], "Output",
 CellChangeTimes->{{3.931966692966309*^9, 3.931966697722089*^9}, {
  3.931967485319642*^9, 3.931967518537253*^9}, {3.935670690521687*^9, 
  3.935670783538202*^9}},
 CellLabel->
  "Out[152]=",ExpressionUUID->"b9b54db1-4ccc-4392-a03c-97a1f37ea3fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "10"}], " ", "y"}], "-", 
  RowBox[{"9", " ", "x", " ", "y"}], "+", 
  RowBox[{"10", " ", 
   SuperscriptBox["y", "2"]}], "+", 
  RowBox[{"9", " ", 
   SuperscriptBox["z", "2"]}]}]], "Output",
 CellChangeTimes->{{3.931966692966309*^9, 3.931966697722089*^9}, {
  3.931967485319642*^9, 3.931967518537253*^9}, {3.935670690521687*^9, 
  3.935670783541438*^9}},
 CellLabel->
  "Out[153]=",ExpressionUUID->"9c674b4e-1a8c-43e2-9707-c788f0259aa0"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$maxlength$fix", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$maxlength$fix", "[", 
    RowBox[{
    "coeffMax_Integer", ",", "degree_Integer", ",", "vars_List", ",", 
     "numterms_Integer"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"numVars", ",", "coeffs", ",", "terms", ",", "exponents"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numVars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"exponents", "=", 
       RowBox[{"Select", "[", 
        RowBox[{
         RowBox[{"Tuples", "[", 
          RowBox[{
           RowBox[{"Range", "[", 
            RowBox[{"0", ",", "degree"}], "]"}], ",", "numVars"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Total", "[", "#", "]"}], "==", "degree"}], "&"}]}], 
        "]"}]}], ";", "\n", 
      RowBox[{"exponents", "=", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"exponents", ",", "numterms"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"coeffs", "=", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "coeffMax"}], ",", "coeffMax"}], "}"}], ",", 
         RowBox[{"Length", "[", "exponents", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"terms", "=", 
       RowBox[{"coeffs", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "#"}], ")"}]}], "&"}], "/@", "exponents"}], 
         ")"}]}]}], ";", "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Total", "[", "terms", "]"}], "==", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"RandomPolynomial$maxlength$fix", "[", 
          RowBox[{"coeffMax", ",", "degree", ",", "vars", ",", "numterms"}], 
          "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "terms", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9102943629021096`*^9, 3.910294368967478*^9}, {
  3.9102944354620247`*^9, 3.910294446559577*^9}, {3.910294477039682*^9, 
  3.910294527138598*^9}, {3.9102945901587725`*^9, 3.910294594753267*^9}, {
  3.928725427565085*^9, 3.928725459003504*^9}, {3.928725776486603*^9, 
  3.928725776990258*^9}, {3.928725817197404*^9, 3.9287258281052294`*^9}, {
  3.9287260328307705`*^9, 3.928726062254898*^9}, {3.931963568717085*^9, 
  3.931963640370986*^9}, {3.931963764624497*^9, 3.931963765487997*^9}, {
  3.931965626095025*^9, 3.9319656995813103`*^9}, {3.931965774232936*^9, 
  3.931965865487872*^9}, {3.931967480903026*^9, 3.931967481406573*^9}, {
  3.932592265316774*^9, 3.9325922862071867`*^9}, {3.9325927778618793`*^9, 
  3.932592818589635*^9}, {3.932592959116726*^9, 3.932592962925819*^9}},
 CellLabel->"In[22]:=",ExpressionUUID->"66356eb2-9c8a-49fc-bc7c-53fd5ab5001d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Random polynomial of O(N) singlet : {long, short, substitute}  (LSS format)\
\>", "Subsection",
 CellChangeTimes->{{3.910295424248437*^9, 3.910295432764516*^9}, {
  3.9287191516032867`*^9, 3.928719157336816*^9}, {3.9287196631212034`*^9, 
  3.928719672917498*^9}, {3.928720445587044*^9, 3.928720473553329*^9}, {
  3.928723130479866*^9, 3.9287231331701074`*^9}, {3.928723313622714*^9, 
  3.928723339387235*^9}, {3.928723376388587*^9, 
  3.928723380517714*^9}},ExpressionUUID->"d1119568-e941-4711-8283-\
8faf049cc0de"],

Cell[TextData[{
 "Generate ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"s", "(", 
     RowBox[{
      SubscriptBox["a", "1"], ",", 
      SubscriptBox["a", "2"], ",", "..."}], ")"}], ")"}], TraditionalForm]],
  ExpressionUUID->"88d507cf-499d-4c71-a815-8be70f55eeca"],
 " where ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]],ExpressionUUID->
  "74aaa48a-dcd5-4e18-83ee-636b6c1a0898"],
 " is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"O", "(", "N", ")"}], TraditionalForm]],ExpressionUUID->
  "6feec41b-4ed9-4d76-a9db-b464464c7573"],
 " singlet of the form ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{
     SubscriptBox["v", "i"], ".", 
     SubscriptBox["v", "j"]}]}], TraditionalForm]],ExpressionUUID->
  "207bc536-f7e0-4324-ac2f-2ca46b9cfb38"],
 " where ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["v", "i"], ",", 
    SubscriptBox["v", "j"]}], TraditionalForm]],ExpressionUUID->
  "6ab1984b-fe5a-4922-b1ad-71b2f80d3e7a"],
 " are O(N) vectors whose components are labeled as ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "44d3c93a-3525-4c2f-801f-998f80236612"],
 " .\n\nRandomPolynomial$ON$LSS : generate polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", "s", ")"}], TraditionalForm]],ExpressionUUID->
  "9f81f6d9-1918-4303-b568-7cfd640c8d5b"],
 " with coefficient up to intMax and degree up to degMax   for  O(Ngroup) and \
Nvec vectors\n\nReturn : {long, short, substitute} ,  means ",
 Cell[BoxData[
  FormBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"f", "(", 
      RowBox[{"s", "(", 
       RowBox[{
        SubscriptBox["a", "1"], ",", 
        SubscriptBox["a", "2"], ",", "..."}], ")"}], ")"}], ",", 
     RowBox[{"f", "(", "s", ")"}], ",", 
     RowBox[{"s", "(", 
      RowBox[{
       SubscriptBox["a", "1"], ",", 
       SubscriptBox["a", "2"], ",", "..."}], ")"}]}], "}"}], 
   TraditionalForm]],ExpressionUUID->"9752fb52-9a76-4d34-b4a3-6705bebb990a"]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.928723568327907*^9, 3.928723570637114*^9}, {
  3.928723617600646*^9, 3.928723840611044*^9}, {3.928723937232083*^9, 
  3.9287239990176015`*^9}},ExpressionUUID->"2c08e1d0-8d13-4118-ac79-\
377d21bf36cd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
     RowBox[{"Ngroup_", ",", "nvec_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"a", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Ngroup", " ", "nvec"}]}], "}"}]}], "]"}], "//", 
     RowBox[{
      RowBox[{"Partition", "[", 
       RowBox[{"#", ",", "Ngroup"}], "]"}], "&"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$ON$LSS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$ON$LSS", "[", 
    RowBox[{"intMax_", ",", "degMax_", ",", "Ngroup_", ",", "Nvec_", ",", 
     RowBox[{"selectionrule_", ":", "None"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"short", ",", "substitute", ",", "long$expand", ",", "long"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial", "[", 
        RowBox[{"intMax", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "degMax"}], "}"}], "]"}], ",", 
         RowBox[{"{", "s", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"substitute", "=", 
       RowBox[{
        RowBox[{"RandomChoice", "[", 
         RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
          RowBox[{"Ngroup", ",", "Nvec"}], "]"}], "]"}], ".", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
          RowBox[{"Ngroup", ",", "Nvec"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"short", ",", "s"}], "]"}], "\[LessEqual]", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"RandomPolynomial$ON$LSS", "[", 
          RowBox[{
          "intMax", ",", "degMax", ",", "Ngroup", ",", "Nvec", ",", 
           "selectionrule"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "long"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"short", "/.", 
           RowBox[{"s", "\[Rule]", "substitute"}]}], "//", "Expand"}], ",", 
         RowBox[{"short", "/.", 
          RowBox[{"s", "\[Rule]", "substitute"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning : \>\"", ",", "short", ",", " ", "\"\< s=\>\"", ",", 
          "substitute"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"selectionrule", "=!=", "None"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"selectionrule", "[", 
            RowBox[{"{", 
             RowBox[{"long$expand", ",", "short", ",", "substitute"}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"RandomPolynomial$ON$LSS", "[", 
            RowBox[{
            "intMax", ",", "degMax", ",", "Ngroup", ",", "Nvec", ",", 
             "selectionrule"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"long$expand", ",", "short", ",", "substitute"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.910294947522999*^9, 3.910295017117368*^9}, {
   3.910295068439144*^9, 3.910295156511194*^9}, {3.9102952092017775`*^9, 
   3.91029526382847*^9}, {3.910295303512858*^9, 3.910295303687517*^9}, {
   3.910295529208321*^9, 3.9102955320719504`*^9}, {3.910297027519416*^9, 
   3.910297035958167*^9}, {3.910297662950338*^9, 3.910297727715647*^9}, {
   3.910297760120126*^9, 3.910297761281871*^9}, {3.92704318730638*^9, 
   3.927043192190755*^9}, {3.927138888800555*^9, 3.927138904565436*^9}, {
   3.927138937654853*^9, 3.927138937828744*^9}, {3.927139061963217*^9, 
   3.927139066450791*^9}, {3.927139621271799*^9, 3.927139629641084*^9}, {
   3.927393152467615*^9, 3.927393173242029*^9}, {3.927401884568942*^9, 
   3.927401902549439*^9}, {3.927401955190461*^9, 3.927401957855886*^9}, {
   3.9274028346011543`*^9, 3.927402887548622*^9}, {3.927402921958266*^9, 
   3.927402969695958*^9}, {3.927638133559576*^9, 3.927638135579191*^9}, {
   3.927643043055172*^9, 3.927643044829177*^9}, {3.927647658522184*^9, 
   3.927647660381823*^9}, {3.927656487078076*^9, 3.927656489846347*^9}, {
   3.927656520069233*^9, 3.927656582790732*^9}, {3.927656633407508*^9, 
   3.927656650813065*^9}, 3.927733236534539*^9, {3.928723413535059*^9, 
   3.928723453053375*^9}, {3.928723494086993*^9, 3.928723507352765*^9}, {
   3.928723801525802*^9, 3.928723815946874*^9}, {3.9287239270044646`*^9, 
   3.928723932452038*^9}, {3.9287240109568005`*^9, 3.92872401650064*^9}, {
   3.928724057205659*^9, 3.928724104124919*^9}, {3.928986774347148*^9, 
   3.9289869306594024`*^9}, {3.92907361724364*^9, 3.9290736251945667`*^9}},
 CellLabel->"In[24]:=",ExpressionUUID->"2de0f464-a529-456f-877f-82002aa97e23"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
  RowBox[{"3", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.9480683951076603`*^9, 3.9480683981665783`*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"7725faa5-f722-43c6-b235-ff7def720a26"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}], ",", 
     RowBox[{"a", "[", "3", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "4", "]"}], ",", 
     RowBox[{"a", "[", "5", "]"}], ",", 
     RowBox[{"a", "[", "6", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9480683930374126`*^9, 3.948068401160722*^9}},
 CellLabel->
  "Out[109]=",ExpressionUUID->"96da4854-bd91-407a-b52d-1ade2b92498c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"RandomPolynomial$ON$LSS", "[", 
  RowBox[{"5", ",", "3", ",", "2", ",", "3"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "//", "ComplexityCriteria"}]}], "Input",
 CellChangeTimes->{{3.928723862202262*^9, 3.928723884749745*^9}, {
  3.928724188418924*^9, 
  3.928724191367677*^9}},ExpressionUUID->"168ed261-b080-48e2-8cba-\
9975efa59674"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"4", "-", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "3", "]"}], "2"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "3", "]"}], "6"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "4", "]"}], "2"]}], "+", 
    RowBox[{"9", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "3", "]"}], "4"], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "4", "]"}], "2"]}], "+", 
    RowBox[{"9", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "3", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "4", "]"}], "6"]}]}], ",", 
   RowBox[{"4", "-", 
    RowBox[{"2", " ", "s"}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["s", "3"]}]}], ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"a", "[", "4", "]"}], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.928723885312316*^9, 3.928724106530346*^9, {3.9287241917408476`*^9, 
   3.928724211374241*^9}, 3.92872611161255*^9, {3.928906505462821*^9, 
   3.9289065108776493`*^9}},ExpressionUUID->"c7fd5f2a-c609-4e8c-b81f-\
b10583efc3ca"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.928723885312316*^9, 3.928724106530346*^9, {3.9287241917408476`*^9, 
   3.928724211374241*^9}, 3.92872611161255*^9, {3.928906505462821*^9, 
   3.928906510881716*^9}},ExpressionUUID->"7c9c811a-63af-48b3-b8b1-\
0bd90afcecfb"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$ON$LSS2", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$ON$LSS2", "[", 
    RowBox[{"intMax_", ",", "degMax_", ",", "Ngroup_", ",", "Nvec_", ",", 
     RowBox[{"selectionrule_", ":", "None"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", "substitute", ",", "substitute1", ",", "substitute2", ",",
        "substitute3", ",", "long$expand", ",", "long"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial", "[", 
        RowBox[{"intMax", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "degMax"}], "}"}], "]"}], ",", 
         RowBox[{"{", "s", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"substitute1", "=", 
       RowBox[{
        RowBox[{"RandomChoice", "[", 
         RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
          RowBox[{"Ngroup", ",", "Nvec"}], "]"}], "]"}], ".", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
          RowBox[{"Ngroup", ",", "Nvec"}], "]"}], "]"}]}]}], ";", "\n", 
      RowBox[{"substitute2", "=", 
       RowBox[{
        RowBox[{"RandomChoice", "[", 
         RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
          RowBox[{"Ngroup", ",", "Nvec"}], "]"}], "]"}], ".", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
          RowBox[{"Ngroup", ",", "Nvec"}], "]"}], "]"}]}]}], ";", "\n", 
      RowBox[{"substitute3", "=", 
       RowBox[{
        RowBox[{"RandomChoice", "[", 
         RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
          RowBox[{"Ngroup", ",", "Nvec"}], "]"}], "]"}], ".", 
        RowBox[{"RandomChoice", "[", 
         RowBox[{"RandomPolynomial$ON$LSS$VecList", "[", 
          RowBox[{"Ngroup", ",", "Nvec"}], "]"}], "]"}]}]}], ";", "\n", 
      RowBox[{"substitute", "=", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}], "]"}], "*", 
          "substitute1"}], "+", 
         RowBox[{
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}], "]"}], "*", 
          "substitute2"}], "+", 
         RowBox[{
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "5"}], "}"}], "]"}], "*", 
          "substitute3"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"short", ",", "s"}], "]"}], "\[LessEqual]", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"RandomPolynomial$ON$LSS2", "[", 
          RowBox[{
          "intMax", ",", "degMax", ",", "Ngroup", ",", "Nvec", ",", 
           "selectionrule"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "long"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"short", "/.", 
           RowBox[{"s", "\[Rule]", "substitute"}]}], "//", "Expand"}], ",", 
         RowBox[{"short", "/.", 
          RowBox[{"s", "\[Rule]", "substitute"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"long$expand", "===", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning : \>\"", ",", "short", ",", " ", "\"\< s=\>\"", ",", 
            "substitute"}], "]"}]}], "]"}], ";"}], "*)"}], "\n", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"RandomPolynomial$ON$LSS2", "[", 
          RowBox[{
          "intMax", ",", "degMax", ",", "Ngroup", ",", "Nvec", ",", 
           "selectionrule"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"selectionrule", "=!=", "None"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"selectionrule", "[", 
            RowBox[{"{", 
             RowBox[{"long$expand", ",", "short", ",", "substitute"}], "}"}], 
            "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"RandomPolynomial$ON$LSS2", "[", 
            RowBox[{
            "intMax", ",", "degMax", ",", "Ngroup", ",", "Nvec", ",", 
             "selectionrule"}], "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"long$expand", ",", "short", ",", "substitute"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.910294947522999*^9, 3.910295017117368*^9}, {
   3.910295068439144*^9, 3.910295156511194*^9}, {3.9102952092017775`*^9, 
   3.91029526382847*^9}, {3.910295303512858*^9, 3.910295303687517*^9}, {
   3.910295529208321*^9, 3.9102955320719504`*^9}, {3.910297027519416*^9, 
   3.910297035958167*^9}, {3.910297662950338*^9, 3.910297727715647*^9}, {
   3.910297760120126*^9, 3.910297761281871*^9}, {3.92704318730638*^9, 
   3.927043192190755*^9}, {3.927138888800555*^9, 3.927138904565436*^9}, {
   3.927138937654853*^9, 3.927138937828744*^9}, {3.927139061963217*^9, 
   3.927139066450791*^9}, {3.927139621271799*^9, 3.927139629641084*^9}, {
   3.927393152467615*^9, 3.927393173242029*^9}, {3.927401884568942*^9, 
   3.927401902549439*^9}, {3.927401955190461*^9, 3.927401957855886*^9}, {
   3.9274028346011543`*^9, 3.927402887548622*^9}, {3.927402921958266*^9, 
   3.927402969695958*^9}, {3.927638133559576*^9, 3.927638135579191*^9}, {
   3.927643043055172*^9, 3.927643044829177*^9}, {3.927647658522184*^9, 
   3.927647660381823*^9}, {3.927656487078076*^9, 3.927656489846347*^9}, {
   3.927656520069233*^9, 3.927656582790732*^9}, {3.927656633407508*^9, 
   3.927656650813065*^9}, 3.927733236534539*^9, {3.928723413535059*^9, 
   3.928723453053375*^9}, {3.928723494086993*^9, 3.928723507352765*^9}, {
   3.928723801525802*^9, 3.928723815946874*^9}, {3.9287239270044646`*^9, 
   3.928723932452038*^9}, {3.9287240109568005`*^9, 3.92872401650064*^9}, {
   3.928724057205659*^9, 3.928724104124919*^9}, {3.928986774347148*^9, 
   3.9289869306594024`*^9}, {3.92907361724364*^9, 3.9290736251945667`*^9}, {
   3.948068473796217*^9, 3.94806856707576*^9}, {3.9480686321831923`*^9, 
   3.9480686349862003`*^9}, {3.9480686858566923`*^9, 3.948068691093577*^9}, {
   3.948068752746497*^9, 3.948068764070298*^9}, {3.9480688471063137`*^9, 
   3.9480688503258257`*^9}, 3.948069440275968*^9, {3.948069474204212*^9, 
   3.948069525625681*^9}, {3.9480696934165487`*^9, 3.94806970756997*^9}, {
   3.9480701531134167`*^9, 3.948070157958362*^9}, {3.948070193287298*^9, 
   3.948070205141083*^9}, {3.9480702601980057`*^9, 3.9480702615004663`*^9}, {
   3.948070317119615*^9, 3.948070361929593*^9}, {3.948070491771283*^9, 
   3.948070495997901*^9}, {3.950318707220649*^9, 
   3.950318726430002*^9}},ExpressionUUID->"4a1bcfcd-094e-48a3-8eb4-\
89103d2d4a54"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial$ON$LSS2", "[", 
  RowBox[{"10", ",", "2", ",", "2", ",", "10"}], "]"}]], "Input",
 CellChangeTimes->{{3.948068581499605*^9, 3.948068621421036*^9}, {
  3.948068710036626*^9, 3.948068720979216*^9}, {3.9480687729332047`*^9, 
  3.948068773955805*^9}, {3.9480695441352873`*^9, 3.948069552989903*^9}, {
  3.9480696377299023`*^9, 3.948069637852016*^9}},
 CellLabel->
  "In[271]:=",ExpressionUUID->"6674d628-3c75-4588-9136-9525d7a9f3a1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"3", "-", 
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"a", "[", "3", "]"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "2", "]"}], " ", 
     RowBox[{"a", "[", "4", "]"}]}], "+", 
    RowBox[{"12", " ", 
     RowBox[{"a", "[", "3", "]"}], " ", 
     RowBox[{"a", "[", "11", "]"}]}], "+", 
    RowBox[{"12", " ", 
     RowBox[{"a", "[", "4", "]"}], " ", 
     RowBox[{"a", "[", "12", "]"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "11", "]"}], " ", 
     RowBox[{"a", "[", "17", "]"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "12", "]"}], " ", 
     RowBox[{"a", "[", "18", "]"}]}]}], ",", 
   RowBox[{"3", "-", 
    RowBox[{"4", " ", "s"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"a", "[", "3", "]"}]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], " ", 
     RowBox[{"a", "[", "4", "]"}]}], "-", 
    RowBox[{"3", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", "3", "]"}], " ", 
        RowBox[{"a", "[", "11", "]"}]}], "+", 
       RowBox[{
        RowBox[{"a", "[", "4", "]"}], " ", 
        RowBox[{"a", "[", "12", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "11", "]"}], " ", 
     RowBox[{"a", "[", "17", "]"}]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "12", "]"}], " ", 
     RowBox[{"a", "[", "18", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.948068603324333*^9, 3.9480686218451643`*^9}, {
   3.9480686954026213`*^9, 3.9480687329253683`*^9}, {3.948068778066395*^9, 
   3.948068786321463*^9}, 3.948068854074603*^9, {3.9480693378450527`*^9, 
   3.948069339533695*^9}, {3.948069448113011*^9, 3.948069492513945*^9}, {
   3.948069532343606*^9, 3.948069730546728*^9}, {3.948069897664418*^9, 
   3.948069899195697*^9}, 3.948070294147174*^9, {3.9480703669924726`*^9, 
   3.948070369652849*^9}},
 CellLabel->
  "Out[271]=",ExpressionUUID->"d20925fc-7148-4fe3-9a3d-58cd089266ae"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Random polynomial of form ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"s", "(", "a", ")"}], ")"}], TraditionalForm]],ExpressionUUID->
  "576bb6b2-8851-4736-8064-46586f0e0ddc"],
 " : {long, short, substitute}  (LSS format)"
}], "Subsection",
 CellChangeTimes->{{3.910295424248437*^9, 3.910295432764516*^9}, {
  3.9287191516032867`*^9, 3.928719157336816*^9}, {3.9287196631212034`*^9, 
  3.928719672917498*^9}, {3.928720445587044*^9, 3.928720473553329*^9}, {
  3.928723130479866*^9, 3.9287231331701074`*^9}, {3.928723313622714*^9, 
  3.928723339387235*^9}, {3.928723376388587*^9, 3.928723380517714*^9}, {
  3.928724296487936*^9, 3.928724298043432*^9}, {3.928725124491305*^9, 
  3.928725131789822*^9}},ExpressionUUID->"f8e57a12-da04-4e6b-8a30-\
039291c42b49"],

Cell[TextData[{
 "Generate ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"s", "(", "a", ")"}], ")"}], TraditionalForm]],ExpressionUUID->
  "8a5de44c-73fd-45fe-885c-7da2abc2d413"],
 " where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "(", "a", ")"}], TraditionalForm]],ExpressionUUID->
  "3bedcd49-da70-4f7f-979c-13a25e830c98"],
 " has highest coefficient 1 and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", "s", ")"}], TraditionalForm]],ExpressionUUID->
  "9549bb2d-92e3-4931-9667-a02d7eb5cf8e"],
 " has no const term"
}], "Text",
 CellChangeTimes->{{3.928724786425165*^9, 3.928724827710387*^9}, {
  3.928724884282502*^9, 
  3.9287249149551444`*^9}},ExpressionUUID->"86ac6048-ad8b-4f82-97a4-\
ea109d5a8671"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$PolyInPoly$LSS$Special", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$PolyInPoly$LSS$Special", "[", 
    RowBox[{"intMax_", ",", "degMax_", ",", "subintMax_", ",", "subdegMax_"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"short", ",", "sub", ",", "long$expand", ",", "long"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial$NoConst", "[", 
        RowBox[{"intMax", ",", "degMax", ",", 
         RowBox[{"{", "s", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sub", "=", 
       RowBox[{"RandomPolynomial$WithHighestCoeff1", "[", 
        RowBox[{"subintMax", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "subdegMax"}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", "[", "1", "]"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"short", ",", "s"}], "]"}], "\[LessEqual]", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"RandomPolynomial$PolyInPoly$LSS$Special", "[", 
          RowBox[{
          "intMax", ",", "degMax", ",", "subintMax", ",", "subdegMax"}], 
          "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Exponent", "[", 
          RowBox[{"sub", ",", 
           RowBox[{"a", "[", "1", "]"}]}], "]"}], "\[LessEqual]", "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"RandomPolynomial$PolyInPoly$LSS$Special", "[", 
          RowBox[{
          "intMax", ",", "degMax", ",", "subintMax", ",", "subdegMax"}], 
          "]"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "long"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"short", "/.", 
           RowBox[{"s", "\[Rule]", "sub"}]}], "//", "Expand"}], ",", 
         RowBox[{"short", "/.", 
          RowBox[{"s", "\[Rule]", "sub"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning : \>\"", ",", "short", ",", " ", "\"\< s=\>\"", ",", 
          "sub"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
  3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
  3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}},
 CellLabel->"In[27]:=",ExpressionUUID->"9f2d8806-a63c-4e43-8414-4909eb6ede8e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial$PolyInPoly$LSS$Special", "[", 
  RowBox[{"5", ",", "2", ",", "20", ",", "4"}], "]"}]], "Input",
 CellChangeTimes->{
  3.928027971953323*^9, {3.9287249791856604`*^9, 
   3.928724980512011*^9}},ExpressionUUID->"cc262240-bebd-49d5-953b-\
865cb9919693"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "546"}], "+", 
    RowBox[{"1215", " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"1728", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
    RowBox[{"1089", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "3"]}], "-", 
    RowBox[{"417", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "4"]}], "-", 
    RowBox[{"78", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "5"]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "6"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", "s"}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["s", "2"]}]}], ",", 
   RowBox[{"13", "-", 
    RowBox[{"15", " ", 
     RowBox[{"a", "[", "1", "]"}]}], "+", 
    RowBox[{"13", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "3"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.928724983221567*^9, 3.928725277570043*^9, 
  3.9287261043756104`*^9},ExpressionUUID->"ab89e591-fd63-4546-baa0-\
c852ab6f8f28"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Random polynomial of form ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"s", "(", 
     RowBox[{
      SubscriptBox["a", "1"], ",", 
      SubscriptBox["a", "2"], ",", "..."}], ")"}], ")"}], TraditionalForm]],
  ExpressionUUID->"df58554d-62e9-4f77-88e8-285a92cc289f"],
 " : {long, short, substitute}  (LSS format)"
}], "Subsection",
 CellChangeTimes->{{3.910295424248437*^9, 3.910295432764516*^9}, {
  3.9287191516032867`*^9, 3.928719157336816*^9}, {3.9287196631212034`*^9, 
  3.928719672917498*^9}, {3.928720445587044*^9, 3.928720473553329*^9}, {
  3.928723130479866*^9, 3.9287231331701074`*^9}, {3.928723313622714*^9, 
  3.928723339387235*^9}, {3.928723376388587*^9, 3.928723380517714*^9}, {
  3.928724296487936*^9, 3.928724298043432*^9}, {3.928725124491305*^9, 
  3.9287251542092133`*^9}},ExpressionUUID->"4853c4bb-4ef1-43bc-a87f-\
29787e9ff5ed"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$PolyNInPoly1$LSS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$PolyNInPoly1$LSS", "[", 
    RowBox[{
     RowBox[{"intMin_Integer", ":", "0"}], ",", "intMax_Integer", ",", 
     "degMax_Integer", ",", 
     RowBox[{"subintMin_Integer", ":", "0"}], ",", "subintMax_Integer", ",", 
     "subdegMax_Integer", ",", "vars_List", ",", 
     RowBox[{"selectionrule_", ":", "None"}], ",", 
     RowBox[{"threshold_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", "sub", ",", "long$expand", ",", "long", ",", "retrial"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrial", "[", "]"}], ":=", 
       RowBox[{"RandomPolynomial$PolyNInPoly1$LSS", "[", 
        RowBox[{
        "intMin", ",", "intMax", ",", "degMax", ",", "subintMin", ",", 
         "subintMax", ",", "subdegMax", ",", "vars", ",", "selectionrule"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial", "[", 
        RowBox[{"intMin", ",", "intMax", ",", "degMax", ",", 
         RowBox[{"{", "s", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sub", "=", 
       RowBox[{"RandomPolynomial", "[", 
        RowBox[{"subintMin", ",", "subintMax", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", "subdegMax"}], "}"}], "]"}], ",", "vars"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"short", ",", "s"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"sub", ",", 
           RowBox[{"Alternatives", "@@", "vars"}]}], "]"}], "\[LessEqual]", 
         "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "long"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"short", "/.", 
           RowBox[{"s", "\[Rule]", "sub"}]}], "//", "Expand"}], ",", 
         RowBox[{"short", "/.", 
          RowBox[{"s", "\[Rule]", "sub"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"selectionrule", "=!=", "None"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"selectionrule", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}], ",", 
             "threshold"}], "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning : \>\"", ",", "short", ",", " ", "\"\< s=\>\"", ",", 
          "sub"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
   3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
   3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}, {
   3.928726261318315*^9, 3.9287263182582026`*^9}, {3.9287263830839825`*^9, 
   3.928726400282058*^9}, {3.928726641715729*^9, 3.928726709426447*^9}, {
   3.928726746765503*^9, 3.928726750674468*^9}, {3.929073795897071*^9, 
   3.929073905015635*^9}, 3.929074240838964*^9, {3.930214065311385*^9, 
   3.930214071339309*^9}, {3.930215246847437*^9, 3.9302152484968243`*^9}, {
   3.935691089038527*^9, 3.935691115999604*^9}, {3.935691230553411*^9, 
   3.9356912397965603`*^9}, {3.938515888118932*^9, 3.9385158882416887`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"3835ec57-d96b-403a-8b55-1f83554ed57e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial$PolyNInPoly1$LSS", "[", 
  RowBox[{"4", ",", "3", ",", "2", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.928726765948037*^9, 
  3.928726777560989*^9}},ExpressionUUID->"f53f99bd-b65b-4ac8-92cc-\
01b2fb59d318"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "42"}], "+", 
    RowBox[{"104", " ", "x"}], "-", 
    RowBox[{"192", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"200", " ", 
     SuperscriptBox["x", "3"]}], "-", 
    RowBox[{"160", " ", 
     SuperscriptBox["x", "4"]}], "+", 
    RowBox[{"72", " ", 
     SuperscriptBox["x", "5"]}], "-", 
    RowBox[{"24", " ", 
     SuperscriptBox["x", "6"]}], "+", 
    RowBox[{"104", " ", "y"}], "-", 
    RowBox[{"124", " ", "x", " ", "y"}], "+", 
    RowBox[{"160", " ", 
     SuperscriptBox["x", "2"], " ", "y"}], "-", 
    RowBox[{"20", " ", 
     SuperscriptBox["x", "3"], " ", "y"}], "+", 
    RowBox[{"36", " ", 
     SuperscriptBox["x", "5"], " ", "y"}], "-", 
    RowBox[{"192", " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"108", " ", "x", " ", 
     SuperscriptBox["y", "2"]}], "-", 
    RowBox[{"130", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "2"]}], "-", 
    RowBox[{"122", " ", 
     SuperscriptBox["x", "3"], " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"106", " ", 
     SuperscriptBox["x", "4"], " ", 
     SuperscriptBox["y", "2"]}], "-", 
    RowBox[{"108", " ", 
     SuperscriptBox["x", "5"], " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"36", " ", 
     SuperscriptBox["x", "6"], " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"200", " ", 
     SuperscriptBox["y", "3"]}], "+", 
    RowBox[{"68", " ", "x", " ", 
     SuperscriptBox["y", "3"]}], "-", 
    RowBox[{"26", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "3"]}], "+", 
    RowBox[{"139", " ", 
     SuperscriptBox["x", "3"], " ", 
     SuperscriptBox["y", "3"]}], "-", 
    RowBox[{"36", " ", 
     SuperscriptBox["x", "5"], " ", 
     SuperscriptBox["y", "3"]}], "-", 
    RowBox[{"160", " ", 
     SuperscriptBox["y", "4"]}], "-", 
    RowBox[{"124", " ", "x", " ", 
     SuperscriptBox["y", "4"]}], "+", 
    RowBox[{"48", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "4"]}], "-", 
    RowBox[{"55", " ", 
     SuperscriptBox["x", "3"], " ", 
     SuperscriptBox["y", "4"]}], "+", 
    RowBox[{"5", " ", 
     SuperscriptBox["x", "4"], " ", 
     SuperscriptBox["y", "4"]}], "+", 
    RowBox[{"54", " ", 
     SuperscriptBox["x", "5"], " ", 
     SuperscriptBox["y", "4"]}], "-", 
    RowBox[{"18", " ", 
     SuperscriptBox["x", "6"], " ", 
     SuperscriptBox["y", "4"]}], "+", 
    RowBox[{"72", " ", 
     SuperscriptBox["y", "5"]}], "+", 
    RowBox[{"108", " ", "x", " ", 
     SuperscriptBox["y", "5"]}], "-", 
    RowBox[{"18", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "5"]}], "-", 
    RowBox[{"63", " ", 
     SuperscriptBox["x", "3"], " ", 
     SuperscriptBox["y", "5"]}], "+", 
    RowBox[{"9", " ", 
     SuperscriptBox["x", "5"], " ", 
     SuperscriptBox["y", "5"]}], "-", 
    RowBox[{"24", " ", 
     SuperscriptBox["y", "6"]}], "-", 
    RowBox[{"36", " ", "x", " ", 
     SuperscriptBox["y", "6"]}], "+", 
    RowBox[{"18", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "6"]}], "+", 
    RowBox[{"33", " ", 
     SuperscriptBox["x", "3"], " ", 
     SuperscriptBox["y", "6"]}], "-", 
    RowBox[{"9", " ", 
     SuperscriptBox["x", "4"], " ", 
     SuperscriptBox["y", "6"]}], "-", 
    RowBox[{"9", " ", 
     SuperscriptBox["x", "5"], " ", 
     SuperscriptBox["y", "6"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["x", "6"], " ", 
     SuperscriptBox["y", "6"]}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["s", "2"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["s", "3"]}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], "+", 
    RowBox[{"2", " ", "x"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"2", " ", "y"}], "+", 
    RowBox[{"x", " ", "y"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["y", "2"]}], "-", 
    RowBox[{"x", " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.928726778125018*^9, 3.928726800650414*^9}, 
   3.9288544961368947`*^9, 3.9290739140224276`*^9, 
   3.929074388416113*^9},ExpressionUUID->"ffc8130f-f18e-47ea-8eb8-\
38336dbc4e98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial$PolyNInPoly1$LSS", "[", 
  RowBox[{"3", ",", "4", ",", "2", ",", "3", ",", "2", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.935691256645581*^9, 3.935691259147148*^9}},
 CellLabel->
  "In[345]:=",ExpressionUUID->"f42ef64a-7d91-4dc5-81ee-b1308f75b858"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "49"}], "+", 
    RowBox[{"54", " ", "x"}], "+", 
    RowBox[{"38", " ", 
     SuperscriptBox["x", "2"]}], "-", 
    RowBox[{"32", " ", 
     SuperscriptBox["x", "3"]}], "-", 
    RowBox[{"16", " ", 
     SuperscriptBox["x", "4"]}], "-", 
    RowBox[{"81", " ", "y"}], "+", 
    RowBox[{"129", " ", "x", " ", "y"}], "+", 
    RowBox[{"81", " ", 
     SuperscriptBox["x", "2"], " ", "y"}], "-", 
    RowBox[{"96", " ", 
     SuperscriptBox["x", "3"], " ", "y"}], "-", 
    RowBox[{"48", " ", 
     SuperscriptBox["x", "4"], " ", "y"}], "-", 
    RowBox[{"117", " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"201", " ", "x", " ", 
     SuperscriptBox["y", "2"]}], "-", 
    RowBox[{"45", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "2"]}], "-", 
    RowBox[{"72", " ", 
     SuperscriptBox["x", "3"], " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["x", "4"], " ", 
     SuperscriptBox["y", "2"]}], "-", 
    RowBox[{"72", " ", 
     SuperscriptBox["y", "3"]}], "+", 
    RowBox[{"144", " ", "x", " ", 
     SuperscriptBox["y", "3"]}], "-", 
    RowBox[{"72", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "3"]}], "+", 
    RowBox[{"72", " ", 
     SuperscriptBox["x", "4"], " ", 
     SuperscriptBox["y", "3"]}], "-", 
    RowBox[{"36", " ", 
     SuperscriptBox["y", "4"]}], "+", 
    RowBox[{"72", " ", "x", " ", 
     SuperscriptBox["y", "4"]}], "-", 
    RowBox[{"108", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "4"]}], "+", 
    RowBox[{"72", " ", 
     SuperscriptBox["x", "3"], " ", 
     SuperscriptBox["y", "4"]}], "-", 
    RowBox[{"36", " ", 
     SuperscriptBox["x", "4"], " ", 
     SuperscriptBox["y", "4"]}]}], ",", 
   RowBox[{
    RowBox[{"-", "4"}], "-", 
    RowBox[{"3", " ", "s"}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["s", "2"]}]}], ",", 
   RowBox[{"3", "-", 
    RowBox[{"2", " ", "x"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["x", "2"]}], "+", 
    RowBox[{"3", " ", "y"}], "-", 
    RowBox[{"3", " ", "x", " ", "y"}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["x", "2"], " ", "y"}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["y", "2"]}], "-", 
    RowBox[{"3", " ", "x", " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["x", "2"], " ", 
     SuperscriptBox["y", "2"]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.935691259770375*^9, 3.93569128402176*^9}},
 CellLabel->
  "Out[345]=",ExpressionUUID->"f0208593-fd78-4b0b-8912-997b0d11a0a3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial", "[", 
  RowBox[{"2", ",", "1", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.928725342735959*^9, 3.9287253559837484`*^9}, 
   3.9287260883641653`*^9},ExpressionUUID->"322dbe4c-5ffb-4be5-a6d3-\
3d7f99c1accb"],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"a", "[", "1", "]"}], "+", 
  RowBox[{"a", "[", "2", "]"}], "+", 
  RowBox[{"2", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"a", "[", "2", "]"}]}]}]], "Output",
 CellChangeTimes->{{3.928725345867694*^9, 3.928725356565233*^9}, {
   3.928725993989734*^9, 3.928725999224317*^9}, {3.928726077368916*^9, 
   3.928726096284494*^9}, 
   3.929074391421532*^9},ExpressionUUID->"638009fa-1227-4e2b-bbec-\
37ef512ac755"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"with", " ", "limitations"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.931966522962427*^9, 
  3.9319665324737577`*^9}},ExpressionUUID->"6ec50d3b-6c0e-4624-badb-\
22f467ba4854"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$PolyNInPoly2$LSS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$PolyNInPoly2$LSS", "[", 
    RowBox[{
     RowBox[{"intMin_Integer", ":", "0"}], ",", "intMax_Integer", ",", 
     "degMax_Integer", ",", 
     RowBox[{"subintMin_Integer", ":", "0"}], ",", "subintMax_Integer", ",", 
     "subdegMax_Integer", ",", "vars_List", ",", 
     RowBox[{"selectionrule_", ":", "None"}], ",", 
     RowBox[{"threshold_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", "sub", ",", "long$expand", ",", "long", ",", "retrial"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrial", "[", "]"}], ":=", 
       RowBox[{"RandomPolynomial$PolyNInPoly2$LSS", "[", 
        RowBox[{
        "intMin", ",", "intMax", ",", "degMax", ",", "subintMax", ",", 
         "subdegMax", ",", "vars", ",", "selectionrule"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial", "[", 
        RowBox[{"intMin", ",", "intMax", ",", "degMax", ",", 
         RowBox[{"{", "s", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sub", "=", 
       RowBox[{"RandomPolynomial$WithHighestCoeff1", "[", 
        RowBox[{"subintMin", ",", "subintMax", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", "subdegMax"}], "}"}], "]"}], ",", "vars"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "at", " ", "least", " ", "have", " ", "degree", " ", "2", " ", 
        "substructure"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"short", ",", "s"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"sub", ",", 
           RowBox[{"Alternatives", "@@", "vars"}]}], "]"}], "\[LessEqual]", 
         "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "long"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"short", "/.", 
           RowBox[{"s", "\[Rule]", "sub"}]}], "//", "Expand"}], ",", 
         RowBox[{"short", "/.", 
          RowBox[{"s", "\[Rule]", "sub"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"selectionrule", "=!=", "None"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"selectionrule", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}], ",", 
             "threshold"}], "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning : \>\"", ",", "short", ",", " ", "\"\< s=\>\"", ",", 
          "sub"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
   3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
   3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}, {
   3.928726261318315*^9, 3.9287263182582026`*^9}, {3.9287263830839825`*^9, 
   3.928726400282058*^9}, {3.928726641715729*^9, 3.928726709426447*^9}, {
   3.928726746765503*^9, 3.928726750674468*^9}, {3.929073795897071*^9, 
   3.929073905015635*^9}, 3.929074240838964*^9, {3.929693697532645*^9, 
   3.929693740929082*^9}, {3.930213915986288*^9, 3.930213916278241*^9}, {
   3.93021397582139*^9, 3.930213997766171*^9}, {3.9302140361301937`*^9, 
   3.9302140364558153`*^9}, {3.930215237065489*^9, 3.930215241155187*^9}, {
   3.935693498568289*^9, 3.935693531961293*^9}, {3.937092198149279*^9, 
   3.93709222493364*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"62fab334-9db8-4fb7-9985-dfce717f3a5d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"for", " ", "gen7"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.937654592188549*^9, 
  3.937654594309677*^9}},ExpressionUUID->"f2828ab3-b02e-4c8b-bf6b-\
e0db8c2e3f29"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "give", " ", "coefficient", " ", "range", " ", "of", " ", "every", " ", 
    "term", " ", "except", " ", "highest", " ", "degree", " ", "term", " ", 
    "as", " ", "a", " ", "subint", " ", "list"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"length", " ", "of", " ", 
    RowBox[{"subint", " ", ":", " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"degree", "+", "1"}], ")"}], "numVars"], "-", "1"}]}]}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.937655376780552*^9, 3.937655403303074*^9}, {
  3.937655556299986*^9, 
  3.937655585216473*^9}},ExpressionUUID->"8078b2bd-ae4f-4746-9d61-\
69d60a096952"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$gen7", "[", 
    RowBox[{"subint_List", ",", "vars_List"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "numVars", ",", "coeffs", ",", "terms", ",", "exponents", ",", 
       "degree"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"numVars", "=", 
       RowBox[{"Length", "[", "vars", "]"}]}], ";", "\n", 
      RowBox[{"degree", " ", "=", " ", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "subint", "]"}], "+", "1"}], ")"}], 
         RowBox[{"1", "/", "numVars"}]], "-", "1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"exponents", "=", 
       RowBox[{"Tuples", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"0", ",", "degree"}], "]"}], ",", "numVars"}], "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"coeffs", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"subint", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"subint", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{
             RowBox[{"Length", "[", "exponents", "]"}], "-", "1"}]}], "}"}]}],
          "]"}], "~", "Join", "~", 
        RowBox[{"{", "1", "}"}]}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"terms", "=", 
       RowBox[{"coeffs", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Times", "@@", 
            RowBox[{"(", 
             RowBox[{"vars", "^", "#"}], ")"}]}], "&"}], "/@", "exponents"}], 
         ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", "terms", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.9102943629021096`*^9, 3.910294368967478*^9}, {
   3.9102944354620247`*^9, 3.910294446559577*^9}, {3.910294477039682*^9, 
   3.910294527138598*^9}, {3.9102945901587725`*^9, 3.910294594753267*^9}, {
   3.928722874392534*^9, 3.9287229078199205`*^9}, {3.928725949584319*^9, 
   3.928725949955789*^9}, {3.93569327450289*^9, 3.935693308378077*^9}, 
   3.935693350854281*^9, {3.937091061585359*^9, 3.937091080869906*^9}, {
   3.937091206550571*^9, 3.937091209057114*^9}, {3.937091325073715*^9, 
   3.937091325404924*^9}, {3.937654823299446*^9, 3.937654829850866*^9}, 
   3.9376548853136187`*^9, {3.937655041557971*^9, 3.937655063123988*^9}, {
   3.9376551234208555`*^9, 3.93765516157172*^9}, {3.937655224819648*^9, 
   3.937655311959577*^9}, {3.937655371049912*^9, 3.937655373834083*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"2c06e0cd-4de3-420f-955f-b7f09da9f5bc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial$gen7", "[", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "2"}], ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "1"}], ",", "2"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", "a", "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.937655318618898*^9, 3.937655355364315*^9}, {
  3.937655484059498*^9, 3.937655489006369*^9}},
 CellLabel->
  "In[614]:=",ExpressionUUID->"8e0eb940-d091-4bda-914d-abd34b21c4f2"],

Cell[BoxData[
 RowBox[{"1", "-", 
  RowBox[{"2", " ", "a"}], "+", 
  SuperscriptBox["a", "2"], "+", 
  SuperscriptBox["a", "3"]}]], "Output",
 CellChangeTimes->{{3.937655490055373*^9, 3.937655507392582*^9}, 
   3.937655537669684*^9, {3.9376556037953787`*^9, 3.937655611134956*^9}, {
   3.937655644531939*^9, 3.93765566552137*^9}},
 CellLabel->
  "Out[614]=",ExpressionUUID->"fa7c54a8-5d60-4edc-9133-3a666fe5fcd9"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Polynomial", " ", "generator", " ", "using", " ", "gen7"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"substitution", " ", 
    RowBox[{"rule", "'"}], "s", " ", "max", " ", "degree", " ", "is", " ", 
    "fixed"}], " ", "*)"}]}]], "Input",
 CellChangeTimes->{{3.937655675092261*^9, 3.93765568410323*^9}, {
  3.937655799370858*^9, 
  3.93765581368876*^9}},ExpressionUUID->"cab622b5-c8d1-4435-a566-\
91a48d72e10a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$gen7$LSS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$gen7$LSS", "[", 
    RowBox[{
    "intMax_Integer", ",", "degMax_Integer", ",", "subint_List", ",", 
     "vars_List", ",", 
     RowBox[{"selectionrule_", ":", "None"}], ",", 
     RowBox[{"threshold_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", "sub", ",", "long$expand", ",", "long", ",", "retrial"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrial", "[", "]"}], ":=", 
       RowBox[{"RandomPolynomial$PolyNInPoly2$LSS", "[", 
        RowBox[{
        "intMax", ",", "degMax", ",", "subint", ",", "vars", ",", 
         "selectionrule"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial", "[", 
        RowBox[{"intMax", ",", "degMax", ",", 
         RowBox[{"{", "s", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sub", "=", 
       RowBox[{"RandomPolynomial$gen7", "[", 
        RowBox[{"subint", ",", "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "at", " ", "least", " ", "have", " ", "degree", " ", "2", " ", 
        "substructure"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"short", ",", "s"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"sub", ",", 
           RowBox[{"Alternatives", "@@", "vars"}]}], "]"}], "\[LessEqual]", 
         "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "long"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"short", "/.", 
           RowBox[{"s", "\[Rule]", "sub"}]}], "//", "Expand"}], ",", 
         RowBox[{"short", "/.", 
          RowBox[{"s", "\[Rule]", "sub"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"selectionrule", "=!=", "None"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"selectionrule", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}], ",", 
             "threshold"}], "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning : \>\"", ",", "short", ",", " ", "\"\< s=\>\"", ",", 
          "sub"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
   3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
   3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}, {
   3.928726261318315*^9, 3.9287263182582026`*^9}, {3.9287263830839825`*^9, 
   3.928726400282058*^9}, {3.928726641715729*^9, 3.928726709426447*^9}, {
   3.928726746765503*^9, 3.928726750674468*^9}, {3.929073795897071*^9, 
   3.929073905015635*^9}, 3.929074240838964*^9, {3.929693697532645*^9, 
   3.929693740929082*^9}, {3.930213915986288*^9, 3.930213916278241*^9}, {
   3.93021397582139*^9, 3.930213997766171*^9}, {3.9302140361301937`*^9, 
   3.9302140364558153`*^9}, {3.930215237065489*^9, 3.930215241155187*^9}, {
   3.935693498568289*^9, 3.935693531961293*^9}, {3.937092198149279*^9, 
   3.93709222493364*^9}, {3.937654599533938*^9, 3.937654627179231*^9}, {
   3.937654667989925*^9, 3.937654670513255*^9}, {3.937654748163388*^9, 
   3.937654787326804*^9}, {3.937655692787674*^9, 3.93765569379454*^9}, {
   3.937655831965775*^9, 3.937655832687394*^9}, {3.937656235355967*^9, 
   3.93765625251641*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"1f963fac-9674-494b-a1b5-ed7a36698ac5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial$gen7$LSS", "[", 
  RowBox[{"5", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "40"}], ",", "40"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "20"}], ",", "20"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "20"}], ",", "20"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", "[", "1", "]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9376560246302967`*^9, 3.937656032167758*^9}, {
  3.937656068363665*^9, 3.937656122337513*^9}, {3.937656246567725*^9, 
  3.937656266002129*^9}},
 CellLabel->
  "In[644]:=",ExpressionUUID->"0d62dc3d-9809-4aec-ae35-88b9e258bb17"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "3334"}], "-", 
    RowBox[{"3800", " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"1683", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{"3342", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "3"]}], "-", 
    RowBox[{"1537", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "4"]}], "-", 
    RowBox[{"156", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "5"]}], "-", 
    RowBox[{"657", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "6"]}], "+", 
    RowBox[{"90", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "7"]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "8"]}]}], ",", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"2", " ", "s"}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox["s", "2"]}]}], ",", 
   RowBox[{
    RowBox[{"-", "33"}], "-", 
    RowBox[{"19", " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{"15", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "3"]}], "+", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "4"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.937656144340664*^9, 3.937656149956215*^9}, {
  3.937656255158511*^9, 3.937656305962996*^9}},
 CellLabel->
  "Out[644]=",ExpressionUUID->"65f4b572-735d-4329-aae2-ecf8add15948"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"with", " ", "limitations"}], ",", " ", 
   RowBox[{
   "maximum", " ", "number", " ", "of", " ", "terms", " ", "in", " ", 
    "substitution"}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.931966552221726*^9, 3.9319665857045517`*^9}, {
  3.931967453566262*^9, 
  3.931967457335629*^9}},ExpressionUUID->"73de9172-e96d-4d5e-b620-\
2ba8a08b7281"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$PolyNInPoly3$LSS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$PolyNInPoly3$LSS", "[", 
    RowBox[{
    "intMax_Integer", ",", "degMax_Integer", ",", "subintMax_Integer", ",", 
     "subdegMax_Integer", ",", "vars_List", ",", "\n", "maxlength_Integer", 
     ",", 
     RowBox[{"selectionrule_", ":", "None"}], ",", 
     RowBox[{"threshold_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", "sub", ",", "long$expand", ",", "long", ",", "retrial"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrial", "[", "]"}], ":=", 
       RowBox[{"RandomPolynomial$PolyNInPoly3$LSS", "[", 
        RowBox[{
        "intMax", ",", "degMax", ",", "subintMax", ",", "subdegMax", ",", 
         "vars", ",", "maxlength", ",", "selectionrule", ",", "threshold"}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial$WithHighestCoeff1", "[", 
        RowBox[{"intMax", ",", "degMax", ",", 
         RowBox[{"{", "s", "}"}]}], "]"}]}], ";", "\n", 
      RowBox[{"sub", "=", 
       RowBox[{"RandomPolynomial$maxlength", "[", 
        RowBox[{"subintMax", ",", "subdegMax", ",", "vars", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "maxlength"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"short", ",", "s"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"sub", ",", 
           RowBox[{"Alternatives", "@@", "vars"}]}], "]"}], "\[LessEqual]", 
         "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "long"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"short", "/.", 
           RowBox[{"s", "\[Rule]", "sub"}]}], "//", "Expand"}], ",", 
         RowBox[{"short", "/.", 
          RowBox[{"s", "\[Rule]", "sub"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"selectionrule", "=!=", "None"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"selectionrule", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}], ",", 
             "threshold"}], "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning : \>\"", ",", "short", ",", " ", "\"\< s=\>\"", ",", 
          "sub"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
   3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
   3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}, {
   3.928726261318315*^9, 3.9287263182582026`*^9}, {3.9287263830839825`*^9, 
   3.928726400282058*^9}, {3.928726641715729*^9, 3.928726709426447*^9}, {
   3.928726746765503*^9, 3.928726750674468*^9}, {3.929073795897071*^9, 
   3.929073905015635*^9}, 3.929074240838964*^9, {3.929693697532645*^9, 
   3.929693740929082*^9}, {3.930213915986288*^9, 3.930213916278241*^9}, {
   3.93021397582139*^9, 3.930213997766171*^9}, {3.9302140361301937`*^9, 
   3.9302140364558153`*^9}, {3.930215237065489*^9, 3.930215241155187*^9}, {
   3.931966593416523*^9, 3.93196664671953*^9}, {3.931966715024255*^9, 
   3.931966734279604*^9}, {3.931966781831505*^9, 3.931966819973034*^9}, {
   3.931966933379026*^9, 3.931966943593693*^9}, {3.93196736693241*^9, 
   3.931967377858004*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"8fd27721-d8d0-4d2b-8ee6-7b51e13db78a"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"with", " ", "multivariable", " ", "in", " ", "origin"}], " ", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.932053549322781*^9, 
  3.9320535545229683`*^9}},ExpressionUUID->"d5e800ee-fa46-4740-b6d4-\
97793909ced5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$PolyNInPoly4$LSS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RandomPolynomial$PolyNInPoly4$LSS", "[", 
     RowBox[{
      RowBox[{"intMin_Integer", ":", "0"}], ",", "intMax_Integer", ",", 
      "degMax_Integer", ",", 
      RowBox[{"subintMin_Integer", ":", "0"}], ",", "subintMax_Integer", ",", 
      "subdegMax_Integer", ",", "subvars_List", "\n", ",", 
      "maxlength_Integer", ",", 
      RowBox[{"subminlength_Integer", ":", "1"}], ",", 
      "submaxlength_Integer"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "short", ",", "sub1", ",", "sub2", ",", "long$expand", ",", "long", 
        ",", "retrial"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"retrial", "[", "]"}], ":=", 
        RowBox[{"RandomPolynomial$PolyNInPoly4$LSS", "[", 
         RowBox[{
         "intMax", ",", "degMax", ",", "subintMax", ",", "subdegMax", ",", 
          "subvars", ",", "maxlength", ",", "submaxlength"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"short", "=", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{"intMin", ",", "intMax", ",", "degMax", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], ",", 
            RowBox[{"b", "[", "1", "]"}]}], "}"}], ",", "maxlength"}], 
         "]"}]}], ";", "\n", 
       RowBox[{"sub1", "=", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{
         "subintMin", ",", "subintMax", ",", "subdegMax", ",", "subvars", ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"subminlength", ",", "submaxlength"}], "}"}], "]"}]}], 
         "]"}]}], ";", "\n", 
       RowBox[{"sub2", "=", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{
         "subintMin", ",", "subintMax", ",", "subdegMax", ",", "subvars", ",", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"subminlength", ",", "submaxlength"}], "}"}], "]"}]}], 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"long$expand", "=", 
        RowBox[{
         RowBox[{"short", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"b", "[", "0", "]"}], "\[Rule]", "sub1"}], ",", 
            RowBox[{
             RowBox[{"b", "[", "1", "]"}], "->", "sub2"}]}], "}"}]}], "//", 
         "Expand"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"long$expand", "===", "0"}], ",", 
         RowBox[{"retrial", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "short", ",", "sub1", ",", "sub2"}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "data", " ", "augmentation", " ", "with", " ", "simplification", " ", "of",
     " ", "subset", " ", "of", " ", "polynomial"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomialWithSplit$PolyNInPoly4$LSS", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomialWithSplit$PolyNInPoly4$LSS", "[", "\n", "  ", 
    RowBox[{
    "intMax_Integer", ",", " ", "\n", "  ", "degMax_Integer", ",", " ", "\n", 
     "  ", "subintMax_Integer", ",", " ", "\n", "  ", "subdegMax_Integer", 
     ",", " ", "\n", "  ", "subvars_List", ",", " ", "\n", "  ", 
     "maxlength_Integer", ",", " ", "\n", "  ", "submaxlength_Integer"}], 
    "\n", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\n", "  ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", " ", "sub1", ",", " ", "sub2", ",", " ", "long$expand", 
       ",", " ", "long$split", ",", " ", "terms", ",", " ", "half1", ",", " ",
        "half2", ",", " ", "retrial"}], "}"}], ",", "\n", "  ", "\n", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{"retrial", "[", "]"}], " ", ":=", " ", 
       RowBox[{
       "RandomPolynomialWithSplit$PolyNInPoly4$LSS", "[", "\n", "    ", 
        RowBox[{
        "intMax", ",", " ", "degMax", ",", " ", "subintMax", ",", " ", 
         "subdegMax", ",", " ", "subvars", ",", " ", "maxlength", ",", " ", 
         "submaxlength"}], "\n", "  ", "]"}]}], ";", "\n", "\n", "  ", 
      RowBox[{"short", " ", "=", " ", 
       RowBox[{"RandomPolynomial$maxlength", "[", 
        RowBox[{"intMax", ",", " ", "degMax", ",", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"b", "[", "0", "]"}], ",", " ", 
           RowBox[{"b", "[", "1", "]"}]}], "}"}], ",", " ", "maxlength"}], 
        "]"}]}], ";", "\n", "  ", 
      RowBox[{"sub1", " ", "=", " ", 
       RowBox[{"RandomPolynomial$maxlength", "[", 
        RowBox[{
        "subintMax", ",", " ", "subdegMax", ",", " ", "subvars", ",", " ", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "submaxlength"}], "}"}], "]"}]}], "]"}]}], 
      ";", "\n", "  ", 
      RowBox[{"sub2", " ", "=", " ", 
       RowBox[{"RandomPolynomial$maxlength", "[", 
        RowBox[{
        "subintMax", ",", " ", "subdegMax", ",", " ", "subvars", ",", " ", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", " ", "submaxlength"}], "}"}], "]"}]}], "]"}]}], 
      ";", "\n", "\n", "  ", 
      RowBox[{"long$expand", " ", "=", " ", 
       RowBox[{
        RowBox[{"short", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], " ", "->", " ", "sub1"}], ",", " ", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], " ", "->", " ", "sub2"}]}], "}"}]}],
         " ", "//", " ", "Expand"}]}], ";", "\n", "  ", "\n", "   ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "long$expand", "]"}], " ", "===", " ", "Plus"}],
         ",", "\n", "   ", 
        RowBox[{
         RowBox[{"terms", " ", "=", " ", 
          RowBox[{"List", " ", "@@", " ", "long$expand"}]}], ";"}], "\n", 
        "   ", ",", "\n", "   ", 
        RowBox[{
         RowBox[{"terms", " ", "=", " ", 
          RowBox[{"{", "long$expand", "}"}]}], ";"}]}], "\n", "  ", "]"}], 
      ";", "\n", "  ", "\n", "  ", 
      RowBox[{"n", " ", "=", " ", 
       RowBox[{"Floor", "[", 
        RowBox[{
         RowBox[{"Length", "[", "terms", "]"}], "/", "2"}], "]"}]}], ";", 
      "\n", "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"n", " ", ">", " ", "1"}], ",", "\n", "   ", 
        RowBox[{
         RowBox[{"subset1", " ", "=", " ", 
          RowBox[{"Take", "[", 
           RowBox[{"terms", ",", " ", "n"}], "]"}]}], ";", "\n", "   ", 
         RowBox[{"subset2", " ", "=", " ", 
          RowBox[{"Drop", "[", 
           RowBox[{"terms", ",", " ", "n"}], "]"}]}], ";", "\n", "   ", 
         RowBox[{"poly1", " ", "=", " ", 
          RowBox[{"Total", "[", "subset1", "]"}]}], ";", "\n", "   ", 
         RowBox[{"poly2", " ", "=", " ", 
          RowBox[{
           RowBox[{"Total", "[", "subset2", "]"}], " ", "//", " ", 
           "Simplify"}]}], ";", "\n", "   ", 
         RowBox[{"long$split", " ", "=", " ", 
          RowBox[{"poly1", " ", "+", " ", "poly2"}]}]}], ",", "\n", "   ", 
        RowBox[{
         RowBox[{"long$split", " ", "=", " ", "long$expand"}], ";"}]}], "\n", 
       "   ", "]"}], ";", "\n", "  ", 
      RowBox[{"{", 
       RowBox[{
       "long$expand", ",", " ", "long$split", ",", " ", "short", ",", " ", 
        "sub1", ",", " ", "sub2"}], "}"}]}]}], "\n", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
   3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
   3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}, {
   3.928726261318315*^9, 3.9287263182582026`*^9}, {3.9287263830839825`*^9, 
   3.928726400282058*^9}, {3.928726641715729*^9, 3.928726709426447*^9}, {
   3.928726746765503*^9, 3.928726750674468*^9}, {3.929073795897071*^9, 
   3.929073905015635*^9}, 3.929074240838964*^9, {3.929693697532645*^9, 
   3.929693740929082*^9}, {3.930213915986288*^9, 3.930213916278241*^9}, {
   3.93021397582139*^9, 3.930213997766171*^9}, {3.9302140361301937`*^9, 
   3.9302140364558153`*^9}, {3.930215237065489*^9, 3.930215241155187*^9}, {
   3.931966593416523*^9, 3.93196664671953*^9}, {3.931966715024255*^9, 
   3.931966734279604*^9}, {3.931966781831505*^9, 3.931966819973034*^9}, {
   3.931966933379026*^9, 3.931966943593693*^9}, {3.93196736693241*^9, 
   3.931967377858004*^9}, {3.932053562069384*^9, 3.9320535622125597`*^9}, {
   3.932053592607184*^9, 3.932053623789177*^9}, {3.932053674781619*^9, 
   3.932053734496317*^9}, {3.9320537779125853`*^9, 3.932053905297308*^9}, {
   3.932053976099035*^9, 3.932053986564485*^9}, {3.932054135034429*^9, 
   3.932054137074844*^9}, {3.933136581677446*^9, 3.933136589392385*^9}, {
   3.935045334268897*^9, 3.935045361341262*^9}, {3.935670826687352*^9, 
   3.93567084390863*^9}, {3.935673533280107*^9, 3.935673574497263*^9}, {
   3.936815720315722*^9, 3.9368157598778563`*^9}, {3.936815792932863*^9, 
   3.936815798383898*^9}, 3.936816009870045*^9},
 CellLabel->"In[38]:=",ExpressionUUID->"f32eefd3-b588-40e7-ba5d-354402e9591c"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"splitCoefficient", "[", 
  RowBox[{"-", "4"}], "]"}]], "Input",
 CellChangeTimes->{{3.935704783678136*^9, 3.93570482060784*^9}},
 CellLabel->
  "In[861]:=",ExpressionUUID->"d29d9378-e47b-4f79-ad75-e38af646cc2b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "4"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.93570480340764*^9, 3.935704820824646*^9}},
 CellLabel->
  "Out[861]=",ExpressionUUID->"af225d40-7bd1-4269-b2a8-2df2539bc216"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "data", " ", "augmentation", " ", "with", " ", "random", " ", "split", " ",
     "of", " ", "coefficient"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "extractTerms", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"extractTerms", "[", "expr_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "terms", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AtomQ", "[", "expr", "]"}], ",", "\n", 
         RowBox[{"terms", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"expr", ",", "_Symbol"}], "]"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "expr", "}"}]}], "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"terms", "=", 
           RowBox[{"List", "@@", "expr"}]}], ";", "\n", 
          RowBox[{"terms", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"terms", ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"#", ",", "_Symbol"}], "]"}]}], "&"}]}], "]"}]}], 
          ";"}]}], "]"}], ";", "\n", "terms"}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "splitCoefficient", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"splitCoefficient", "[", "term_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"coeff", ",", "vars", ",", "randSplit"}], "}"}], ",", "\n", 
      "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "term", "]"}], "-", 
           RowBox[{"Length", "[", 
            RowBox[{"Variables", "[", "term", "]"}], "]"}]}], " ", "<=", " ", 
          "0"}], ",", "\n", 
         RowBox[{
          RowBox[{"coeff", " ", "=", " ", "1"}], ";", "\n", 
          RowBox[{"vars", " ", "=", " ", "term"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"Variables", "[", "term", "]"}], "]"}], "==", "0"}], 
            ",", "\n", 
            RowBox[{
             RowBox[{"coeff", "=", "term"}], ";", "\n", 
             RowBox[{"vars", "=", "1"}], ";"}], "\n", ",", "\n", 
            RowBox[{
             RowBox[{"coeff", "=", 
              RowBox[{"Coefficient", "[", 
               RowBox[{"term", ",", " ", 
                RowBox[{"term", "/", 
                 RowBox[{"term", "[", 
                  RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ";", "\n", 
             RowBox[{"vars", "=", 
              RowBox[{"term", "/", 
               RowBox[{"term", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], "\n", "]"}], ";"}]}], 
        "\n", "]"}], ";", "\n", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coeff", "==", "0"}], "||", 
          RowBox[{"coeff", "==", "1"}], " ", "||", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "term", "]"}], "-", 
            RowBox[{"Length", "[", 
             RowBox[{"Variables", "[", "term", "]"}], "]"}]}], " ", "==", " ",
            "0"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{"term", ",", " ", "0"}], "}"}], "]"}], ";"}], "\n", ",", 
         "\n", 
         RowBox[{
          RowBox[{"randSplit", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"Abs", "[", "coeff", "]"}], "-", "1"}]}], "}"}], 
            "]"}]}], ";", "\n", 
          RowBox[{"Return", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"randSplit", "*", "vars", "*", 
              RowBox[{"Sign", "[", "coeff", "]"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Abs", "[", "coeff", "]"}], "-", "randSplit"}], ")"}],
               "*", "vars", "*", 
              RowBox[{"Sign", "[", "coeff", "]"}]}]}], "}"}], "]"}], ";"}]}], 
        "\n", "]"}]}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
    "Clear", "[", "RandomPolynomialWithSplit2$PolyNInPoly4$LSS", "]"}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RandomPolynomialWithSplit2$PolyNInPoly4$LSS", "[", "\n", "  ", 
      RowBox[{
      "intMax_Integer", ",", " ", "\n", "  ", "degMax_Integer", ",", " ", 
       "\n", "  ", "subintMax_Integer", ",", " ", "\n", "  ", 
       "subdegMax_Integer", ",", " ", "\n", "  ", "subvars_List", ",", " ", 
       "\n", "  ", "maxlength_Integer", ",", " ", "\n", "  ", 
       "submaxlength_Integer"}], "\n", "]"}], " ", ":=", " ", 
     RowBox[{"Module", "[", "\n", "  ", 
      RowBox[{
       RowBox[{"{", "\n", "    ", 
        RowBox[{
        "short", ",", " ", "sub1", ",", " ", "sub2", ",", " ", "long$expand", 
         ",", " ", "splitTerms"}], "\n", "  ", "}"}], ",", "\n", "  ", "\n", 
       "  ", 
       RowBox[{
        RowBox[{"short", " ", "=", " ", 
         RowBox[{"RandomPolynomial$maxlength", "[", 
          RowBox[{"intMax", ",", " ", "degMax", ",", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"b", "[", "0", "]"}], ",", " ", 
             RowBox[{"b", "[", "1", "]"}]}], "}"}], ",", " ", "maxlength"}], 
          "]"}]}], ";", "\n", "  ", 
        RowBox[{"sub1", " ", "=", " ", 
         RowBox[{"RandomPolynomial$maxlength", "[", 
          RowBox[{
          "subintMax", ",", " ", "subdegMax", ",", " ", "subvars", ",", " ", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "submaxlength"}], "}"}], "]"}]}], "]"}]}],
         ";", "\n", "  ", 
        RowBox[{"sub2", " ", "=", " ", 
         RowBox[{"RandomPolynomial$maxlength", "[", 
          RowBox[{
          "subintMax", ",", " ", "subdegMax", ",", " ", "subvars", ",", " ", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", " ", "submaxlength"}], "}"}], "]"}]}], "]"}]}],
         ";", "\n", "  ", "\n", "  ", 
        RowBox[{"long$expand", " ", "=", " ", 
         RowBox[{
          RowBox[{"short", " ", "/.", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], " ", "->", " ", "sub1"}], ",", 
             " ", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], " ", "->", " ", "sub2"}]}], 
            "}"}]}], " ", "//", " ", "Expand"}]}], ";", "\n", "  ", "\n", 
        "  ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "long$expand", "]"}], ">", "1"}], " ", "&&",
            " ", 
           RowBox[{
            RowBox[{"Head", "[", "long$expand", "]"}], " ", "===", " ", 
            "Plus"}]}], ",", "\n", "    ", 
          RowBox[{
           RowBox[{"splitTerms", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"splitCoefficient", "/@", 
                RowBox[{"(", 
                 RowBox[{"List", "@@", "long$expand"}], ")"}]}], ",", " ", 
               "1"}], "]"}], "]"}]}], ";"}], "\n", "  ", ",", "\n", "    ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"long$expand", " ", "===", " ", "0"}], ",", "\n", 
             "      ", 
             RowBox[{
              RowBox[{"splitTerms", " ", "=", " ", "0"}], ";"}], ",", "\n", 
             "      ", 
             RowBox[{
              RowBox[{"splitTerms", "=", 
               RowBox[{
                RowBox[{"Inactive", "[", "Plus", "]"}], "@@", 
                RowBox[{"splitCoefficient", "[", "long$expand", "]"}]}]}], 
              ";"}]}], "\n", "    ", "]"}], ";"}]}], "\n", "  ", "]"}], ";", 
        "\n", "  ", 
        RowBox[{"{", 
         RowBox[{"long$expand", ",", " ", 
          RowBox[{
           RowBox[{"Inactive", "[", "Plus", "]"}], "@@", "splitTerms"}], ",", 
          " ", "short", ",", " ", "sub1", ",", " ", "sub2"}], "}"}]}]}], "\n",
       "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.935045304695348*^9, 3.935045328913621*^9}, {
  3.9350453653563137`*^9, 3.935045402370321*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"e17d62d6-5adb-4a6c-978b-7a32ade9a3c8"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"RandomInteger", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "2"}], ",", "0"}], "}"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "10"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.935703507684583*^9, 3.935703570057315*^9}},
 CellLabel->
  "In[698]:=",ExpressionUUID->"b05abe98-fd0c-4238-87fe-d92993771c50"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", "0", ",", 
   RowBox[{"-", "1"}], ",", 
   RowBox[{"-", "2"}], ",", 
   RowBox[{"-", "2"}], ",", "0", ",", "0", ",", 
   RowBox[{"-", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.9357035130976753`*^9, 3.935703570466408*^9}},
 CellLabel->
  "Out[698]=",ExpressionUUID->"037838d6-39c1-4e8f-9471-2e70b1a2ea9f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"term2", " ", "=", " ", 
   RowBox[{"-", "a"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "term2", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", 
  RowBox[{"Variables", "[", "term2", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"%%", "-", "%"}]}], "Input",
 CellChangeTimes->{{3.935704340939321*^9, 3.935704366867863*^9}, {
   3.935704468113841*^9, 3.935704561057019*^9}, 3.9357046942922993`*^9, {
   3.935705182527217*^9, 3.935705185139411*^9}},
 CellLabel->
  "In[907]:=",ExpressionUUID->"aa47d33a-cdbf-4a61-b46b-c2b197fad0fd"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.935704470116377*^9, 3.935704561450382*^9}, 
   3.935704694881467*^9, {3.935705182994173*^9, 3.935705185567758*^9}},
 CellLabel->
  "Out[908]=",ExpressionUUID->"2df3dff0-bfc2-4353-ac5c-622397bcdfec"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.935704470116377*^9, 3.935704561450382*^9}, 
   3.935704694881467*^9, {3.935705182994173*^9, 3.935705185571274*^9}},
 CellLabel->
  "Out[909]=",ExpressionUUID->"01c212de-6607-43b9-be7d-310b5c5aa234"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.935704470116377*^9, 3.935704561450382*^9}, 
   3.935704694881467*^9, {3.935705182994173*^9, 3.935705185574158*^9}},
 CellLabel->
  "Out[910]=",ExpressionUUID->"34947183-3ba5-4ceb-b54a-acc915a9122e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"term2", "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]], "Input",
 CellChangeTimes->{{3.935704685032798*^9, 3.9357046978785887`*^9}},
 CellLabel->
  "In[841]:=",ExpressionUUID->"ac0afd2a-b7b8-41be-9fe5-b45c9a1231c7"],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.935704689252149*^9, 3.9357046980961*^9}},
 CellLabel->
  "Out[841]=",ExpressionUUID->"3a5248a8-a287-45cc-a393-0522674e2b57"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", 
  RowBox[{"Variables", "[", "term2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.935704388625893*^9, 3.935704394835908*^9}},
 CellLabel->
  "In[765]:=",ExpressionUUID->"d0d79c55-0885-40d7-8c38-724f66f8ef60"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.935704369795487*^9, 3.935704395143545*^9}},
 CellLabel->
  "Out[765]=",ExpressionUUID->"97c0dd14-e230-4a22-83c2-aeb2b4f2cdac"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "data", " ", "augmentation", " ", "with", " ", "random", " ", "split", " ",
     "of", " ", "coefficient"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", "extractTerms", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"extractTerms", "[", "expr_", "]"}], ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "terms", "}"}], ",", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"AtomQ", "[", "expr", "]"}], ",", "\n", 
         RowBox[{"terms", "=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"FreeQ", "[", 
             RowBox[{"expr", ",", "_Symbol"}], "]"}], ",", 
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "expr", "}"}]}], "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"terms", "=", 
           RowBox[{"List", "@@", "expr"}]}], ";", "\n", 
          RowBox[{"terms", "=", 
           RowBox[{"Select", "[", 
            RowBox[{"terms", ",", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"FreeQ", "[", 
                RowBox[{"#", ",", "_Symbol"}], "]"}]}], "&"}]}], "]"}]}], 
          ";"}]}], "]"}], ";", "\n", "terms"}]}], "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"Clear", "[", "splitCoefficient2", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"splitCoefficient2", "[", "term_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "coeff", ",", "vars", ",", "randSplit", ",", "choice", ",", 
        "randterm"}], "}"}], ",", "\n", "\n", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Variables", "[", "term", "]"}], "]"}], "==", "0"}], ",", 
         "\n", 
         RowBox[{
          RowBox[{"randterm", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "term"}], "}"}], "]"}]}], ";", "\n", 
          RowBox[{"Return", "[", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"randterm", ",", 
                RowBox[{"term", "-", "randterm"}]}], "}"}], ",", 
              RowBox[{"{", "term", "}"}]}], "}"}], "]"}], "]"}], ";"}], ",", 
         "\n", "term"}], " ", "\n", "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "term", "]"}], "-", 
           RowBox[{"Length", "[", 
            RowBox[{"Variables", "[", "term", "]"}], "]"}]}], " ", "<=", " ", 
          "0"}], ",", "\n", 
         RowBox[{
          RowBox[{"coeff", " ", "=", " ", "1"}], ";", "\n", 
          RowBox[{"vars", " ", "=", " ", "term"}], ";", "\n", 
          RowBox[{"Return", "[", "term", "]"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"coeff", "=", 
           RowBox[{"Coefficient", "[", 
            RowBox[{"term", ",", " ", 
             RowBox[{"term", "/", 
              RowBox[{"term", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}], ";", "\n", 
          RowBox[{"vars", "=", 
           RowBox[{"term", "/", 
            RowBox[{"term", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], "\n", "]"}], ";", "\n", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"coeff", "==", "0"}], "||", 
          RowBox[{"coeff", "==", "1"}], "||", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "term", "]"}], "-", 
            RowBox[{"Length", "[", 
             RowBox[{"Variables", "[", "term", "]"}], "]"}]}], " ", "==", " ",
            "0"}]}], ",", "\n", 
         RowBox[{
          RowBox[{"Return", "[", 
           RowBox[{"{", "term", "}"}], "]"}], ";"}], "\n", ",", "\n", 
         RowBox[{
          RowBox[{"randSplit", "=", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", 
              RowBox[{
               RowBox[{"Abs", "[", "coeff", "]"}], "-", "1"}]}], "}"}], 
            "]"}]}], ";", "\n", 
          RowBox[{"choice", "=", 
           RowBox[{"RandomChoice", "[", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", "\n", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"choice", "==", "0"}], ",", "\n", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"randSplit", "*", "vars", "*", 
                RowBox[{"Sign", "[", "coeff", "]"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Abs", "[", "coeff", "]"}], "-", "randSplit"}], 
                 ")"}], "*", "vars", "*", 
                RowBox[{"Sign", "[", "coeff", "]"}]}]}], "}"}], "]"}], ",", 
            "\n", 
            RowBox[{"Return", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Abs", "[", "coeff", "]"}], "*", "vars", "*", 
               RowBox[{"Sign", "[", "coeff", "]"}]}], "}"}], "]"}]}], "\n", 
           "]"}], ";"}]}], "\n", "]"}], ";"}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
    "Clear", "[", "RandomPolynomialWithSplit2$PolyNInPoly2$LSS", "]"}], ";"}],
    "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RandomPolynomialWithSplit2$PolyNInPoly2$LSS", "[", "\n", "  ", 
      RowBox[{
      "intMax_Integer", ",", " ", "\n", "  ", "degMax_Integer", ",", " ", 
       "\n", "  ", "subintMax_Integer", ",", " ", "\n", "  ", 
       "subdegMax_Integer", ",", " ", "\n", "  ", "vars_List"}], "\n", "]"}], 
     " ", ":=", " ", 
     RowBox[{"Module", "[", "\n", "  ", 
      RowBox[{
       RowBox[{"{", "\n", "    ", 
        RowBox[{
        "short", ",", " ", "sub", ",", " ", "long$expand", ",", " ", 
         "retrial", ",", " ", "splitTerms"}], "\n", "  ", "}"}], ",", "\n", 
       "  ", "\n", 
       RowBox[{
        RowBox[{
         RowBox[{"retrial", "[", "]"}], ":=", 
         RowBox[{"RandomPolynomialWithSplit2$PolyNInPoly2$LSS", "[", 
          RowBox[{
          "intMax", ",", "degMax", ",", "subintMax", ",", "subdegMax", ",", 
           "vars"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"short", "=", 
         RowBox[{"RandomPolynomial", "[", 
          RowBox[{"intMax", ",", "degMax", ",", 
           RowBox[{"{", "s", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"sub", "=", 
         RowBox[{"RandomPolynomial$WithHighestCoeff1", "[", 
          RowBox[{"subintMax", ",", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"2", ",", "subdegMax"}], "}"}], "]"}], ",", "vars"}], 
          "]"}]}], ";", "\n", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"FreeQ", "[", 
           RowBox[{"short", ",", "s"}], "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"FreeQ", "[", 
            RowBox[{"sub", ",", 
             RowBox[{"Alternatives", "@@", "vars"}]}], "]"}], "\[LessEqual]", 
           "0"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"long$expand", ",", "long"}], "}"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"short", "/.", 
             RowBox[{"s", "\[Rule]", "sub"}]}], "//", "Expand"}], ",", 
           RowBox[{"short", "/.", 
            RowBox[{"s", "\[Rule]", "sub"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"long$expand", "===", "0"}], ",", 
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Warning : \>\"", ",", "short", ",", " ", "\"\< s=\>\"", ",", 
            "sub"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", "\n", " ", 
        "\n", "  ", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "long$expand", "]"}], ">", "1"}], " ", "&&",
            " ", 
           RowBox[{
            RowBox[{"Head", "[", "long$expand", "]"}], " ", "===", " ", 
            "Plus"}]}], ",", "\n", "    ", 
          RowBox[{
           RowBox[{"splitTerms", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"splitCoefficient2", "/@", 
                RowBox[{"(", 
                 RowBox[{"List", "@@", "long$expand"}], ")"}]}], ",", " ", 
               "1"}], "]"}], "]"}]}], ";"}], "\n", "  ", ",", "\n", "    ", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"long$expand", " ", "===", " ", "0"}], ",", "\n", 
             "      ", 
             RowBox[{
              RowBox[{"splitTerms", " ", "=", " ", "0"}], ";"}], ",", "\n", 
             "      ", 
             RowBox[{
              RowBox[{"splitTerms", "=", 
               RowBox[{
                RowBox[{"Inactive", "[", "Plus", "]"}], "@@", 
                RowBox[{"splitCoefficient2", "[", "long$expand", "]"}]}]}], 
              ";"}]}], "\n", "    ", "]"}], ";"}]}], "\n", "  ", "]"}], ";", 
        "\n", "  ", 
        RowBox[{"{", 
         RowBox[{"long$expand", ",", 
          RowBox[{
           RowBox[{"Inactive", "[", "Plus", "]"}], "@@", "splitTerms"}], ",", 
          "short", ",", "sub"}], "}"}]}]}], "\n", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"Multivariable", " ", "Experiment", " ", 
     RowBox[{"w", "/", " ", "Distribute"}]}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"CombineMyPlus", "[", "expr_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "result", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"expr", " ", "/.", " ", 
         RowBox[{"{", "\n", "    ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Case", " ", "1"}], ":", " ", 
            RowBox[{"List", " ", "of", " ", "myplus", " ", "expressions"}]}], 
           " ", "*)"}], "\n", "    ", 
          RowBox[{
           RowBox[{
            RowBox[{"List", "[", 
             RowBox[{"a___", ",", " ", 
              RowBox[{"myplus", "[", "b___", "]"}], ",", " ", "c___", ",", 
              " ", 
              RowBox[{"myplus", "[", "d___", "]"}], ",", " ", "e___"}], "]"}],
             " ", ":>", " ", "\n", "      ", 
            RowBox[{"List", "[", 
             RowBox[{"a", ",", " ", 
              RowBox[{"myplus", "[", 
               RowBox[{"b", ",", " ", "d"}], "]"}], ",", " ", "c", ",", " ", 
              "e"}], "]"}]}], ",", "\n", "    ", "\n", "    ", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"Case", " ", "2"}], ":", " ", 
             RowBox[{"Single", " ", "element", " ", "in", " ", "myplus"}]}], 
            " ", "*)"}], "\n", "    ", 
           RowBox[{
            RowBox[{
             RowBox[{"List", "[", 
              RowBox[{"a___", ",", " ", "elem_", ",", " ", "b___"}], "]"}], 
             " ", "/;", " ", 
             RowBox[{"FreeQ", "[", 
              RowBox[{"elem", ",", " ", "myplus"}], "]"}]}], " ", ":>", " ", 
            "\n", "      ", 
            RowBox[{"List", "[", 
             RowBox[{"a", ",", " ", 
              RowBox[{"myplus", "[", "elem", "]"}], ",", " ", "b"}], 
             "]"}]}]}], "\n", "  ", "}"}]}]}], ";", "\n", "  ", "\n", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "If", " ", "the", " ", "result", " ", "still", " ", "contains", " ", 
          "multiple", " ", "myplus", " ", "expressions"}], ",", " ", 
         RowBox[{"keep", " ", "combining"}]}], " ", "*)"}], "\n", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{"result", ",", " ", "_myplus", ",", " ", "Infinity"}], 
           "]"}], " ", ">", " ", "1"}], ",", "\n", "    ", 
         RowBox[{"result", " ", "=", " ", 
          RowBox[{"CombineMyPlus", "[", "result", "]"}]}]}], "\n", "  ", 
        "]"}], ";", "\n", "  ", "\n", "  ", 
       RowBox[{"(*", " ", 
        RowBox[{"Finally", ",", " ", 
         RowBox[{
         "combine", " ", "all", " ", "remaining", " ", "elements", " ", 
          "into", " ", "single", " ", "myplus"}]}], " ", "*)"}], "\n", "  ", 
       RowBox[{"myplus", " ", "@@", " ", 
        RowBox[{"Flatten", "[", 
         RowBox[{"result", " ", "/.", " ", 
          RowBox[{"myplus", " ", "->", " ", "List"}]}], "]"}]}]}]}], "\n", 
     "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{"DistributeExpression", "[", "expr_", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "result", "}"}], ",", "\n", "  ", 
      RowBox[{
       RowBox[{"ClearAttributes", "[", 
        RowBox[{"mytimes", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", 
       RowBox[{"ClearAttributes", "[", 
        RowBox[{"myplus", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", "\n", "  ", 
       RowBox[{"SetAttributes", "[", 
        RowBox[{"mytimes", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", 
       RowBox[{"SetAttributes", "[", 
        RowBox[{"myplus", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", "\n", "  ", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"expr", " ", "/.", " ", 
           RowBox[{"Inactive", " ", "->", " ", "Identity"}]}], " ", "/.", " ", 
          RowBox[{"Times", " ", "->", " ", "mytimes"}]}], " ", "/.", " ", 
         RowBox[{"Power", " ", "->", " ", "mypow"}]}]}], ";", "\n", "  ", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"result", " ", "/.", " ", 
         RowBox[{
          RowBox[{"mypow", "[", 
           RowBox[{"exp_", ",", " ", "n_"}], "]"}], " ", ":>", " ", 
          RowBox[{"mytimes", " ", "@@", " ", 
           RowBox[{"Table", "[", 
            RowBox[{"exp", ",", " ", "n"}], "]"}]}]}]}]}], ";", "\n", "  ", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"result", " ", "/.", " ", 
         RowBox[{"Plus", " ", "->", " ", "myplus"}]}]}], ";", "\n", "  ", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"Distribute", "[", 
         RowBox[{"result", ",", " ", "myplus", ",", " ", "mytimes"}], "]"}]}],
        ";", "\n", "  ", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"result", " ", "/.", " ", 
         RowBox[{"mytimes", " ", "->", " ", "Times"}]}]}], ";", "\n", "  ", 
       RowBox[{"result", " ", "=", " ", 
        RowBox[{"result", " ", "/.", " ", 
         RowBox[{"mypow", " ", "->", " ", "Power"}]}]}], ";", "\n", "  ", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"result", " ", "=", " ", 
          RowBox[{"result", " ", "/.", " ", 
           RowBox[{"myplus", " ", "->", " ", 
            RowBox[{"Inactive", "[", "Plus", "]"}]}]}]}], ";"}], "*)"}], "\n",
        "  ", "\n", "  ", 
       RowBox[{"ClearAttributes", "[", 
        RowBox[{"mytimes", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", 
       RowBox[{"ClearAttributes", "[", 
        RowBox[{"myplus", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", "\n", "  ", "result"}]}], "\n", "]"}]}], "\n", "\n", 
   RowBox[{
    RowBox[{
    "Clear", "[", "RandomPolynomialWithDistribute$PolyNInPoly4$LSS", "]"}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
    "RandomPolynomialWithDistribute$PolyNInPoly4$LSS", "[", "\n", "  ", 
     RowBox[{
     "intMax_Integer", ",", " ", "\n", "  ", "degMax_Integer", ",", " ", "\n",
       "  ", "subintMax_Integer", ",", " ", "\n", "  ", "subdegMax_Integer", 
      ",", " ", "\n", "  ", "subvars_List", ",", " ", "\n", "  ", 
      "maxlength_Integer", ",", " ", "\n", "  ", "submaxlength_Integer"}], 
     "\n", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", "\n", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "short", ",", " ", "sub1", ",", " ", "sub2", ",", " ", "expandedForm", 
        ",", " ", "nonExpandedForm", ",", " ", "distributedForm"}], "}"}], 
      ",", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"Renamed", " ", "variables"}], " ", "*)"}], "\n", "  ", 
      RowBox[{
       RowBox[{"short", " ", "=", " ", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{"intMax", ",", " ", "degMax", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], ",", " ", 
            RowBox[{"b", "[", "1", "]"}]}], "}"}], ",", " ", "maxlength"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"sub1", " ", "=", " ", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{
         "subintMax", ",", " ", "subdegMax", ",", " ", "subvars", ",", " ", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "submaxlength"}], "}"}], "]"}]}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"sub2", " ", "=", " ", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{
         "subintMax", ",", " ", "subdegMax", ",", " ", "subvars", ",", " ", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "submaxlength"}], "}"}], "]"}]}], "]"}]}], 
       ";", "\n", "  ", "\n", "  ", 
       RowBox[{"SetAttributes", "[", 
        RowBox[{"mytimes", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", 
       RowBox[{"SetAttributes", "[", 
        RowBox[{"myplus", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", "\n", 
       RowBox[{"(*", "  ", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Original Expression:\>\"", "]"}], ";", 
         "\n", "  ", 
         RowBox[{"Print", "[", 
          RowBox[{"short", " ", "/.", " ", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"b", "[", "0", "]"}], " ", "->", " ", "sub1"}], ",", 
             " ", 
             RowBox[{
              RowBox[{"b", "[", "1", "]"}], " ", "->", " ", "sub2"}]}], 
            "}"}]}], "]"}], ";"}], "*)"}], "\n", "  ", "\n", "  ", 
       RowBox[{"expandedForm", " ", "=", " ", 
        RowBox[{"Expand", "[", 
         RowBox[{"short", " ", "/.", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"b", "[", "0", "]"}], " ", "->", " ", "sub1"}], ",", " ", 
            RowBox[{
             RowBox[{"b", "[", "1", "]"}], " ", "->", " ", "sub2"}]}], 
           "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"nonExpandedForm", " ", "=", " ", 
        RowBox[{"short", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], " ", "->", " ", "sub1"}], ",", " ", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], " ", "->", " ", "sub2"}]}], 
          "}"}]}]}], ";", "\n", "  ", "\n", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "nonExpandedForm", "]"}], ">", "1"}], " ", "&&",
           " ", 
          RowBox[{
           RowBox[{"Head", "[", "nonExpandedForm", "]"}], " ", "===", " ", 
           "Plus"}]}], ",", "\n", 
         RowBox[{"(*", "    ", 
          RowBox[{
           RowBox[{"Print", "[", "\"\<Non Expanded Form List:\>\"", "]"}], 
           ";", "\n", "    ", 
           RowBox[{"Print", "[", 
            RowBox[{"List", " ", "@@", " ", "nonExpandedForm"}], "]"}], ";"}],
           "*)"}], "\n", "    ", 
         RowBox[{"distributedForm", " ", "=", " ", 
          RowBox[{
           RowBox[{"CombineMyPlus", "[", 
            RowBox[{"DistributeExpression", "/@", 
             RowBox[{"(", 
              RowBox[{"List", " ", "@@", " ", "nonExpandedForm"}], ")"}]}], 
            "]"}], " ", "/.", " ", 
           RowBox[{"myplus", " ", "->", " ", 
            RowBox[{"Inactive", "[", "Plus", "]"}]}]}]}], "\n", "  ", ",", 
         "\n", "    ", 
         RowBox[{
          RowBox[{"distributedForm", " ", "=", " ", "expandedForm"}], ";"}]}],
         "\n", "  ", "]"}], ";", "\n", "  ", "\n", 
       RowBox[{"(*", "  ", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<Distributed Form:\>\"", "]"}], ";", "\n", 
         "  ", 
         RowBox[{"Print", "[", "distributedForm", "]"}], ";"}], "*)"}], "\n", 
       "  ", "\n", "  ", 
       RowBox[{"{", 
        RowBox[{
        "expandedForm", ",", " ", "distributedForm", ",", " ", "short", ",", 
         " ", "sub1", ",", " ", "sub2"}], "}"}]}]}], "\n", 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.935045304695348*^9, 3.935045328913621*^9}, {
   3.9350453653563137`*^9, 3.935045402370321*^9}, {3.935702498000012*^9, 
   3.935702503262661*^9}, {3.935702580121951*^9, 3.9357025825236273`*^9}, {
   3.9357026402072287`*^9, 3.935702787381686*^9}, {3.935702824280847*^9, 
   3.935702841286632*^9}, {3.935702909173308*^9, 3.935702921651108*^9}, {
   3.935703059176128*^9, 3.935703195096694*^9}, {3.935703271525215*^9, 
   3.935703272089038*^9}, {3.935703417664021*^9, 3.93570346607624*^9}, {
   3.935703576314962*^9, 3.9357036334765263`*^9}, {3.935703799182241*^9, 
   3.935703848900515*^9}, {3.935703880989091*^9, 3.9357039203711567`*^9}, 
   3.935704153453145*^9, {3.9357041955718107`*^9, 3.935704230040572*^9}, {
   3.935704585730462*^9, 3.9357045898156557`*^9}, {3.9357046270746717`*^9, 
   3.935704641540208*^9}, {3.935704923223903*^9, 3.935705021311428*^9}, {
   3.935705070271254*^9, 3.9357050730377*^9}, {3.935705152458585*^9, 
   3.935705155630427*^9}, {3.935705705659408*^9, 3.935705707722835*^9}, {
   3.937097429812411*^9, 3.9370974324016*^9}, {3.937097477491369*^9, 
   3.937097494937162*^9}, {3.938717237304301*^9, 3.938717248751181*^9}, {
   3.939580938899694*^9, 3.9395809396669207`*^9}, {3.939581434349087*^9, 
   3.939581443674075*^9}, {3.9395816703778477`*^9, 3.939581693413176*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"da38e9f0-8159-4954-9e9d-aa705ce0aad9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Variable", " ", 
      RowBox[{"(", 
       RowBox[{"Original", " ", "/", " ", "Substituion"}], ")"}]}], ":", " ", 
     "3"}], ",", " ", "3"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Degree", " ", 
      RowBox[{"(", 
       RowBox[{"Original", " ", "/", " ", "Substituion"}], ")"}]}], ":", " ", 
     "3"}], ",", " ", "3"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
    "Clear", "[", "RandomPolynomialWithDistributeVar3$PolyNInPoly4$LSS", 
     "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
    "RandomPolynomialWithDistributeVar3$PolyNInPoly4$LSS", "[", "\n", "  ", 
     RowBox[{
     "intMax_Integer", ",", " ", "\n", "  ", "degMax_Integer", ",", " ", "\n",
       "  ", "subintMax_Integer", ",", " ", "\n", "  ", "subdegMax_Integer", 
      ",", " ", "\n", "  ", "subvars_List", ",", " ", "\n", "  ", 
      "maxlength_Integer", ",", " ", "\n", "  ", "submaxlength_Integer"}], 
     "\n", "]"}], " ", ":=", " ", 
    RowBox[{"Block", "[", "\n", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "short", ",", " ", "sub1", ",", " ", "sub2", ",", " ", "sub3", ",", 
        " ", "expandedForm", ",", " ", "nonExpandedForm", ",", " ", 
        "distributedForm"}], "}"}], ",", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"Added", " ", "sub3"}], " ", "*)"}], "\n", "  ", 
      RowBox[{
       RowBox[{"short", " ", "=", " ", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{"intMax", ",", " ", "degMax", ",", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], ",", " ", 
            RowBox[{"b", "[", "1", "]"}], ",", " ", 
            RowBox[{"b", "[", "2", "]"}]}], "}"}], ",", " ", "maxlength"}], 
         "]"}]}], ";", "\n", "  ", 
       RowBox[{"sub1", " ", "=", " ", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{
         "subintMax", ",", " ", "subdegMax", ",", " ", "subvars", ",", " ", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "submaxlength"}], "}"}], "]"}]}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"sub2", " ", "=", " ", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{
         "subintMax", ",", " ", "subdegMax", ",", " ", "subvars", ",", " ", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "submaxlength"}], "}"}], "]"}]}], "]"}]}], 
       ";", "\n", "  ", 
       RowBox[{"sub3", " ", "=", " ", 
        RowBox[{"RandomPolynomial$maxlength", "[", 
         RowBox[{
         "subintMax", ",", " ", "subdegMax", ",", " ", "subvars", ",", " ", 
          RowBox[{"RandomInteger", "[", 
           RowBox[{"{", 
            RowBox[{"1", ",", " ", "submaxlength"}], "}"}], "]"}]}], "]"}]}], 
       ";", "\n", "  ", "\n", "  ", 
       RowBox[{"SetAttributes", "[", 
        RowBox[{"mytimes", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", 
       RowBox[{"SetAttributes", "[", 
        RowBox[{"myplus", ",", " ", 
         RowBox[{"{", 
          RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", 
       "\n", "  ", "\n", "  ", 
       RowBox[{"expandedForm", " ", "=", " ", 
        RowBox[{"Expand", "[", 
         RowBox[{"short", " ", "/.", " ", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"b", "[", "0", "]"}], " ", "->", " ", "sub1"}], ",", " ", 
            RowBox[{
             RowBox[{"b", "[", "1", "]"}], " ", "->", " ", "sub2"}], ",", " ", 
            RowBox[{
             RowBox[{"b", "[", "2", "]"}], " ", "->", " ", "sub3"}]}], 
           "}"}]}], "]"}]}], ";", "\n", "  ", 
       RowBox[{"nonExpandedForm", " ", "=", " ", 
        RowBox[{"short", " ", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], " ", "->", " ", "sub1"}], ",", " ", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], " ", "->", " ", "sub2"}], ",", " ", 
           RowBox[{
            RowBox[{"b", "[", "2", "]"}], " ", "->", " ", "sub3"}]}], 
          "}"}]}]}], ";", "\n", "  ", "\n", "  ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "nonExpandedForm", "]"}], ">", "1"}], " ", "&&",
           " ", 
          RowBox[{
           RowBox[{"Head", "[", "nonExpandedForm", "]"}], " ", "===", " ", 
           "Plus"}]}], ",", "\n", "    ", 
         RowBox[{"distributedForm", " ", "=", " ", 
          RowBox[{
           RowBox[{"CombineMyPlus", "[", 
            RowBox[{"DistributeExpression", "/@", 
             RowBox[{"(", 
              RowBox[{"List", " ", "@@", " ", "nonExpandedForm"}], ")"}]}], 
            "]"}], " ", "/.", " ", 
           RowBox[{"myplus", " ", "->", " ", 
            RowBox[{"Inactive", "[", "Plus", "]"}]}]}]}], "\n", "  ", ",", 
         "\n", "    ", 
         RowBox[{
          RowBox[{"distributedForm", " ", "=", " ", "expandedForm"}], ";"}]}],
         "\n", "  ", "]"}], ";", "\n", "  ", "\n", "  ", 
       RowBox[{"{", 
        RowBox[{
        "expandedForm", ",", " ", "distributedForm", ",", " ", "short", ",", 
         " ", "sub1", ",", " ", "sub2", ",", " ", "sub3"}], "}"}]}]}], "\n", 
     "]"}]}]}]}]], "Code",
 CellChangeTimes->{{3.939581710426703*^9, 3.939581710846909*^9}, {
   3.939581818983638*^9, 3.939581862105655*^9}, {3.939581949211902*^9, 
   3.939581968708509*^9}, {3.939582000886777*^9, 3.939582050057979*^9}, 
   3.9395821353240943`*^9},
 CellLabel->"In[58]:=",ExpressionUUID->"6849b25d-ea31-48b3-8d3f-31f9ed8fbac5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomialWithDistributeVar3$PolyNInPoly4$LSS", "[", 
  RowBox[{"5", ",", "2", ",", "5", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], ",", 
     RowBox[{"a", "[", "1", "]"}], ",", " ", 
     RowBox[{"a", "[", "2", "]"}]}], "}"}], ",", "3", ",", "3"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.9351080253473787`*^9, 3.935108048609476*^9}, {
   3.935108132578107*^9, 3.935108133235413*^9}, {3.935108599617175*^9, 
   3.935108615039724*^9}, {3.93570292672325*^9, 3.935702945723546*^9}, 
   3.93570392958181*^9, {3.937097507275052*^9, 3.937097509863106*^9}, 
   3.9395821434921*^9, {3.9395822021438637`*^9, 3.9395822274495277`*^9}},
 CellLabel->
  "In[193]:=",ExpressionUUID->"cdf3aa0a-9b06-48b6-898b-82778a169101"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"a", "[", "0", "]"}]}], "+", 
    RowBox[{"12", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "0", "]"}], "2"]}], "-", 
    RowBox[{"15", " ", 
     RowBox[{"a", "[", "0", "]"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"15", " ", 
     RowBox[{"a", "[", "0", "]"}], " ", 
     RowBox[{"a", "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"a", "[", "0", "]"}]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "0", "]"}], "2"]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{"15", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "0", "]"}], "2"]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{
     RowBox[{"-", "15"}], " ", 
     RowBox[{"a", "[", "0", "]"}], " ", 
     RowBox[{"a", "[", "1", "]"}]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{
     RowBox[{"-", "15"}], " ", 
     RowBox[{"a", "[", "0", "]"}], " ", 
     RowBox[{"a", "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"b", "[", "1", "]"}]}], "-", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{"5", " ", 
     RowBox[{"b", "[", "1", "]"}], " ", 
     RowBox[{"b", "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"a", "[", "0", "]"}]}], "+", 
    RowBox[{"a", "[", "2", "]"}]}], ",", 
   RowBox[{"a", "[", "0", "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     RowBox[{"a", "[", "0", "]"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{"a", "[", "1", "]"}]}], "+", 
    RowBox[{"3", " ", 
     RowBox[{"a", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.935108691654007*^9, 3.9351086979473057`*^9}, {
   3.935702936678714*^9, 3.935702946206667*^9}, {3.935703202676927*^9, 
   3.935703230400893*^9}, {3.9357032802545557`*^9, 3.93570328750909*^9}, {
   3.935703641404628*^9, 3.935703643310064*^9}, {3.935703926530366*^9, 
   3.935703955255076*^9}, {3.93570423581956*^9, 3.935704256270963*^9}, {
   3.935704428181334*^9, 3.935704444916864*^9}, {3.935705040919609*^9, 
   3.935705048534239*^9}, {3.935705085032363*^9, 3.93570511970129*^9}, {
   3.93570516091084*^9, 3.935705220603196*^9}, {3.9370975102049093`*^9, 
   3.937097530142447*^9}, 3.939582162681149*^9, {3.939582204059877*^9, 
   3.939582242126956*^9}, {3.9399186168698993`*^9, 3.939918624658621*^9}},
 CellLabel->
  "Out[193]=",ExpressionUUID->"9042e276-5cd5-4427-9daa-3f899f2ba4ea"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$PolyNInPoly5$LSS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$PolyNInPoly5$LSS", "[", 
    RowBox[{
    "intMax_Integer", ",", "degMax_Integer", ",", "subintMax_Integer", ",", 
     "subdegMax_Integer", ",", "subvars_List", ",", "subvars2_List", ",", 
     "\n", "maxlength_Integer", ",", "submaxlength_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", "sub1", ",", "sub2", ",", "long$expand", ",", "long", ",",
        "retrial"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrial", "[", "]"}], ":=", 
       RowBox[{"RandomPolynomial$PolyNInPoly5$LSS", "[", 
        RowBox[{
        "intMax", ",", "degMax", ",", "subintMax", ",", "subdegMax", ",", 
         "subvars", ",", "maxlength", ",", "submaxlength"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial$maxlength$fix", "[", 
        RowBox[{"intMax", ",", "degMax", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"b", "[", "0", "]"}], ",", 
           RowBox[{"b", "[", "1", "]"}]}], "}"}], ",", "maxlength"}], "]"}]}],
       ";", "\n", 
      RowBox[{"sub1", "=", 
       RowBox[{"RandomPolynomial$maxlength$fix", "[", 
        RowBox[{"subintMax", ",", "subdegMax", ",", "subvars", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "submaxlength"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\n", 
      RowBox[{"sub2", "=", 
       RowBox[{"RandomPolynomial$maxlength$fix", "[", 
        RowBox[{"subintMax", ",", "subdegMax", ",", "subvars2", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "submaxlength"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"long$expand", "=", 
       RowBox[{
        RowBox[{"short", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "\[Rule]", "sub1"}], ",", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "->", "sub2"}]}], "}"}]}], "//", 
        "Expand"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"retrial", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"long$expand", ",", "short", ",", "sub1", ",", "sub2"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
   3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
   3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}, {
   3.928726261318315*^9, 3.9287263182582026`*^9}, {3.9287263830839825`*^9, 
   3.928726400282058*^9}, {3.928726641715729*^9, 3.928726709426447*^9}, {
   3.928726746765503*^9, 3.928726750674468*^9}, {3.929073795897071*^9, 
   3.929073905015635*^9}, 3.929074240838964*^9, {3.929693697532645*^9, 
   3.929693740929082*^9}, {3.930213915986288*^9, 3.930213916278241*^9}, {
   3.93021397582139*^9, 3.930213997766171*^9}, {3.9302140361301937`*^9, 
   3.9302140364558153`*^9}, {3.930215237065489*^9, 3.930215241155187*^9}, {
   3.931966593416523*^9, 3.93196664671953*^9}, {3.931966715024255*^9, 
   3.931966734279604*^9}, {3.931966781831505*^9, 3.931966819973034*^9}, {
   3.931966933379026*^9, 3.931966943593693*^9}, {3.93196736693241*^9, 
   3.931967377858004*^9}, {3.932053562069384*^9, 3.9320535622125597`*^9}, {
   3.932053592607184*^9, 3.932053623789177*^9}, {3.932053674781619*^9, 
   3.932053734496317*^9}, {3.9320537779125853`*^9, 3.932053905297308*^9}, {
   3.932053976099035*^9, 3.932053986564485*^9}, {3.932054135034429*^9, 
   3.932054137074844*^9}, {3.932592421876273*^9, 3.932592472121687*^9}, {
   3.932592509091553*^9, 3.932592553930071*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"43840fc5-eed8-49e0-a79b-9cefe9637d4f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "RandomPolynomial$PolyNInPoly6$LSS", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\n", 
   RowBox[{"intMax", " ", ":", " ", 
    RowBox[{
    "max", " ", "coefficient", " ", "of", " ", "original", " ", "expression", 
     "\n", "degMax"}], " ", ":", " ", 
    RowBox[{
    "degree", " ", "of", " ", "terms", " ", "in", " ", "original", " ", 
     "expression", " ", 
     RowBox[{"(", " ", 
      RowBox[{"all", " ", "has", " ", "same", " ", "degree"}], " ", ")"}], 
     "\n", 
     RowBox[{"subintMax", " ", ":", " ", 
      RowBox[{
      "max", " ", "coefficient", " ", "of", " ", "substitution", "\n", 
       "subdegMax"}], " ", ":", " ", 
      RowBox[{
      "degree", " ", "of", " ", "terms", " ", "in", " ", "substitutions", " ", 
       RowBox[{"(", " ", 
        RowBox[{"all", " ", "has", " ", "same", " ", "degree"}], " ", ")"}], 
       "\n", 
       RowBox[{"originvars", " ", ":", " ", 
        RowBox[{
        "set", " ", "of", " ", "variables", " ", "in", " ", "original", " ", 
         "expression", "\n", "subvars"}], " ", ":", " ", 
        RowBox[{
        "set", " ", "of", " ", "variables", " ", "in", " ", "substitutions", 
         "\n", 
         RowBox[{"maxlength", " ", ":", " ", 
          RowBox[{
           RowBox[{
           "max", " ", "number", " ", "of", " ", "terms", " ", "of", " ", 
            "original", " ", "expression"}], " ", "-", " ", 
           RowBox[{"fixed", "\n", "submaxlength"}]}], " ", ":", " ", 
          RowBox[{
           RowBox[{
           "max", " ", "number", " ", "of", " ", "terms", " ", "of", " ", 
            "substitutions"}], " ", "-", " ", 
           RowBox[{"not", " ", "fixed"}]}]}]}]}]}]}]}]}], "\n", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"RandomPolynomial$PolyNInPoly6$LSS", "[", 
     RowBox[{
     "intMax_Integer", ",", "degMax_Integer", ",", "subintMax_Integer", ",", 
      "subdegMax_Integer", ",", "originvars_List", ",", "subvars_List", ",", 
      "\n", "maxlength_Integer", ",", "submaxlength_Integer"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "short", ",", "sub", ",", "long$expand", ",", "long", ",", "retrial", 
        ",", "originvarslen"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"retrial", "[", "]"}], ":=", 
        RowBox[{"RandomPolynomial$PolyNInPoly6$LSS", "[", 
         RowBox[{
         "intMax", ",", "degMax", ",", "subintMax", ",", "subdegMax", ",", 
          "originvars", ",", "subvars", ",", "maxlength", ",", 
          "submaxlength"}], "]"}]}], ";", "\[IndentingNewLine]", "\n", 
       RowBox[{"originvarslen", " ", "=", " ", 
        RowBox[{"Length", "[", "originvars", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"short", "=", 
        RowBox[{"RandomPolynomial$maxlength$fix", "[", 
         RowBox[{
         "intMax", ",", "degMax", ",", "originvars", ",", "maxlength"}], 
         "]"}]}], ";", "\n", 
       RowBox[{"sub", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"RandomPolynomial$maxlength$fix", "[", 
           RowBox[{"subintMax", ",", "subdegMax", ",", "subvars", ",", 
            RowBox[{"RandomInteger", "[", 
             RowBox[{"{", 
              RowBox[{"1", ",", "submaxlength"}], "}"}], "]"}]}], "]"}], ",", 
          "originvarslen"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"long$expand", "=", 
        RowBox[{
         RowBox[{"short", "/.", " ", 
          RowBox[{"Thread", "[", 
           RowBox[{"originvars", " ", "->", " ", "sub"}], "]"}]}], "//", 
         "Expand"}]}], ";", "\[IndentingNewLine]", "\n", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "sub", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===",
             "0"}], ",", 
           RowBox[{"retrial", "[", "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "originvarslen"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"long$expand", "===", "0"}], ",", 
         RowBox[{"retrial", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"long$expand", ",", "short"}], "}"}], " ", "~", "Join", "~", 
        " ", "sub"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"Multivariable", " ", "Experiment", " ", 
    RowBox[{"w", "/", " ", "Distribute"}]}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"CombineMyPlus", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"expr", " ", "/.", " ", 
        RowBox[{"{", "\n", "    ", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"Case", " ", "1"}], ":", " ", 
           RowBox[{"List", " ", "of", " ", "myplus", " ", "expressions"}]}], 
          " ", "*)"}], "\n", "    ", 
         RowBox[{
          RowBox[{
           RowBox[{"List", "[", 
            RowBox[{"a___", ",", " ", 
             RowBox[{"myplus", "[", "b___", "]"}], ",", " ", "c___", ",", " ", 
             RowBox[{"myplus", "[", "d___", "]"}], ",", " ", "e___"}], "]"}], 
           " ", ":>", " ", "\n", "      ", 
           RowBox[{"List", "[", 
            RowBox[{"a", ",", " ", 
             RowBox[{"myplus", "[", 
              RowBox[{"b", ",", " ", "d"}], "]"}], ",", " ", "c", ",", " ", 
             "e"}], "]"}]}], ",", "\n", "    ", "\n", "    ", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Case", " ", "2"}], ":", " ", 
            RowBox[{"Single", " ", "element", " ", "in", " ", "myplus"}]}], 
           " ", "*)"}], "\n", "    ", 
          RowBox[{
           RowBox[{
            RowBox[{"List", "[", 
             RowBox[{"a___", ",", " ", "elem_", ",", " ", "b___"}], "]"}], 
            " ", "/;", " ", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"elem", ",", " ", "myplus"}], "]"}]}], " ", ":>", " ", 
           "\n", "      ", 
           RowBox[{"List", "[", 
            RowBox[{"a", ",", " ", 
             RowBox[{"myplus", "[", "elem", "]"}], ",", " ", "b"}], "]"}]}]}],
          "\n", "  ", "}"}]}]}], ";", "\n", "  ", "\n", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "If", " ", "the", " ", "result", " ", "still", " ", "contains", " ", 
         "multiple", " ", "myplus", " ", "expressions"}], ",", " ", 
        RowBox[{"keep", " ", "combining"}]}], " ", "*)"}], "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Count", "[", 
          RowBox[{"result", ",", " ", "_myplus", ",", " ", "Infinity"}], 
          "]"}], " ", ">", " ", "1"}], ",", "\n", "    ", 
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"CombineMyPlus", "[", "result", "]"}]}]}], "\n", "  ", "]"}],
       ";", "\n", "  ", "\n", "  ", 
      RowBox[{"(*", " ", 
       RowBox[{"Finally", ",", " ", 
        RowBox[{
        "combine", " ", "all", " ", "remaining", " ", "elements", " ", "into",
          " ", "single", " ", "myplus"}]}], " ", "*)"}], "\n", "  ", 
      RowBox[{"myplus", " ", "@@", " ", 
       RowBox[{"Flatten", "[", 
        RowBox[{"result", " ", "/.", " ", 
         RowBox[{"myplus", " ", "->", " ", "List"}]}], "]"}]}]}]}], "\n", 
    "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"DistributeExpression", "[", "expr_", "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "result", "}"}], ",", "\n", "  ", 
     RowBox[{
      RowBox[{"ClearAttributes", "[", 
       RowBox[{"mytimes", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", "\n",
       "  ", 
      RowBox[{"ClearAttributes", "[", 
       RowBox[{"myplus", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", "\n",
       "  ", "\n", "  ", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"mytimes", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", "\n",
       "  ", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"myplus", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", "\n",
       "  ", "\n", "  ", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"expr", " ", "/.", " ", 
          RowBox[{"Inactive", " ", "->", " ", "Identity"}]}], " ", "/.", " ", 
         RowBox[{"Times", " ", "->", " ", "mytimes"}]}], " ", "/.", " ", 
        RowBox[{"Power", " ", "->", " ", "mypow"}]}]}], ";", "\n", "  ", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"result", " ", "/.", " ", 
        RowBox[{
         RowBox[{"mypow", "[", 
          RowBox[{"exp_", ",", " ", "n_"}], "]"}], " ", ":>", " ", 
         RowBox[{"mytimes", " ", "@@", " ", 
          RowBox[{"Table", "[", 
           RowBox[{"exp", ",", " ", "n"}], "]"}]}]}]}]}], ";", "\n", "  ", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"result", " ", "/.", " ", 
        RowBox[{"Plus", " ", "->", " ", "myplus"}]}]}], ";", "\n", "  ", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"Distribute", "[", 
        RowBox[{"result", ",", " ", "myplus", ",", " ", "mytimes"}], "]"}]}], 
      ";", "\n", "  ", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"result", " ", "/.", " ", 
        RowBox[{"mytimes", " ", "->", " ", "Times"}]}]}], ";", "\n", "  ", 
      RowBox[{"result", " ", "=", " ", 
       RowBox[{"result", " ", "/.", " ", 
        RowBox[{"mypow", " ", "->", " ", "Power"}]}]}], ";", "\n", "  ", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"result", " ", "=", " ", 
         RowBox[{"result", " ", "/.", " ", 
          RowBox[{"myplus", " ", "->", " ", 
           RowBox[{"Inactive", "[", "Plus", "]"}]}]}]}], ";"}], "*)"}], "\n", 
      "  ", "\n", "  ", 
      RowBox[{"ClearAttributes", "[", 
       RowBox[{"mytimes", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", "\n",
       "  ", 
      RowBox[{"ClearAttributes", "[", 
       RowBox[{"myplus", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", "\n",
       "  ", "\n", "  ", "result"}]}], "\n", "]"}]}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
   "Clear", "[", "RandomPolynomial$PolyNInPoly6$LSS$Distribute", "]"}], ";"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", "\n", 
   RowBox[{"intMax", " ", ":", " ", 
    RowBox[{
    "max", " ", "coefficient", " ", "of", " ", "original", " ", "expression", 
     "\n", "degMax"}], " ", ":", " ", 
    RowBox[{
    "degree", " ", "of", " ", "terms", " ", "in", " ", "original", " ", 
     "expression", " ", 
     RowBox[{"(", " ", 
      RowBox[{"all", " ", "has", " ", "same", " ", "degree"}], " ", ")"}], 
     "\n", 
     RowBox[{"subintMax", " ", ":", " ", 
      RowBox[{
      "max", " ", "coefficient", " ", "of", " ", "substitution", "\n", 
       "subdegMax"}], " ", ":", " ", 
      RowBox[{
      "degree", " ", "of", " ", "terms", " ", "in", " ", "substitutions", " ", 
       RowBox[{"(", " ", 
        RowBox[{"all", " ", "has", " ", "same", " ", "degree"}], " ", ")"}], 
       "\n", 
       RowBox[{"originvars", " ", ":", " ", 
        RowBox[{
        "set", " ", "of", " ", "variables", " ", "in", " ", "original", " ", 
         "expression", "\n", "subvars"}], " ", ":", " ", 
        RowBox[{
        "set", " ", "of", " ", "variables", " ", "in", " ", "substitutions", 
         "\n", 
         RowBox[{"maxlength", " ", ":", " ", 
          RowBox[{
           RowBox[{
           "max", " ", "number", " ", "of", " ", "terms", " ", "of", " ", 
            "original", " ", "expression"}], " ", "-", " ", 
           RowBox[{"fixed", "\n", "submaxlength"}]}], " ", ":", " ", 
          RowBox[{
           RowBox[{
           "max", " ", "number", " ", "of", " ", "terms", " ", "of", " ", 
            "substitutions"}], " ", "-", " ", 
           RowBox[{"not", " ", "fixed"}]}]}]}]}]}]}]}]}], "\n", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$PolyNInPoly6$LSS$Distribute", "[", 
    RowBox[{
    "intMax_Integer", ",", "degMax_Integer", ",", "subintMax_Integer", ",", 
     "subdegMax_Integer", ",", "originvars_List", ",", "subvars_List", ",", 
     "\n", "maxlength_Integer", ",", "submaxlength_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", "sub", ",", "long$expand", ",", "long", ",", "retrial", 
       ",", "originvarslen"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrial", "[", "]"}], ":=", 
       RowBox[{"RandomPolynomial$PolyNInPoly6$LSS", "[", 
        RowBox[{
        "intMax", ",", "degMax", ",", "subintMax", ",", "subdegMax", ",", 
         "originvars", ",", "subvars", ",", "maxlength", ",", 
         "submaxlength"}], "]"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"originvarslen", " ", "=", " ", 
       RowBox[{"Length", "[", "originvars", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial$maxlength$fix", "[", 
        RowBox[{
        "intMax", ",", "degMax", ",", "originvars", ",", "maxlength"}], 
        "]"}]}], ";", "\n", 
      RowBox[{"sub", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"RandomPolynomial$maxlength$fix", "[", 
          RowBox[{"subintMax", ",", "subdegMax", ",", "subvars", ",", 
           RowBox[{"RandomInteger", "[", 
            RowBox[{"{", 
             RowBox[{"1", ",", "submaxlength"}], "}"}], "]"}]}], "]"}], ",", 
         "originvarslen"}], "]"}]}], ";", "\[IndentingNewLine]", "\n", "  ", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"mytimes", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", "\n",
       "  ", 
      RowBox[{"SetAttributes", "[", 
       RowBox[{"myplus", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Flat", ",", " ", "OneIdentity"}], "}"}]}], "]"}], ";", "\n",
       "\[IndentingNewLine]", "  ", 
      RowBox[{"expandedForm", " ", "=", " ", 
       RowBox[{
        RowBox[{"short", "/.", " ", 
         RowBox[{"Thread", "[", 
          RowBox[{"originvars", " ", "->", " ", "sub"}], "]"}]}], "//", 
        "Expand"}]}], ";", "\[IndentingNewLine]", "  ", 
      RowBox[{"nonExpandedForm", " ", "=", " ", 
       RowBox[{"short", "/.", " ", 
        RowBox[{"Thread", "[", 
         RowBox[{"originvars", " ", "->", " ", "sub"}], "]"}]}]}], ";", "\n", 
      "\n", "  ", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "nonExpandedForm", "]"}], ">", "1"}], " ", "&&",
          " ", 
         RowBox[{
          RowBox[{"Head", "[", "nonExpandedForm", "]"}], " ", "===", " ", 
          "Plus"}]}], ",", "\n", "    ", 
        RowBox[{"distributedForm", " ", "=", " ", 
         RowBox[{
          RowBox[{"CombineMyPlus", "[", 
           RowBox[{"DistributeExpression", "/@", 
            RowBox[{"(", 
             RowBox[{"List", " ", "@@", " ", "nonExpandedForm"}], ")"}]}], 
           "]"}], " ", "/.", " ", 
          RowBox[{"myplus", " ", "->", " ", 
           RowBox[{"Inactive", "[", "Plus", "]"}]}]}]}], "\n", "  ", ",", 
        "\n", "    ", 
        RowBox[{
         RowBox[{"distributedForm", " ", "=", " ", "expandedForm"}], ";"}]}], 
       "\n", "  ", "]"}], ";", "\n", "\n", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "sub", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===",
            "0"}], ",", 
          RowBox[{"retrial", "[", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "originvarslen"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"expandedForm", "===", 
         RowBox[{"0", " ", "Or", " ", "expandedForm"}], " ", "===", " ", 
         "distributedForm"}], ",", 
        RowBox[{"retrial", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "expandedForm", ",", " ", "distributedForm", ",", " ", "short"}], 
        "}"}], " ", "~", "Join", "~", " ", "sub"}]}]}], "\[IndentingNewLine]",
     "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
   3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
   3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}, {
   3.928726261318315*^9, 3.9287263182582026`*^9}, {3.9287263830839825`*^9, 
   3.928726400282058*^9}, {3.928726641715729*^9, 3.928726709426447*^9}, {
   3.928726746765503*^9, 3.928726750674468*^9}, {3.929073795897071*^9, 
   3.929073905015635*^9}, 3.929074240838964*^9, {3.929693697532645*^9, 
   3.929693740929082*^9}, {3.930213915986288*^9, 3.930213916278241*^9}, {
   3.93021397582139*^9, 3.930213997766171*^9}, {3.9302140361301937`*^9, 
   3.9302140364558153`*^9}, {3.930215237065489*^9, 3.930215241155187*^9}, {
   3.931966593416523*^9, 3.93196664671953*^9}, {3.931966715024255*^9, 
   3.931966734279604*^9}, {3.931966781831505*^9, 3.931966819973034*^9}, {
   3.931966933379026*^9, 3.931966943593693*^9}, {3.93196736693241*^9, 
   3.931967377858004*^9}, {3.932053562069384*^9, 3.9320535622125597`*^9}, {
   3.932053592607184*^9, 3.932053623789177*^9}, {3.932053674781619*^9, 
   3.932053734496317*^9}, {3.9320537779125853`*^9, 3.932053905297308*^9}, {
   3.932053976099035*^9, 3.932053986564485*^9}, {3.932054135034429*^9, 
   3.932054137074844*^9}, {3.932592421876273*^9, 3.932592472121687*^9}, {
   3.932592509091553*^9, 3.932592553930071*^9}, {3.939224331006712*^9, 
   3.939224388954149*^9}, {3.939224425856275*^9, 3.939224526940989*^9}, {
   3.9392246122069693`*^9, 3.939224645860593*^9}, {3.9392251772779818`*^9, 
   3.93922519544275*^9}, {3.9392253504447927`*^9, 3.939225359832102*^9}, {
   3.9392254074760303`*^9, 3.939225516399852*^9}, {3.93922570662833*^9, 
   3.93922573366238*^9}, {3.939225771056757*^9, 3.939225773431176*^9}, {
   3.939225844923204*^9, 3.939225864108166*^9}, {3.939225907551654*^9, 
   3.939226076144809*^9}, {3.9397393949018517`*^9, 3.939739400610404*^9}, {
   3.939739457568646*^9, 3.939739457788534*^9}, {3.939918079143315*^9, 
   3.9399180939153147`*^9}, {3.939918133950289*^9, 3.939918144167902*^9}, {
   3.939918179098056*^9, 3.939918205011323*^9}, {3.93991823630052*^9, 
   3.93991824097467*^9}, {3.939918275454782*^9, 3.939918308212613*^9}, {
   3.9399183904363203`*^9, 3.9399184141297607`*^9}, {3.939918541044917*^9, 
   3.939918544299048*^9}, {3.939918657993156*^9, 3.93991867750915*^9}, {
   3.939918721039459*^9, 3.9399187353180523`*^9}, {3.939918923359204*^9, 
   3.93991892632683*^9}},
 CellLabel->"In[62]:=",ExpressionUUID->"12e6674e-4fbf-4ea0-b36f-e460120950af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomPolynomial$PolyNInPoly6$LSS$Distribute", "[", 
  RowBox[{"5", ",", "2", ",", "5", ",", "2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"b", "[", "0", "]"}], ",", 
     RowBox[{"b", "[", "1", "]"}], ",", 
     RowBox[{"b", "[", "2", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], ",", 
     RowBox[{"a", "[", "1", "]"}], ",", 
     RowBox[{"a", "[", "2", "]"}]}], "}"}], ",", "3", ",", "3"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.939918433683487*^9, 3.939918438090959*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"99dba830-ccaa-49f6-9e8e-e46c686b5153"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"45", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "0", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
    RowBox[{"150", " ", 
     RowBox[{"a", "[", "0", "]"}], " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
    RowBox[{"131", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "3"]}], "+", 
    RowBox[{"15", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "4"]}]}], ",", 
   RowBox[{
    RowBox[{"5", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "4"]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{"125", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{"75", " ", 
     RowBox[{"a", "[", "0", "]"}], " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{"75", " ", 
     RowBox[{"a", "[", "0", "]"}], " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{"45", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "0", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{"4", " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "3"]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{"6", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], 
    TagBox["+",
     "InactiveToken",
     BaseStyle->"Inactive",
     SyntaxForm->"+"], 
    RowBox[{"10", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "4"]}]}], ",", 
   RowBox[{
    RowBox[{"5", " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "0", "]"}], "2"]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"b", "[", "1", "]"}], " ", 
     RowBox[{"b", "[", "2", "]"}]}], "+", 
    RowBox[{"5", " ", 
     SuperscriptBox[
      RowBox[{"b", "[", "2", "]"}], "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "3"}], " ", 
     RowBox[{"a", "[", "0", "]"}], " ", 
     RowBox[{"a", "[", "2", "]"}]}], "-", 
    RowBox[{"5", " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"a", "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"a", "[", "2", "]"}]}], "+", 
    RowBox[{"5", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}]}], ",", 
   RowBox[{"-", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.939918444568703*^9, 3.939918505258023*^9}, {
  3.939918547362568*^9, 3.939918558465478*^9}, {3.939918685592443*^9, 
  3.93991869622405*^9}, {3.939918738346551*^9, 3.939918758353923*^9}, {
  3.939918882610488*^9, 3.939918905108461*^9}},
 CellLabel->
  "Out[213]=",ExpressionUUID->"7251a974-7256-4b00-9519-aa9d1522d8e3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomPolynomial$maxlength$fix", "[", 
     RowBox[{"3", ",", "4", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b", "[", "0", "]"}], ",", 
        RowBox[{"b", "[", "1", "]"}], ",", 
        RowBox[{"b", "[", "1", "]"}]}], "}"}], ",", "5"}], "]"}], ",", "3"}], 
   "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.939224529049232*^9, 3.939224586131728*^9}, {
  3.939224660421522*^9, 3.939224675516315*^9}, {3.93922489366842*^9, 
  3.939224904879764*^9}, {3.939225114391944*^9, 3.939225115255892*^9}},
 CellLabel->
  "In[334]:=",ExpressionUUID->"54b5cd35-2a97-4aaf-b5aa-1b1ec88103c0"],

Cell[BoxData[
 TagBox[
  TagBox[GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "3"}], " ", 
        SuperscriptBox[
         RowBox[{"b", "[", "0", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"b", "[", "1", "]"}], "2"]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"b", "[", "0", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"b", "[", "1", "]"}], "3"]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"b", "[", "1", "]"}], "4"]}]}]},
     {
      RowBox[{
       RowBox[{"8", " ", 
        RowBox[{"b", "[", "0", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"b", "[", "1", "]"}], "3"]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"b", "[", "1", "]"}], "4"]}]}]},
     {
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox[
        RowBox[{"b", "[", "0", "]"}], "4"]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.5599999999999999]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}],
   Column],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.939224552444655*^9, 3.939224595770077*^9}, {
   3.939224661656019*^9, 3.939224675853879*^9}, {3.939224894147278*^9, 
   3.939224918798841*^9}, {3.939225115632758*^9, 3.939225118952993*^9}, {
   3.939225535415005*^9, 3.9392255373315887`*^9}, 3.939225711170749*^9, 
   3.939225849061881*^9},
 CellLabel->
  "Out[334]//TableForm=",ExpressionUUID->"a1617ce6-ae8b-4163-b4a9-\
ad46ed08ee80"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomPolynomial$PolyNInPoly6$LSS", "[", 
     RowBox[{"5", ",", "2", ",", "5", ",", "2", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"b", "[", "0", "]"}], ",", 
        RowBox[{"b", "[", "1", "]"}], ",", 
        RowBox[{"b", "[", "2", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "[", "0", "]"}], ",", 
        RowBox[{"a", "[", "1", "]"}], ",", 
        RowBox[{"a", "[", "2", "]"}]}], "}"}], ",", "3", ",", "3"}], "]"}], 
    ",", "5"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.939225542640916*^9, 3.93922562286288*^9}, {
  3.93922574680171*^9, 3.939225750697718*^9}, {3.939225868723774*^9, 
  3.9392258770184307`*^9}, {3.939226083992259*^9, 3.93922608574986*^9}},
 CellLabel->
  "In[347]:=",ExpressionUUID->"8b966f82-b280-4089-9418-8c9a7bd15263"],

Cell[BoxData[
 TagBox[GridBox[{
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "64"}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "4"]}], "-", 
      RowBox[{"40", " ", 
       RowBox[{"a", "[", "0", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"96", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "3"], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"80", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{"30", " ", 
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"a", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
      RowBox[{"36", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "5"}], " ", 
       RowBox[{"b", "[", "0", "]"}], " ", 
       RowBox[{"b", "[", "1", "]"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"b", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox[
        RowBox[{"b", "[", "2", "]"}], "2"]}]}], 
     RowBox[{"2", " ", 
      RowBox[{"a", "[", "0", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}]}], 
     RowBox[{
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"a", "[", "2", "]"}]}]}], 
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      RowBox[{"a", "[", "0", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}]}]},
    {
     RowBox[{
      RowBox[{"8", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "3"], " ", 
       RowBox[{"a", "[", "1", "]"}]}], "-", 
      RowBox[{"17", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"4", " ", 
       RowBox[{"a", "[", "0", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "3"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "4"]}], "-", 
      RowBox[{"50", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}]}], 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox[
        RowBox[{"b", "[", "0", "]"}], "2"]}], "-", 
      RowBox[{"4", " ", 
       RowBox[{"b", "[", "0", "]"}], " ", 
       RowBox[{"b", "[", "1", "]"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"b", "[", "2", "]"}], "2"]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"a", "[", "0", "]"}]}], " ", 
       RowBox[{"a", "[", "1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"]}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"]}], 
     RowBox[{
      RowBox[{"-", "5"}], " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}]}]},
    {
     RowBox[{
      RowBox[{"60", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "3"], " ", 
       RowBox[{"a", "[", "1", "]"}]}], "+", 
      RowBox[{"125", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"75", " ", 
       RowBox[{"a", "[", "0", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "3"]}], "+", 
      RowBox[{"20", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "4"]}], "-", 
      RowBox[{"36", " ", 
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"a", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
      RowBox[{"48", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", 
       RowBox[{"b", "[", "0", "]"}], " ", 
       RowBox[{"b", "[", "1", "]"}]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox[
        RowBox[{"b", "[", "1", "]"}], "2"]}], "+", 
      RowBox[{"5", " ", 
       RowBox[{"b", "[", "1", "]"}], " ", 
       RowBox[{"b", "[", "2", "]"}]}]}], 
     RowBox[{
      RowBox[{"-", "3"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"a", "[", "1", "]"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "2"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"]}]}]},
    {
     RowBox[{
      RowBox[{
       RowBox[{"-", "54"}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
      RowBox[{"60", " ", 
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"a", "[", "1", "]"}], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
      RowBox[{"16", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", 
       SuperscriptBox[
        RowBox[{"b", "[", "0", "]"}], "2"]}], "+", 
      RowBox[{"5", " ", 
       RowBox[{"b", "[", "0", "]"}], " ", 
       RowBox[{"b", "[", "1", "]"}]}], "-", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "5"}], " ", 
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"a", "[", "2", "]"}]}]}], 
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{"a", "[", "0", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}]}], 
     RowBox[{"5", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"]}]},
    {
     RowBox[{
      RowBox[{"21", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "4"]}], "-", 
      RowBox[{"70", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
      RowBox[{"100", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "4"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "2"], " ", 
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "+", 
      RowBox[{"110", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "3"], " ", 
       RowBox[{"a", "[", "2", "]"}]}], "-", 
      RowBox[{"55", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}]}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", 
       RowBox[{"b", "[", "0", "]"}], " ", 
       RowBox[{"b", "[", "1", "]"}]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"b", "[", "0", "]"}], " ", 
       RowBox[{"b", "[", "2", "]"}]}], "-", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"]}], 
     RowBox[{
      RowBox[{"5", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "2"]}], "+", 
      RowBox[{"5", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
      RowBox[{"3", " ", 
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"a", "[", "2", "]"}]}]}], 
     RowBox[{"5", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"]}], 
     RowBox[{
      RowBox[{"3", " ", 
       SuperscriptBox[
        RowBox[{"a", "[", "0", "]"}], "2"]}], "+", 
      RowBox[{"5", " ", 
       RowBox[{"a", "[", "1", "]"}], " ", 
       RowBox[{"a", "[", "2", "]"}]}]}]}
   },
   GridBoxAlignment->{"Columns" -> {{Left}}, "Rows" -> {{Baseline}}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.939225625314983*^9, {3.9392257129684258`*^9, 3.939225766480158*^9}, {
   3.939225851852187*^9, 3.939225877634804*^9}, {3.9392260821454*^9, 
   3.939226106895028*^9}},
 CellLabel->
  "Out[347]//TableForm=",ExpressionUUID->"03381b27-9b75-4c29-9295-\
c5400db70a0a"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Clear", "[", "RandomPolynomial$PolyNInPoly7$LSS", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", "\n", 
   RowBox[{"intMax", " ", ":", " ", 
    RowBox[{
    "max", " ", "coefficient", " ", "of", " ", "original", " ", "expression", 
     "\n", "degMax"}], " ", ":", " ", 
    RowBox[{
    "degree", " ", "of", " ", "terms", " ", "in", " ", "original", " ", 
     "expression", " ", 
     RowBox[{"(", " ", 
      RowBox[{"all", " ", "has", " ", "same", " ", "degree"}], " ", ")"}], 
     "\n", 
     RowBox[{"subintMax", " ", ":", " ", 
      RowBox[{
      "max", " ", "coefficient", " ", "of", " ", "substitution", "\n", 
       "subdegMax"}], " ", ":", " ", 
      RowBox[{
      "degree", " ", "of", " ", "terms", " ", "in", " ", "substitutions", " ", 
       RowBox[{"(", " ", 
        RowBox[{"all", " ", "has", " ", "same", " ", "degree"}], " ", ")"}], 
       "\n", 
       RowBox[{"originvars", " ", ":", " ", 
        RowBox[{
        "set", " ", "of", " ", "variables", " ", "in", " ", "original", " ", 
         "expression", "\n", "subvars"}], " ", ":", " ", 
        RowBox[{
        "set", " ", "of", " ", "variables", " ", "in", " ", "substitutions", 
         "\n", 
         RowBox[{"maxlength", " ", ":", " ", 
          RowBox[{
           RowBox[{
           "max", " ", "number", " ", "of", " ", "terms", " ", "of", " ", 
            "original", " ", "expression"}], " ", "-", " ", 
           RowBox[{"not", " ", "fixed", "\n", "submaxlength"}]}], " ", ":", 
          " ", 
          RowBox[{
           RowBox[{
           "max", " ", "number", " ", "of", " ", "terms", " ", "of", " ", 
            "substitutions"}], " ", "-", " ", "fixed"}]}]}]}]}]}]}]}], "\n", 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$PolyNInPoly7$LSS", "[", 
    RowBox[{
    "intMax_Integer", ",", "degMax_Integer", ",", "subintMax_Integer", ",", 
     "subdegMax_Integer", ",", "originvars_List", ",", "subvars_List", ",", 
     "\n", "maxlength_Integer", ",", "submaxlength_Integer"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", "sub", ",", "long$expand", ",", "long", ",", "retrial", 
       ",", "originvarslen"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrial", "[", "]"}], ":=", 
       RowBox[{"RandomPolynomial$PolyNInPoly7$LSS", "[", 
        RowBox[{
        "intMax", ",", "degMax", ",", "subintMax", ",", "subdegMax", ",", 
         "originvars", ",", "subvars", ",", "maxlength", ",", 
         "submaxlength"}], "]"}]}], ";", "\[IndentingNewLine]", "\n", 
      RowBox[{"originvarslen", " ", "=", " ", 
       RowBox[{"Length", "[", "originvars", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial$maxlength$fix", "[", 
        RowBox[{"intMax", ",", "degMax", ",", "originvars", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"1", ",", "maxlength"}], "}"}], "]"}]}], "]"}]}], ";", 
      "\n", 
      RowBox[{"sub", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"RandomPolynomial$maxlength$fix", "[", 
          RowBox[{
          "subintMax", ",", "subdegMax", ",", "subvars", ",", 
           "submaxlength"}], "]"}], ",", "originvarslen"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"long$expand", "=", 
       RowBox[{
        RowBox[{"short", "/.", " ", 
         RowBox[{"Thread", "[", 
          RowBox[{"originvars", " ", "->", " ", "sub"}], "]"}]}], "//", 
        "Expand"}]}], ";", "\n", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "sub", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "===",
            "0"}], ",", 
          RowBox[{"retrial", "[", "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "originvarslen"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"retrial", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "short"}], "}"}], " ", "~", "Join", "~", 
       " ", "sub"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
   3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
   3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}, {
   3.928726261318315*^9, 3.9287263182582026`*^9}, {3.9287263830839825`*^9, 
   3.928726400282058*^9}, {3.928726641715729*^9, 3.928726709426447*^9}, {
   3.928726746765503*^9, 3.928726750674468*^9}, {3.929073795897071*^9, 
   3.929073905015635*^9}, 3.929074240838964*^9, {3.929693697532645*^9, 
   3.929693740929082*^9}, {3.930213915986288*^9, 3.930213916278241*^9}, {
   3.93021397582139*^9, 3.930213997766171*^9}, {3.9302140361301937`*^9, 
   3.9302140364558153`*^9}, {3.930215237065489*^9, 3.930215241155187*^9}, {
   3.931966593416523*^9, 3.93196664671953*^9}, {3.931966715024255*^9, 
   3.931966734279604*^9}, {3.931966781831505*^9, 3.931966819973034*^9}, {
   3.931966933379026*^9, 3.931966943593693*^9}, {3.93196736693241*^9, 
   3.931967377858004*^9}, {3.932053562069384*^9, 3.9320535622125597`*^9}, {
   3.932053592607184*^9, 3.932053623789177*^9}, {3.932053674781619*^9, 
   3.932053734496317*^9}, {3.9320537779125853`*^9, 3.932053905297308*^9}, {
   3.932053976099035*^9, 3.932053986564485*^9}, {3.932054135034429*^9, 
   3.932054137074844*^9}, {3.932592421876273*^9, 3.932592472121687*^9}, {
   3.932592509091553*^9, 3.932592553930071*^9}, {3.939224331006712*^9, 
   3.939224388954149*^9}, {3.939224425856275*^9, 3.939224526940989*^9}, {
   3.9392246122069693`*^9, 3.939224645860593*^9}, {3.9392251772779818`*^9, 
   3.93922519544275*^9}, {3.9392253504447927`*^9, 3.939225359832102*^9}, {
   3.9392254074760303`*^9, 3.939225516399852*^9}, {3.93922570662833*^9, 
   3.93922573366238*^9}, {3.939225771056757*^9, 3.939225773431176*^9}, {
   3.939225844923204*^9, 3.939225864108166*^9}, {3.939225907551654*^9, 
   3.939226076144809*^9}, {3.939739375897373*^9, 3.93973945000483*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"a361d19b-3013-48aa-ab8d-c36660f35b65"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "RandomPolynomial$PolyNInPoly8$LSS", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RandomPolynomial$PolyNInPoly8$LSS", "[", 
    RowBox[{
     RowBox[{"intMin_Integer", ":", "0"}], ",", "intMax_Integer", ",", 
     "degMax_Integer", ",", 
     RowBox[{"subintMin_Integer", ":", "0"}], ",", "subintMax_Integer", ",", 
     "subdegMax_Integer", ",", "vars_List", ",", 
     RowBox[{"selectionrule_", ":", "None"}], ",", 
     RowBox[{"threshold_", ":", "0"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "short", ",", "sub", ",", "long$expand", ",", "long", ",", "retrial"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"retrial", "[", "]"}], ":=", 
       RowBox[{"RandomPolynomial$PolyNInPoly8$LSS", "[", 
        RowBox[{
        "intMin", ",", "intMax", ",", "degMax", ",", "subintMax", ",", 
         "subdegMax", ",", "vars", ",", "selectionrule"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"short", "=", 
       RowBox[{"RandomPolynomial", "[", 
        RowBox[{"intMin", ",", "intMax", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", "degMax"}], "}"}], "]"}], ",", 
         RowBox[{"{", "s", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"sub", "=", 
       RowBox[{"RandomPolynomial", "[", 
        RowBox[{"subintMin", ",", "subintMax", ",", 
         RowBox[{"RandomInteger", "[", 
          RowBox[{"{", 
           RowBox[{"2", ",", "subdegMax"}], "}"}], "]"}], ",", "vars"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "at", " ", "least", " ", "have", " ", "degree", " ", "2", " ", 
        "substructure"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"FreeQ", "[", 
         RowBox[{"short", ",", "s"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"FreeQ", "[", 
          RowBox[{"sub", ",", 
           RowBox[{"Alternatives", "@@", "vars"}]}], "]"}], "\[LessEqual]", 
         "0"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"long$expand", ",", "long"}], "}"}], "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"short", "/.", 
           RowBox[{"s", "\[Rule]", "sub"}]}], "//", "Expand"}], ",", 
         RowBox[{"short", "/.", 
          RowBox[{"s", "\[Rule]", "sub"}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"selectionrule", "=!=", "None"}], ",", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "@", 
           RowBox[{"selectionrule", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}], ",", 
             "threshold"}], "]"}]}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"retrial", "[", "]"}], "]"}]}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"long$expand", "===", "0"}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Warning : \>\"", ",", "short", ",", " ", "\"\< s=\>\"", ",", 
          "sub"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"long$expand", ",", "short", ",", "sub"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.9280279042716417`*^9, 3.928027978175034*^9}, {
   3.928724541557744*^9, 3.928724590606025*^9}, {3.9287246361564636`*^9, 
   3.928724704632405*^9}, {3.9287251888381343`*^9, 3.92872525215256*^9}, {
   3.928726261318315*^9, 3.9287263182582026`*^9}, {3.9287263830839825`*^9, 
   3.928726400282058*^9}, {3.928726641715729*^9, 3.928726709426447*^9}, {
   3.928726746765503*^9, 3.928726750674468*^9}, {3.929073795897071*^9, 
   3.929073905015635*^9}, 3.929074240838964*^9, {3.929693697532645*^9, 
   3.929693740929082*^9}, {3.930213915986288*^9, 3.930213916278241*^9}, {
   3.93021397582139*^9, 3.930213997766171*^9}, {3.9302140361301937`*^9, 
   3.9302140364558153`*^9}, {3.930215237065489*^9, 3.930215241155187*^9}, {
   3.935693498568289*^9, 3.935693531961293*^9}, {3.937092198149279*^9, 
   3.93709222493364*^9}, {3.949244288740814*^9, 3.9492442921358557`*^9}, {
   3.949244346942337*^9, 
   3.949244383495325*^9}},ExpressionUUID->"0710ef65-f65c-477f-8796-\
2ca96ce9ccb2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Prefix notation", "Section",
 CellChangeTimes->{{3.828161936786806*^9, 3.828161941567064*^9}, {
  3.928718969127046*^9, 3.9287189778105106`*^9}, {3.9287191263683043`*^9, 
  3.928719129368809*^9}, {3.92871920353821*^9, 
  3.928719209105693*^9}},ExpressionUUID->"6ffe5af5-f713-4271-bed7-\
c8d0992678c9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ToPrefixNotation", "[", "expr_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"recurse", ",", "step1"}], "}"}], ",", "\n", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"NumericQ", "[", "expr", "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"{", "expr", "}"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"step1", "=", 
         RowBox[{
          RowBox[{"expr", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Inactive", "[", "Plus", "]"}], "->", "plus"}], ",", 
             " ", 
             RowBox[{"Plus", "\[Rule]", "plus"}], ",", 
             RowBox[{"Times", "\[Rule]", "times"}]}], "}"}]}], "//.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"plus", "[", 
              RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"plus", "[", 
              RowBox[{"a", ",", 
               RowBox[{"plus", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"times", "[", 
              RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], "\[RuleDelayed]", 
             RowBox[{"times", "[", 
              RowBox[{"a", ",", 
               RowBox[{"times", "[", 
                RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"recurse", "[", 
          RowBox[{"exp_", "/;", 
           RowBox[{"AtomQ", "[", "exp", "]"}]}], "]"}], ":=", "exp"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"recurse", "[", "exp_", "]"}], ":=", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"recurse", "/@", 
            RowBox[{"List", "@@", "exp"}]}], ",", 
           RowBox[{"Head", "[", "exp", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"recurse", "[", "step1", "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"plus", "\[Rule]", "Plus"}], ",", 
           RowBox[{"times", "\[Rule]", "Times"}]}], "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], "\n", "\n", "\n", "\n", 
  RowBox[{
   RowBox[{"ToPrefixNotation", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"stack", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"output", "=", 
        RowBox[{"{", "}"}]}], ",", "temp", ",", "step1", ",", "currentExpr", 
       ",", "head", ",", "elems"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"If", " ", "expression", " ", "is", " ", "numeric"}], ",", 
       RowBox[{"return", " ", "it", " ", "as", " ", "a", " ", "list"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "expr", "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "expr", "}"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Helper", " ", "function", " ", "to", " ", "handle", " ", "Plus", " ", 
        "and", " ", "Times", " ", "transformations"}], "*)"}], 
      RowBox[{"step1", "=", 
       RowBox[{
        RowBox[{"expr", "/.", " ", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"Inactive", "[", "Plus", "]"}], "->", "plus"}], ",", 
           RowBox[{"Plus", "->", "plus"}], ",", 
           RowBox[{"Times", "->", "times"}]}], "}"}]}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"plus", "[", 
            RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], ":>", 
           RowBox[{"plus", "[", 
            RowBox[{"a", ",", 
             RowBox[{"plus", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}], ",", 
          RowBox[{
           RowBox[{"times", "[", 
            RowBox[{"a_", ",", "b_", ",", "c__"}], "]"}], ":>", 
           RowBox[{"times", "[", 
            RowBox[{"a", ",", 
             RowBox[{"times", "[", 
              RowBox[{"b", ",", "c"}], "]"}]}], "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"step1", "=", 
       RowBox[{
        RowBox[{"step1", "/.", "\[VeryThinSpace]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "[", "i_", "]"}], "\[RuleDelayed]", 
           RowBox[{"\"\<a\>\"", "<>", 
            RowBox[{"ToString", "[", "i", "]"}]}]}], "}"}]}], "/.", 
        "\[VeryThinSpace]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"b", "[", "i_", "]"}], "\[RuleDelayed]", 
          RowBox[{"\"\<b\>\"", "<>", 
           RowBox[{"ToString", "[", "i", "]"}]}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Initialize", " ", "the", " ", "stack", " ", "with", " ", "the", " ", 
        "modified", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"stack", "=", 
       RowBox[{"{", "step1", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Process", " ", "each", " ", "element", " ", "in", " ", "the", " ", 
        "stack", " ", "iteratively"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"While", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "stack", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"currentExpr", "=", 
          RowBox[{"First", "[", "stack", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"stack", "=", 
          RowBox[{"Rest", "[", "stack", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"AtomQ", "[", "currentExpr", "]"}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"output", ",", "currentExpr"}], "]"}], ",", 
           RowBox[{
            RowBox[{"head", "=", 
             RowBox[{"Head", "[", "currentExpr", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"elems", "=", 
             RowBox[{"List", "@@", "currentExpr"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
             "Append", " ", "the", " ", "head", " ", "to", " ", "the", " ", 
              "output", " ", "and", " ", "push", " ", "elements", " ", "onto",
               " ", "the", " ", "stack"}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"output", ",", "head"}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"stack", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"elems", ",", "stack"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Return", " ", "the", " ", "output", " ", "with", " ", 
        "transformations", " ", "back", " ", "to", " ", "Plus", " ", "and", 
        " ", "Times"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"output", "/.", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"plus", "->", "Plus"}], ",", 
         RowBox[{"times", "->", "Times"}]}], "}"}]}]}]}], "]"}]}]}]], "Code",
 CellChangeTimes->{{3.910295875493305*^9, 3.910295875501287*^9}, {
  3.910295915704246*^9, 3.910295925989238*^9}, {3.910296628814814*^9, 
  3.910296629295044*^9}, {3.910297502577687*^9, 3.910297608716447*^9}, {
  3.910297779572478*^9, 3.910297782767911*^9}, {3.927934699320633*^9, 
  3.927934760050141*^9}, {3.927936099656593*^9, 3.927936352932089*^9}, {
  3.927939387667552*^9, 3.927939388179523*^9}, {3.9279397735831394`*^9, 
  3.927939785257352*^9}, {3.9287192394630947`*^9, 3.928719252902723*^9}, {
  3.929522642771617*^9, 3.929522722189658*^9}, {3.929522799624937*^9, 
  3.929522803472001*^9}, {3.935109223734436*^9, 3.935109268729876*^9}, {
  3.940005336489021*^9, 3.940005340916893*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"b01c757f-9229-42e3-8f3e-3a0bdedbeb93"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "4"}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "4"]}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "4"]}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"]}], "-", 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"]}], "-", 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"]}], "-", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "4"]}]}], "//", 
  "ToPrefixNotation"}]], "Input",
 CellChangeTimes->{{3.9279338936461115`*^9, 3.927933897209935*^9}, 
   3.927934575791666*^9},ExpressionUUID->"1493daa5-775e-4e46-a0b4-\
05691e922be2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Plus", ",", 
   RowBox[{"-", "4"}], ",", 
   RowBox[{"{", 
    RowBox[{"Plus", ",", 
     RowBox[{"{", 
      RowBox[{"Times", ",", 
       RowBox[{"-", "5"}], ",", 
       RowBox[{"{", 
        RowBox[{"Power", ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "1"}], "}"}], ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"Plus", ",", 
       RowBox[{"{", 
        RowBox[{"Times", ",", 
         RowBox[{"-", "4"}], ",", 
         RowBox[{"{", 
          RowBox[{"Power", ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1"}], "}"}], ",", "4"}], "}"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Plus", ",", 
         RowBox[{"{", 
          RowBox[{"Times", ",", 
           RowBox[{"-", "5"}], ",", 
           RowBox[{"{", 
            RowBox[{"Power", ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", "2"}], "}"}], ",", "2"}], "}"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Plus", ",", 
           RowBox[{"{", 
            RowBox[{"Times", ",", 
             RowBox[{"-", "8"}], ",", 
             RowBox[{"{", 
              RowBox[{"Times", ",", 
               RowBox[{"{", 
                RowBox[{"Power", ",", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "1"}], "}"}], ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Power", ",", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "2"}], "}"}], ",", "2"}], "}"}]}], 
              "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"Plus", ",", 
             RowBox[{"{", 
              RowBox[{"Times", ",", 
               RowBox[{"-", "4"}], ",", 
               RowBox[{"{", 
                RowBox[{"Power", ",", 
                 RowBox[{"{", 
                  RowBox[{"a", ",", "2"}], "}"}], ",", "4"}], "}"}]}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"Plus", ",", 
               RowBox[{"{", 
                RowBox[{"Times", ",", 
                 RowBox[{"-", "5"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Power", ",", 
                   RowBox[{"{", 
                    RowBox[{"a", ",", "3"}], "}"}], ",", "2"}], "}"}]}], 
                "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"Plus", ",", 
                 RowBox[{"{", 
                  RowBox[{"Times", ",", 
                   RowBox[{"-", "8"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"Power", ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "1"}], "}"}], ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Power", ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "3"}], "}"}], ",", "2"}], "}"}]}], 
                    "}"}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"Plus", ",", 
                   RowBox[{"{", 
                    RowBox[{"Times", ",", 
                    RowBox[{"-", "8"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Times", ",", 
                    RowBox[{"{", 
                    RowBox[{"Power", ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "2"}], "}"}], ",", "2"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Power", ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "3"}], "}"}], ",", "2"}], "}"}]}], 
                    "}"}]}], "}"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"Times", ",", 
                    RowBox[{"-", "4"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"Power", ",", 
                    RowBox[{"{", 
                    RowBox[{"a", ",", "3"}], "}"}], ",", "4"}], "}"}]}], 
                    "}"}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], "}"}]}], 
        "}"}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.928719257099035*^9, 
  3.9287192605898895`*^9}},ExpressionUUID->"f2066ebf-577b-4f97-a810-\
cd576f9c604f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "4"}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "4"]}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "4"]}], "-", 
   RowBox[{"5", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"]}], "-", 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"]}], "-", 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"]}], "-", 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "4"]}]}], "//", 
  "ToPrefixNotation"}]], "Input",
 CellLabel->
  "In[462]:=",ExpressionUUID->"ef5873a8-61c3-434c-96e8-1eacae7d0cbb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"Plus", ",", 
   RowBox[{"-", "4"}], ",", "Plus", ",", "Times", ",", 
   RowBox[{"-", "5"}], ",", "Power", ",", "\<\"a1\"\>", ",", "2", ",", "Plus",
    ",", "Times", ",", 
   RowBox[{"-", "4"}], ",", "Power", ",", "\<\"a1\"\>", ",", "4", ",", "Plus",
    ",", "Times", ",", 
   RowBox[{"-", "5"}], ",", "Power", ",", "\<\"a2\"\>", ",", "2", ",", "Plus",
    ",", "Times", ",", 
   RowBox[{"-", "8"}], ",", "Times", ",", "Power", ",", "\<\"a1\"\>", ",", 
   "2", ",", "Power", ",", "\<\"a2\"\>", ",", "2", ",", "Plus", ",", "Times", 
   ",", 
   RowBox[{"-", "4"}], ",", "Power", ",", "\<\"a2\"\>", ",", "4", ",", "Plus",
    ",", "Times", ",", 
   RowBox[{"-", "5"}], ",", "Power", ",", "\<\"a3\"\>", ",", "2", ",", "Plus",
    ",", "Times", ",", 
   RowBox[{"-", "8"}], ",", "Times", ",", "Power", ",", "\<\"a1\"\>", ",", 
   "2", ",", "Power", ",", "\<\"a3\"\>", ",", "2", ",", "Plus", ",", "Times", 
   ",", 
   RowBox[{"-", "8"}], ",", "Times", ",", "Power", ",", "\<\"a2\"\>", ",", 
   "2", ",", "Power", ",", "\<\"a3\"\>", ",", "2", ",", "Times", ",", 
   RowBox[{"-", "4"}], ",", "Power", ",", "\<\"a3\"\>", ",", "4"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.9400053577512493`*^9},
 CellLabel->
  "Out[462]=",ExpressionUUID->"c83bc3b0-fa87-4d53-95ee-7e8a1fdc3f75"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Complexity", "Section",
 CellChangeTimes->{{3.828161936786806*^9, 3.828161941567064*^9}, {
  3.928718969127046*^9, 3.9287189778105106`*^9}, {3.9287191263683043`*^9, 
  3.928719129368809*^9}, {3.92871920353821*^9, 3.928719209105693*^9}, {
  3.9287206720904646`*^9, 
  3.928720673842574*^9}},ExpressionUUID->"e06a793a-3944-4709-923a-\
5808c6197e2f"],

Cell[CellGroupData[{

Cell["Complexity for LSS", "Subsection",
 CellChangeTimes->{{3.9289835845946407`*^9, 
  3.928983590429328*^9}},ExpressionUUID->"fb18b420-293b-4338-b650-\
1b6ddbf742bc"],

Cell[TextData[{
 "Give\nA : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "=", 
    RowBox[{"f", "(", "a", ")"}]}], TraditionalForm]],ExpressionUUID->
  "2a0547ae-0e90-4682-ac5e-8a4a1a69e07d"],
 "\nB : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{"s", "(", "a", ")"}]}], TraditionalForm]],ExpressionUUID->
  "c7acd903-6cf4-45c0-b856-160f0e556618"],
 " \nC : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "=", 
    RowBox[{"f", "(", "s", ")"}]}], TraditionalForm]],ExpressionUUID->
  "f052f7f8-b9ad-4a71-95cb-8f08bd121a09"],
 "\ncheck if the total complexity of B and C is lower than the complexity of \
A.\n\nSubtleties:\n1, a[1] has LeafCount 2, but we really should treat it as \
1\n2, the total complexity of B and C is ",
 StyleBox["strictly",
  FontWeight->"Bold"],
 " lower than the complexity of A, so that we don\[CloseCurlyQuote]t want \
trivial substitution rule ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", "a"}], TraditionalForm]],ExpressionUUID->
  "6963681f-1a22-4270-97f0-ba827620af0d"],
 " or ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{"f", "(", "a", ")"}]}], TraditionalForm]],ExpressionUUID->
  "945d9f30-aa91-4d03-9b90-6fde61a5b6e8"]
}], "Text",
 CellChangeTimes->{{3.928721193482925*^9, 3.928721245242161*^9}, {
  3.92872150540114*^9, 3.928721563597739*^9}, {3.928721672763929*^9, 
  3.928721727231766*^9}, {3.928721921911154*^9, 3.9287220104190397`*^9}, {
  3.928722650084701*^9, 
  3.9287226667741985`*^9}},ExpressionUUID->"56665d1d-1912-45ac-ba97-\
33c149083783"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"treat", " ", 
    RowBox[{"a", "[", "n", "]"}], " ", "as", " ", "1", " ", "count"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MyLeafCount$CleanSymbol", "[", "expr_", "]"}], ":=", 
     RowBox[{"expr", "/.", 
      RowBox[{
       RowBox[{"a", "[", "n_", "]"}], "\[RuleDelayed]", 
       RowBox[{"\"\<a\>\"", "<>", 
        RowBox[{"ToString", "[", "n", "]"}]}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MyLeafCount", "[", "expr_", "]"}], ":=", 
     RowBox[{"LeafCount", "@", 
      RowBox[{"MyLeafCount$CleanSymbol", "[", "expr", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComplexityCriteria", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "expr$unsimplified_", ",", "expr$simplifed_", ",", "expr$sub_"}], 
        "}"}], ",", 
       RowBox[{"reduce$threshold_", ":", "0"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "count$simplified", ",", "count$sub", ",", "count$unsimplified"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "count$unsimplified", ",", "count$simplified", ",", "count$sub"}], 
          "}"}], "=", 
         RowBox[{"MyLeafCount", "/@", 
          RowBox[{"{", 
           RowBox[{
           "expr$unsimplified", ",", "expr$simplifed", ",", "expr$sub"}], 
           "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"count$unsimplified", ">", 
           RowBox[{
           "count$simplified", "+", "count$sub", "+", "reduce$threshold"}]}], 
          ",", "True", ",", "False"}], "]"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.928029074092108*^9, 3.928029257401134*^9}, {
   3.928029345072821*^9, 3.928029451645224*^9}, {3.9280294862110386`*^9, 
   3.928029511524963*^9}, {3.928724142310675*^9, 3.928724171398157*^9}, 
   3.930204498857871*^9, {3.93020453206562*^9, 3.930204603792348*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"ab21d539-1b8e-4814-ab31-dbf1a55073b5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.9302046087980413`*^9},ExpressionUUID->"3204fa87-ba06-4da1-9707-\
d9c5bcc61fa2"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr$simplifed", "=", 
   RowBox[{"3", "-", 
    RowBox[{"3", " ", "s"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["s", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr$sub", "=", 
   RowBox[{"16", "-", 
    RowBox[{"17", " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"20", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "3"]}], "+", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"expr$unsimplified", "=", 
  RowBox[{
   RowBox[{"expr$simplifed", "/.", 
    RowBox[{"s", "\[Rule]", "expr$sub"}]}], "//", "Expand"}]}]}], "Input",
 CellChangeTimes->{{3.928721385030814*^9, 3.9287214141297207`*^9}, 
   3.92872147813274*^9, 3.928721778891057*^9, {3.928721858120513*^9, 
   3.928721859894313*^9}},ExpressionUUID->"c8ac940d-702f-45dc-aa1b-\
0453c679252b"],

Cell[BoxData[
 RowBox[{"467", "-", 
  RowBox[{"1037", " ", 
   RowBox[{"a", "[", "1", "]"}]}], "-", 
  RowBox[{"642", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"1238", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "3"]}], "+", 
  RowBox[{"997", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"]}], "+", 
  RowBox[{"92", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "5"]}], "-", 
  RowBox[{"72", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "6"]}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "7"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "8"]}]}]], "Output",
 CellChangeTimes->{
  3.928721414425384*^9, {3.9287214796604085`*^9, 3.9287214822435045`*^9}, 
   3.928721779331694*^9},ExpressionUUID->"fb3d50c3-adba-497e-b46e-\
ef30731d7e93"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MyLeafCount", "/@", 
  RowBox[{"{", 
   RowBox[{"expr$unsimplified", ",", "expr$sub", ",", "expr$simplifed"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComplexityCriteria", "[", 
  RowBox[{"{", 
   RowBox[{"expr$unsimplified", ",", "expr$simplifed", ",", "expr$sub"}], 
   "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.9287214237844024`*^9, 3.9287214365433044`*^9}, {
  3.928721869806044*^9, 
  3.928721869989339*^9}},ExpressionUUID->"b3debe16-6ed3-416e-9e8e-\
b1b42b93a759"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.9287214375032253`*^9, 3.928721484105647*^9, 
  3.928721780720216*^9, 
  3.928721870324859*^9},ExpressionUUID->"db6907bb-7606-4f8c-b62d-\
ecc81ca6fcf3"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.9287214375032253`*^9, 3.928721484105647*^9, 
  3.928721780720216*^9, 
  3.928721870336268*^9},ExpressionUUID->"1ee2a770-d2cb-4b98-8da3-\
6bf6c9e41327"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr$simplifed", "=", 
   RowBox[{"3", "-", 
    RowBox[{"3", " ", "s"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["s", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr$sub", "=", 
   RowBox[{"16", "-", 
    RowBox[{"a", "[", "1", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"expr$unsimplified", "=", 
  RowBox[{
   RowBox[{"expr$simplifed", "/.", 
    RowBox[{"s", "\[Rule]", "expr$sub"}]}], "//", "Expand"}]}]}], "Input",
 CellChangeTimes->{{3.928721460863115*^9, 3.928721473997592*^9}, 
   3.928721784053079*^9},ExpressionUUID->"ee3a4be5-56b4-4bc0-a33e-\
974afb743037"],

Cell[BoxData[
 RowBox[{"467", "-", 
  RowBox[{"61", " ", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{{3.928721467275033*^9, 3.928721487622054*^9}, 
   3.928721784643667*^9},ExpressionUUID->"02339499-29e3-493a-97e6-\
24a895400a98"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MyLeafCount", "/@", 
  RowBox[{"{", 
   RowBox[{"expr$unsimplified", ",", "expr$sub", ",", "expr$simplifed"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComplexityCriteria", "[", 
  RowBox[{"{", 
   RowBox[{"expr$unsimplified", ",", "expr$simplifed", ",", "expr$sub"}], 
   "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.928721877609089*^9, 
  3.928721877801128*^9}},ExpressionUUID->"0ad6cfff-33bd-4fb6-8c68-\
082224c3b334"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.928721491798807*^9, 3.928721790924528*^9, 
  3.92872187816118*^9},ExpressionUUID->"a461aa7b-d0d4-47c2-9779-537a26af4506"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.928721491798807*^9, 3.928721790924528*^9, 
  3.928721878166078*^9},ExpressionUUID->"3e9eb4ed-e612-43c6-aa44-\
2331dd4d1044"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"expr$simplifed", "=", 
   RowBox[{"3", "-", 
    RowBox[{"3", " ", "s"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["s", "2"]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"expr$sub", "=", 
   RowBox[{"a", "[", "1", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"expr$unsimplified", "=", 
  RowBox[{
   RowBox[{"expr$simplifed", "/.", 
    RowBox[{"s", "\[Rule]", "expr$sub"}]}], "//", "Expand"}]}]}], "Input",
 CellChangeTimes->{{3.928721757779599*^9, 3.928721766291641*^9}, 
   3.928721803309975*^9},ExpressionUUID->"a770d7d0-9e6d-4f92-91ec-\
c88100d2b847"],

Cell[BoxData[
 RowBox[{"3", "-", 
  RowBox[{"3", " ", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.928721758946321*^9, 
  3.9287218037188954`*^9},ExpressionUUID->"70c2f718-6a64-41be-a07d-\
11bd686d5fc8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MyLeafCount", "/@", 
  RowBox[{"{", 
   RowBox[{"expr$unsimplified", ",", "expr$sub", ",", "expr$simplifed"}], 
   "}"}]}], "\[IndentingNewLine]", 
 RowBox[{"ComplexityCriteria", "[", 
  RowBox[{"{", 
   RowBox[{"expr$unsimplified", ",", "expr$simplifed", ",", "expr$sub"}], 
   "}"}], "]"}]}], "Input",
 CellChangeTimes->{{3.928721886581339*^9, 
  3.928721886764125*^9}},ExpressionUUID->"a0ea07ef-2c04-4e9d-bc73-\
3e0c1bb179dc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "10", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{3.928721808705855*^9, 
  3.928721887126145*^9},ExpressionUUID->"8e54834f-1883-43e6-b283-\
3cb1510123f5"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.928721808705855*^9, 
  3.92872188713019*^9},ExpressionUUID->"c1f33026-6dda-4965-ad96-e1a070973667"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Expression to DAG (unfinished)", "Subsection",
 CellChangeTimes->{{3.9289835845946407`*^9, 3.928983590429328*^9}, {
  3.928984508174107*^9, 3.928984518111923*^9}, {3.9289857014798794`*^9, 
  3.928985705846752*^9}},ExpressionUUID->"97bf0781-6699-4c10-93f9-\
80aed0b58dc0"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "ExprToDAG", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExprToDAG", "[", 
    RowBox[{"{", 
     RowBox[{"expr_", ",", "rule_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "subexpr$pos", ",", "subexprlist", ",", "smax", ",", "newrule", ",", 
       "replacerule"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"subexpr$pos", "=", 
       RowBox[{"ExprToDAG$FoundIdenticalSubexpr", "[", "expr", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"subexprlist", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"expr", "[", 
          RowBox[{"[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"subexpr$pos", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "subexpr$pos", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"smax", "=", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"expr", ",", "_s", ",", "Infinity"}], "]"}], "//", 
        "DeleteDuplicates"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"smax", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"smax", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}], "~", "Join", "~", 
         RowBox[{"{", "0", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"newrule", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"s", "[", 
           RowBox[{"smax", "+", "i"}], "]"}], "\[Rule]", 
          RowBox[{"subexprlist", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "subexprlist", "]"}]}], "}"}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"replacerule", "=", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"#", "\[Rule]", 
             RowBox[{"s", "[", 
              RowBox[{"smax", "+", "i"}], "]"}]}], "&"}], "/@", 
           RowBox[{"subexpr$pos", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Length", "[", "subexprlist", "]"}]}], "}"}]}], "]"}], "//",
         "Flatten"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ReplacePart", "[", 
         RowBox[{"expr", ",", "replacerule"}], "]"}], ",", 
        RowBox[{"rule", "~", "Join", "~", "newrule"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ExprToDAG", "[", "expr_", "]"}], ":=", 
    RowBox[{"ExprToDAG", "[", 
     RowBox[{"{", 
      RowBox[{"expr", ",", 
       RowBox[{"{", "}"}]}], "}"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ExprToDAG$FoundIdenticalSubexpr", "[", "expr_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"allhash", ",", "allhash$gather", ",", "subexpr"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"allhash", "=", 
       RowBox[{
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"content", "=", "#1"}], ",", 
               RowBox[{"pos", "=", "#2"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"Sow", "[", 
               RowBox[{"pos", "\[Rule]", 
                RowBox[{"Hash", "[", "content", "]"}]}], "]"}], ";", 
              "content"}]}], "]"}], "&"}], ",", "expr", ",", "All"}], "]"}], "//",
         "Reap"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allhash", "=", 
       RowBox[{"allhash", "[", 
        RowBox[{"[", 
         RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"allhash$gather", "=", 
       RowBox[{
        RowBox[{"GatherBy", "[", 
         RowBox[{"allhash", ",", "Last"}], "]"}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{"Select", "[", 
           RowBox[{"#", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", "#", "]"}], ">", "1"}], "&"}]}], "]"}], 
          "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "All", ",", "1"}], "]"}], "]"}], "&"}]}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"subexpr", "=", 
       RowBox[{"Select", "[", 
        RowBox[{"allhash$gather", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"MyLeafCount", "[", 
            RowBox[{"expr", "[", 
             RowBox[{"[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"#", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "]"}], ">", 
           "1"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"subexpr", "//", "ExprToDAG$Maximum"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.928983518732897*^9, 3.9289835534386835`*^9}, {
  3.928984674785987*^9, 3.92898481271257*^9}, {3.928984891556444*^9, 
  3.928984939335873*^9}, {3.928984974003086*^9, 3.928984998915472*^9}, {
  3.9289851034005547`*^9, 3.92898518421585*^9}, {3.928985218157954*^9, 
  3.928985247588128*^9}, {3.9292107712236753`*^9, 3.929210771595468*^9}, {
  3.929210809207867*^9, 3.929210913174339*^9}, {3.929210954138064*^9, 
  3.9292109545340953`*^9}, {3.929211005445034*^9, 3.9292110984398108`*^9}, {
  3.92921113019611*^9, 3.929211211652627*^9}, {3.9292112433747396`*^9, 
  3.929211343302073*^9}, {3.9292113809034643`*^9, 3.929211396810706*^9}, {
  3.929211459207315*^9, 3.929211546072137*^9}, {3.929211576146356*^9, 
  3.929211657776876*^9}},
 CellLabel->"In[74]:=",ExpressionUUID->"bfe03cf6-0191-49d2-a179-3d9afd2cb8d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simplified", "=", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], "-", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "3"]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.929164768998752*^9, 3.9291647740202866`*^9}, {
  3.9291648502637005`*^9, 
  3.9291648504398594`*^9}},ExpressionUUID->"5c018f5c-c519-4b59-99f7-\
f19a6da3cb83"],

Cell[BoxData[
 RowBox[{
  RowBox[{"simplified", "=", 
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "3"]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.929164859250808*^9, 
  3.929164859424705*^9}},ExpressionUUID->"f6483205-75ae-4b04-a16d-\
c235e41adad6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simplified", "//", "ExprToDAG"}]], "Input",
 CellChangeTimes->{{3.929211449502721*^9, 3.9292114496731267`*^9}, 
   3.929211505864645*^9},ExpressionUUID->"d73c72ac-e837-48e4-be30-\
d69bb93624c0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"s", "[", "1", "]"}], "-", 
    RowBox[{"s", "[", "2", "]"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"s", "[", "3", "]"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"s", "[", "3", "]"}], "3"]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"s", "[", "1", "]"}], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"]}], ",", 
     RowBox[{
      RowBox[{"s", "[", "2", "]"}], "\[Rule]", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], ",", 
     RowBox[{
      RowBox[{"s", "[", "3", "]"}], "\[Rule]", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"a", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"a", "[", "2", "]"}], "2"]}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9292115061890354`*^9, 3.929211548872914*^9, {3.9292115964198565`*^9, 
   3.929211623039824*^9}, {3.929211662802318*^9, 
   3.9292116759418154`*^9}},ExpressionUUID->"59a5310e-b1b6-4263-a9a1-\
549227bd3d3d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ReplacePart", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "2"]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"a", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "3"]}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"s", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"3", ",", "2", ",", "1"}], "}"}], "\[Rule]", 
      RowBox[{"s", "[", "1", "]"}]}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.929211630674139*^9, 
  3.9292116375918984`*^9}},ExpressionUUID->"1203c425-8556-4ae8-8d9b-\
1e15781f665f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"s", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"s", "[", "1", "]"}], "3"]}]}]], "Output",
 CellChangeTimes->{
  3.929211637941038*^9},ExpressionUUID->"6cf9cc12-4594-4c71-b1cd-\
c275be5f81e7"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Alist", ",", " ", 
    RowBox[{"Blist", " ", "are", " ", "lists", " ", "of", " ", 
     RowBox[{"positions", ".", " ", "This"}], " ", "function", " ", "check", 
     " ", "whether", " ", "all", " ", "nodes", " ", "in", " ", "Alist", " ", 
     "are", " ", "subnodes", " ", "of", " ", "certain", " ", "nodes", " ", 
     "in", " ", "Blist"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ExprToDAG$SubnodesQ", "[", 
      RowBox[{"Alist_", ",", "Blist_"}], "]"}], ":=", 
     RowBox[{"And", "@@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Alist", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"Alternatives", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"#", ",", "__"}], "]"}], "&"}], "/@", "Blist"}], 
            ")"}]}]}], "]"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "Alist", "]"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExprToDAG$Compare", "[", 
      RowBox[{"Alist_", ",", "Blist_"}], "]"}], ":=", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ExprToDAG$SubnodesQ", "[", 
        RowBox[{"Alist", ",", "Blist"}], "]"}], ",", 
       RowBox[{"-", "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ExprToDAG$SubnodesQ", "[", 
        RowBox[{"Blist", ",", "Alist"}], "]"}], ",", "1", ",", 
       "\[IndentingNewLine]", "True", ",", "0"}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Code",
 CellChangeTimes->{{3.929166015871342*^9, 3.929166055401958*^9}, {
   3.929166259663417*^9, 3.929166334673938*^9}, {3.929209534319831*^9, 
   3.929209596750346*^9}, {3.9292096503739834`*^9, 3.929209669964138*^9}, {
   3.929210289082885*^9, 3.929210303431238*^9}, 3.9292106213944125`*^9},
 CellLabel->"In[78]:=",ExpressionUUID->"c4ed4f01-df02-4d21-9548-6ee50cea53d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ExprToDAG$Maximum", "[", "list_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"todelete", "=", 
       RowBox[{"{", "}"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ExprToDAG$SubnodesQ", "[", 
           RowBox[{
            RowBox[{"list", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"list", "[", 
             RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"todelete", ",", "i"}], " ", "]"}]}], " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"todelete", "=", 
       RowBox[{"DeleteDuplicates", "[", "todelete", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Delete", "[", 
       RowBox[{"list", ",", 
        RowBox[{"List", "/@", "todelete"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.9292092979817266`*^9, 3.929209327231529*^9}, {
   3.9292093600362663`*^9, 3.929209360863517*^9}, {3.929209453400733*^9, 
   3.929209453791646*^9}, 3.929209679669114*^9, {3.929209772057731*^9, 
   3.929209921288659*^9}, {3.929209984132629*^9, 3.929209994752705*^9}, {
   3.929210033059575*^9, 3.929210254673885*^9}, {3.9292103387296104`*^9, 
   3.9292103390889564`*^9}, {3.9292104438789425`*^9, 3.929210581623595*^9}, {
   3.929210630628625*^9, 3.929210645214489*^9}, {3.9292106803916693`*^9, 
   3.9292106845209265`*^9}, {3.929210722430229*^9, 3.929210724465079*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"add395aa-eddf-4903-831a-86e0d3e75cd0"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplification with hint", "Section",
 CellChangeTimes->{{3.828161936786806*^9, 3.828161941567064*^9}, {
  3.928718969127046*^9, 3.9287189778105106`*^9}, {3.9287191263683043`*^9, 
  3.928719129368809*^9}, {3.92871920353821*^9, 3.928719209105693*^9}, {
  3.9287206720904646`*^9, 3.928720673842574*^9}, {3.928722091477496*^9, 
  3.9287220986111*^9}},ExpressionUUID->"535884c1-6f13-4052-b8d4-c10cca0a0bb0"],

Cell[TextData[{
 "Given\nunsimplified expression A : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "=", 
    RowBox[{"f", "(", "a", ")"}]}], TraditionalForm]],ExpressionUUID->
  "de0f54fa-3db3-4f89-9a69-4ea2c5910fa3"],
 "\nhint B : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{"s", "(", "a", ")"}]}], TraditionalForm]],ExpressionUUID->
  "24735f31-5711-47d0-b97d-67b671efd6e4"],
 " \nWe would like to check if we can simplify it to C : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "=", 
    RowBox[{"f", "(", 
     RowBox[{"s", "(", "a", ")"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "1f3bd9b4-9898-4ad4-9fba-96a3b4377278"]
}], "Text",
 CellChangeTimes->{{3.9287223325966406`*^9, 
  3.928722407196145*^9}},ExpressionUUID->"025a88af-0feb-4d8e-abae-\
387dd91657ff"],

Cell[CellGroupData[{

Cell["Polynomial Decomposition", "Subsection",
 CellChangeTimes->{{3.910295424248437*^9, 3.910295432764516*^9}, {
  3.9287191516032867`*^9, 3.928719157336816*^9}, {3.9287196631212034`*^9, 
  3.928719672917498*^9}, {3.928720445587044*^9, 
  3.928720473553329*^9}},ExpressionUUID->"3c791ca7-85d0-43ec-9580-\
facf2b61bd4b"],

Cell[TextData[{
 "Give polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "=", 
    RowBox[{"f", "(", "a", ")"}]}], TraditionalForm]],ExpressionUUID->
  "6bb46336-2a33-4b3a-abe9-f20bfa89d005"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{"s", "(", "a", ")"}]}], TraditionalForm]],ExpressionUUID->
  "65fe4df5-9640-4143-bc0c-fa51e5ccc3f6"],
 " ,  we want to know if ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "b02cb7bc-7c7a-46aa-ad39-5ff065a4fe3f"],
 " could be written as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "=", 
    RowBox[{"f", "(", 
     RowBox[{"s", "(", "a", ")"}], ")"}]}], TraditionalForm]],ExpressionUUID->
  "395fc519-dab9-42eb-99a5-33f4b185221c"]
}], "Text",
 InitializationCell->True,
 CellChangeTimes->{{3.928719681479009*^9, 
  3.928719750921026*^9}},ExpressionUUID->"41e0e93d-9f0f-4434-9580-\
91dc8770380b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PolynomialDecomposite", "[", 
    RowBox[{"raw_", ",", "sub_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"coeff", ",", "result", ",", "reminder"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Clear", "[", 
       RowBox[{"s", ",", "p"}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", "p"}], ";", "\[IndentingNewLine]", 
      RowBox[{"coeff", "=", "raw"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{"True", ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"coeff", "\[Equal]", "0"}], ",", 
           RowBox[{"Break", "[", "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "coeff", "}"}], ",", "reminder"}], "}"}], "=", 
          RowBox[{"PolynomialReduce", "[", 
           RowBox[{"coeff", ",", "sub"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"result", "/.", 
           RowBox[{"p", "\[Rule]", 
            RowBox[{
             RowBox[{"p", " ", "s"}], "+", "reminder"}]}]}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"result", "=", 
       RowBox[{"result", "/.", 
        RowBox[{"p", "\[Rule]", "0"}]}]}], ";", "\[IndentingNewLine]", 
      "result"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.928006937372116*^9, 3.928006999310638*^9}, {
  3.9280070294827423`*^9, 3.928007068772455*^9}, {3.92800721009434*^9, 
  3.9280072111522875`*^9}, {3.9287199193024817`*^9, 3.92871997257592*^9}, {
  3.9287201592718887`*^9, 3.928720167192183*^9}, {3.9287202433305492`*^9, 
  3.928720261072814*^9}, {3.928720485826391*^9, 3.928720488187035*^9}},
 CellLabel->"In[81]:=",ExpressionUUID->"13920dfb-3342-468d-b0d5-cc7f0c63938e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"original", "=", 
   RowBox[{"3", "+", 
    RowBox[{"s", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "3"}], "+", 
       RowBox[{"2", " ", "s"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sub", "=", 
   RowBox[{"16", "-", 
    RowBox[{"17", " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"20", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "1", "]"}], "3"]}], "+", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"raw", "=", 
  RowBox[{
   RowBox[{"original", "/.", 
    RowBox[{"s", "\[Rule]", "sub"}]}], "//", "Expand"}]}]}], "Input",
 CellChangeTimes->{
  3.9280072885737476`*^9, {3.9287198186832314`*^9, 
   3.9287198535631804`*^9}},ExpressionUUID->"797f501c-b548-490f-9fe1-\
a81ee07074e8"],

Cell[BoxData[
 RowBox[{"467", "-", 
  RowBox[{"1037", " ", 
   RowBox[{"a", "[", "1", "]"}]}], "-", 
  RowBox[{"642", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"1238", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "3"]}], "+", 
  RowBox[{"997", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"]}], "+", 
  RowBox[{"92", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "5"]}], "-", 
  RowBox[{"72", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "6"]}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "7"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "8"]}]}]], "Output",
 CellChangeTimes->{3.928719853891198*^9, 3.928720250177943*^9, 
  3.928720542054497*^9},ExpressionUUID->"55817788-7aae-45ba-bd8e-\
f1fb6477774a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolynomialDecomposite", "[", 
  RowBox[{"raw", ",", "sub"}], "]"}]], "Input",
 CellChangeTimes->{{3.928719791827675*^9, 3.9287197955947886`*^9}, 
   3.928720495393896*^9},ExpressionUUID->"46d69b6a-fc9b-4b27-b18d-\
0cb1d1b63567"],

Cell[BoxData[
 RowBox[{"3", "+", 
  RowBox[{"s", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "3"}], "+", 
     RowBox[{"2", " ", "s"}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.928719796358063*^9, 3.928719857754635*^9, {3.928720252629585*^9, 
   3.928720264931742*^9}, 3.928720495703803*^9, 
   3.928720544796348*^9},ExpressionUUID->"dceaa6bd-1dfd-4c65-9dfa-\
df72f628e60e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "if", " ", "the", " ", "substitution", " ", "rule", " ", "is", " ", 
     "wrong"}], ",", " ", 
    RowBox[{
    "the", " ", "result", " ", "will", " ", "contain", " ", "symbols", " ", 
     "other", " ", "than", " ", "s"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"PolynomialDecomposite", "[", 
   RowBox[{"raw", ",", 
    RowBox[{"16", "-", 
     RowBox[{"17", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{"20", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.928720537196082*^9, 3.928720558554007*^9}, {
  3.928720611564978*^9, 
  3.9287206578755856`*^9}},ExpressionUUID->"e53af68c-b083-4ad6-a783-\
c9adb6199f8b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "9131133"}], "+", 
  RowBox[{"2815420", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"615200", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "-", 
  RowBox[{"512000", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"]}], "+", 
  RowBox[{"160000", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "8"]}], "+", 
  RowBox[{"281542", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"123040", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "-", 
  RowBox[{"153600", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"64000", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"6152", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"]}], "-", 
  RowBox[{"15360", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"]}], "+", 
  RowBox[{"9600", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"]}], "-", 
  RowBox[{"512", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "9"]}], "+", 
  RowBox[{"640", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "9"]}], "+", 
  RowBox[{"16", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "12"]}], "-", 
  RowBox[{"140771", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"61520", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"76800", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"32000", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"6152", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"15360", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"9600", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"768", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"960", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"32", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "9"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"1538", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "-", 
  RowBox[{"3840", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"2400", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "-", 
  RowBox[{"384", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"480", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"64", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "12"]}], "-", 
  RowBox[{"80", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "12"]}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "12"]}], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "4", "]"}], "16"], "-", 
  RowBox[{
   FractionBox["4913", "2"], " ", "s", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "234"}], "+", 
     RowBox[{"17", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "+", 
     RowBox[{"80", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"]}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}]}], ")"}]}], "+", 
  RowBox[{
   FractionBox["289", "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{"77723", "-", 
     RowBox[{"34880", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"4800", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "4"]}], "-", 
     RowBox[{"3488", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"960", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"48", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "6"]}], "+", 
     RowBox[{"1744", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
     RowBox[{"480", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
     RowBox[{"48", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "8"]}]}], ")"}]}], "+", 
  RowBox[{"34", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{"298840", "-", 
     RowBox[{"67500", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
     RowBox[{"38400", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
     RowBox[{"16000", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "6"]}], "-", 
     RowBox[{"6750", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"]}], "-", 
     RowBox[{"7680", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"4800", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"]}], "-", 
     RowBox[{"384", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "6"]}], "+", 
     RowBox[{"480", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "6"]}], "+", 
     RowBox[{"16", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "9"]}], "+", 
     RowBox[{"3375", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
     RowBox[{"3840", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
     RowBox[{"2400", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
     RowBox[{"384", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
     RowBox[{"480", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
     RowBox[{"24", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "6"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
     RowBox[{"96", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
     RowBox[{"120", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
     RowBox[{"12", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "8"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "4", "]"}], "12"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.928720546482272*^9, 3.928720559158978*^9}, {
  3.928720633362708*^9, 
  3.928720659010339*^9}},ExpressionUUID->"0cbdfd3b-7977-4f6c-968d-\
ac6a9292f234"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"original", "=", 
   RowBox[{"3", "-", 
    RowBox[{"3", " ", "s"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["s", "2"]}], "+", 
    SuperscriptBox["s", "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sub", "=", 
   RowBox[{"16", "-", 
    RowBox[{"17", " ", 
     RowBox[{"a", "[", "1", "]"}]}], "-", 
    RowBox[{"20", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
    SuperscriptBox[
     RowBox[{"a", "[", "4", "]"}], "4"]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"raw", "=", 
  RowBox[{
   RowBox[{"original", "/.", 
    RowBox[{"s", "\[Rule]", "sub"}]}], "//", "Expand"}]}]}], "Input",
 CellChangeTimes->{{3.928719871878503*^9, 3.928719876075042*^9}, {
   3.9287199883397818`*^9, 3.928719990606733*^9}, 
   3.928720292566135*^9},ExpressionUUID->"ad392133-ba06-4b9b-8969-\
9bd22beb913b"],

Cell[BoxData[
 RowBox[{"66003", "-", 
  RowBox[{"279565", " ", 
   RowBox[{"a", "[", "1", "]"}]}], "+", 
  RowBox[{"444482", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"]}], "-", 
  RowBox[{"314432", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "3"]}], "+", 
  RowBox[{"83521", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"]}], "-", 
  RowBox[{"328900", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"1045840", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
  RowBox[{"1109760", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"393040", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"615200", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "-", 
  RowBox[{"1305600", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
  RowBox[{"693600", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "-", 
  RowBox[{"512000", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"]}], "+", 
  RowBox[{"544000", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"]}], "+", 
  RowBox[{"160000", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "8"]}], "-", 
  RowBox[{"32890", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"104584", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "-", 
  RowBox[{"110976", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"39304", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"123040", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "-", 
  RowBox[{"261120", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"138720", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "-", 
  RowBox[{"153600", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"163200", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"64000", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"]}], "+", 
  RowBox[{"6152", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"]}], "-", 
  RowBox[{"13056", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"]}], "+", 
  RowBox[{"6936", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"]}], "-", 
  RowBox[{"15360", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"]}], "+", 
  RowBox[{"16320", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"]}], "+", 
  RowBox[{"9600", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"]}], "-", 
  RowBox[{"512", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "9"]}], "+", 
  RowBox[{"544", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "9"]}], "+", 
  RowBox[{"640", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "9"]}], "+", 
  RowBox[{"16", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "12"]}], "+", 
  RowBox[{"16445", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"52292", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"55488", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"19652", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"61520", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"130560", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"69360", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"76800", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"81600", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"32000", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"6152", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"13056", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"6936", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"15360", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"16320", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"9600", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"768", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"816", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"960", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "-", 
  RowBox[{"32", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "9"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"1538", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "-", 
  RowBox[{"3264", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"1734", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "-", 
  RowBox[{"3840", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"4080", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"2400", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "-", 
  RowBox[{"384", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"408", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"480", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"24", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "6"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"64", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "12"]}], "-", 
  RowBox[{"68", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "12"]}], "-", 
  RowBox[{"80", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "12"]}], "-", 
  RowBox[{"8", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "12"]}], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "4", "]"}], "16"]}]], "Output",
 CellChangeTimes->{{3.928719876792342*^9, 3.928719889081574*^9}, 
   3.9287199912479076`*^9, 3.928720177432127*^9, {3.9287202668237276`*^9, 
   3.928720293806587*^9}, 
   3.928720571834045*^9},ExpressionUUID->"0125c4cb-75ac-4076-a907-\
12a43fdf3ed1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PolynomialDecomposite", "[", 
   RowBox[{"raw", ",", "sub"}], "]"}], "//", "Expand"}]], "Input",
 CellChangeTimes->{{3.928720283305586*^9, 3.928720284192621*^9}, 
   3.9287204992365866`*^9},ExpressionUUID->"d4df5f8b-88b0-4fc1-a2a9-\
8e8ca3ff26e3"],

Cell[BoxData[
 RowBox[{"3", "-", 
  RowBox[{"3", " ", "s"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["s", "2"]}], "+", 
  SuperscriptBox["s", "4"]}]], "Output",
 CellChangeTimes->{
  3.928719885849391*^9, {3.928719930182348*^9, 3.928719943132407*^9}, {
   3.928719975980415*^9, 3.928719994224519*^9}, {3.928720280742695*^9, 
   3.928720284535872*^9}, 3.92872049964976*^9, 
   3.928720577335881*^9},ExpressionUUID->"d9494b22-6336-4950-b758-\
652d2bd994bd"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"PolynomialDecomposite", "[", 
   RowBox[{"raw", ",", 
    RowBox[{"16", "-", 
     RowBox[{"17", " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{"20", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"]}]}]}], "]"}], "//", 
  "Expand"}]], "Input",
 CellChangeTimes->{{3.9287205860692186`*^9, 
  3.928720588836676*^9}},ExpressionUUID->"0d3e8ab8-2603-49c3-b452-\
5c5d46df92ce"],

Cell[BoxData[
 RowBox[{"3", "-", 
  RowBox[{"3", " ", "s"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["s", "2"]}], "+", 
  SuperscriptBox["s", "4"], "-", 
  RowBox[{"3", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"4", " ", "s", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["s", "3"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "4"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox["s", "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "8"]}], "+", 
  RowBox[{"4", " ", "s", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "4", "]"}], "12"]}], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "4", "]"}], "16"]}]], "Output",
 CellChangeTimes->{
  3.9287205892153406`*^9},ExpressionUUID->"e5af0aa3-31a7-4244-975c-\
8e3648d2b497"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["polynomial simplification with hint", "Subsection",
 CellChangeTimes->{{3.928722210297364*^9, 
  3.928722219247059*^9}},ExpressionUUID->"8ca52342-10b7-406a-b387-\
3612dafc1d04"],

Cell[TextData[{
 "PolySimplifyWithHint$Special[{long, sub}] : long, short are polynomials of \
the forms:\nlong : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     RowBox[{"..", 
      SubscriptBox["a", "n"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "f032c843-8bd3-4a37-a259-ed6712e29bb5"],
 "\nsub : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "(", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     RowBox[{"...", 
      SubscriptBox["a", "n"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "48e76b0b-9842-4c3e-8aef-086f0ed44015"],
 "\nThis function check if we can write ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     RowBox[{"..", 
      SubscriptBox["a", "n"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "997f921a-c818-4318-befd-7b260c613e47"],
 " as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"s", "(", 
     RowBox[{
      SubscriptBox["a", "1"], ",", 
      RowBox[{"...", 
       SubscriptBox["a", "n"]}]}], ")"}], ")"}], TraditionalForm]],
  ExpressionUUID->"ccd4bd61-8f88-476f-9c26-e22a0345c3f5"],
 ", if so, return ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", "s", ")"}], TraditionalForm]],ExpressionUUID->
  "667b22de-2ed5-414e-a8fd-6e05a525dd71"],
 ", otherwise return False."
}], "Text",
 CellChangeTimes->{{3.9287224869680166`*^9, 3.928722500717464*^9}, {
  3.928906863945907*^9, 
  3.928906994051087*^9}},ExpressionUUID->"30e534ed-ee84-427e-a2be-\
9b5b6a68328f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "PolySimplifyWithHint$Special", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolySimplifyWithHint$Special", "[", 
    RowBox[{"{", 
     RowBox[{"expr$unsimplified_", ",", "expr$sub_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "expr$simplifed", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"expr$simplifed", "=", 
       RowBox[{
        RowBox[{"PolynomialDecomposite", "[", 
         RowBox[{"expr$unsimplified", ",", "expr$sub"}], "]"}], "//", 
        "Expand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"Not", "@", 
         RowBox[{"FreeQ", "[", 
          RowBox[{"expr$simplifed", ",", "_a"}], "]"}]}], ",", "False", ",", 
        "expr$simplifed"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolySimplifyWithHint$Special", "[", 
    RowBox[{"{", 
     RowBox[{"expr$unsimplified_", ",", "False"}], "}"}], "]"}], ":=", 
   "False"}], ";"}]}], "Code",
 CellChangeTimes->{{3.928003051362795*^9, 3.9280030885192566`*^9}, {
   3.928003121241497*^9, 3.928003133875234*^9}, {3.928005636825043*^9, 
   3.9280056386420417`*^9}, {3.928007242242837*^9, 3.928007245515761*^9}, {
   3.928007308158248*^9, 3.928007379787055*^9}, {3.928007509614515*^9, 
   3.928007536173725*^9}, 3.928007643392909*^9, {3.928020978995415*^9, 
   3.928020989673977*^9}, {3.928722411709793*^9, 3.9287224303645678`*^9}, 
   3.9287225090054293`*^9, {3.928722583668747*^9, 3.928722584566838*^9}, {
   3.928906551809741*^9, 3.9289066035860147`*^9}, {3.928906669778541*^9, 
   3.928906720589602*^9}, {3.928906761331659*^9, 3.928906778593107*^9}, {
   3.928906816581648*^9, 3.928906848794687*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"c62697b3-912e-423e-bf0f-db88c36f2f1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"long", ",", "short", ",", "sub"}], "}"}], "=", 
   RowBox[{"RandomPolynomial$ON$LSS", "[", 
    RowBox[{"5", ",", "3", ",", "2", ",", "3"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.928906530510956*^9, 
  3.9289065354198527`*^9}},ExpressionUUID->"f9e3c803-67dc-45cc-9ca1-\
78f975d4e0e4"],

Cell[CellGroupData[{

Cell[BoxData[{"long", "\[IndentingNewLine]", "short", "\[IndentingNewLine]", \
"sub"}], "Input",
 CellChangeTimes->{{3.928907194973213*^9, 
  3.9289072045477605`*^9}},ExpressionUUID->"35a170d5-6122-4c56-a467-\
7cc8a59d4c77"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "2"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "6"]}], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"], "-", 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
  RowBox[{"6", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"]}]}]], "Output",
 CellChangeTimes->{
  3.92890662299249*^9, 3.928906855578337*^9, {3.9289071990118628`*^9, 
   3.92890720497031*^9}, 
   3.928985938432293*^9},ExpressionUUID->"dc08a5bb-900d-4bad-8754-\
b2c81044fd9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", "s", "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["s", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["s", "3"]}]}]], "Output",
 CellChangeTimes->{
  3.92890662299249*^9, 3.928906855578337*^9, {3.9289071990118628`*^9, 
   3.92890720497031*^9}, 
   3.928985938447428*^9},ExpressionUUID->"ba501a0a-509c-4e0f-86f2-\
a348d78f50e6"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.92890662299249*^9, 3.928906855578337*^9, {3.9289071990118628`*^9, 
   3.92890720497031*^9}, 
   3.928985938447428*^9},ExpressionUUID->"4aef17b9-7879-4917-95ad-\
ac195a4628ae"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolySimplifyWithHint$Special", "[", 
  RowBox[{"{", 
   RowBox[{"long", ",", "sub"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.92890674018168*^9, 3.928906744599353*^9}, {
  3.928907177598499*^9, 
  3.928907180409904*^9}},ExpressionUUID->"448cdae0-48ec-4c24-8b20-\
09411f5d8b4c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], "+", 
  RowBox[{"3", " ", "s"}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["s", "2"]}]}]], "Output",
 CellChangeTimes->{3.928906745171714*^9, 3.928906785578602*^9, 
  3.928906857112666*^9, 
  3.928907180775626*^9},ExpressionUUID->"3d2a9a78-1555-440b-9cf0-\
55a6a9663fb1"]
}, Open  ]],

Cell[TextData[{
 "PolySimplifyWithHint[{long, sub}] : long, short are polynomials of the \
forms:\nlong : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     RowBox[{"..", 
      SubscriptBox["a", "n"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "ce11d52a-0ed9-4382-97c0-c8926d80dbde"],
 "\nsub : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "(", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     RowBox[{"...", 
      SubscriptBox["a", "n"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "b0be9766-abbb-4c22-8963-c498016c52a5"],
 "\nThis function check if we can write ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     RowBox[{"..", 
      SubscriptBox["a", "n"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "f3561925-3ebe-4cf8-958a-cbbb4ff7a0e4"],
 " as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"s", "(", 
     RowBox[{
      SubscriptBox["a", "1"], ",", 
      RowBox[{"...", 
       SubscriptBox["a", "n"]}]}], ")"}], ")"}], TraditionalForm]],
  ExpressionUUID->"55c2d1a8-4259-4f9b-a074-befd2437214c"],
 ", if yes, check if the complexity is reduced, if so return ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", "s", ")"}], TraditionalForm]],ExpressionUUID->
  "66eda381-c15f-4224-8674-40b11765dadf"],
 ", otherwise return False."
}], "Text",
 CellChangeTimes->{{3.9287224869680166`*^9, 3.928722500717464*^9}, {
  3.928906863945907*^9, 
  3.928907048148567*^9}},ExpressionUUID->"4d89010c-218d-4491-8388-\
b54906f1222f"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "PolySimplifyWithHint", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolySimplifyWithHint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"expr$unsimplified_", ",", "expr$sub_"}], "}"}], ",", 
     RowBox[{"complexityCriteriaQ_", ":", "True"}], ",", 
     RowBox[{"eliminateQ_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "expr$simplifed", "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"NumericQ", "[", "expr$unsimplified", "]"}], ",", 
        RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"expr$simplifed", "=", 
       RowBox[{
        RowBox[{"PolynomialDecomposite", "[", 
         RowBox[{"expr$unsimplified", ",", "expr$sub"}], "]"}], "//", 
        "Expand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"eliminateQ", " ", "&&", " ", 
         RowBox[{"Not", "@", 
          RowBox[{"FreeQ", "[", 
           RowBox[{"expr$simplifed", ",", "_a"}], "]"}]}]}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"complexityCriteriaQ", " ", "&&", " ", 
         RowBox[{"Not", "@", 
          RowBox[{"ComplexityCriteria", "[", 
           RowBox[{"{", 
            RowBox[{
            "expr$unsimplified", ",", "expr$simplifed", ",", "expr$sub"}], 
            "}"}], "]"}]}]}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "expr$simplifed", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolySimplifyWithHint", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"expr$unsimplified_", ",", "False"}], "}"}], ",", "___"}], 
    "]"}], ":=", "False"}], ";"}]}], "Code",
 CellChangeTimes->{{3.928907062161486*^9, 3.928907129704965*^9}, {
   3.9295052089509215`*^9, 3.929505272634899*^9}, {3.929508062846659*^9, 
   3.929508064283856*^9}, 3.936202226641784*^9, {3.936202296655667*^9, 
   3.93620232102657*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"39635004-f4cd-4474-aaf1-a90dcb0b0302"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"long", ",", "short", ",", "sub"}], "}"}], "=", 
   RowBox[{"RandomPolynomial$ON$LSS", "[", 
    RowBox[{"5", ",", "3", ",", "2", ",", "3"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.928906530510956*^9, 3.9289065354198527`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"7fb526f3-f7c1-4468-9db7-21f87e412da8"],

Cell[CellGroupData[{

Cell[BoxData[{"long", "\[IndentingNewLine]", "short", "\[IndentingNewLine]", \
"sub"}], "Input",
 CellChangeTimes->{{3.928907194973213*^9, 3.9289072045477605`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"987fc0e7-2946-4d00-bdf5-df965a18d1a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  RowBox[{"5", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"]}], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "6"], "-", 
  RowBox[{"5", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"8", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "6"]}]], "Output",
 CellChangeTimes->{
  3.92890662299249*^9, 3.928906855578337*^9, {3.9289071990118628`*^9, 
   3.928907223176617*^9}, 3.928983273709454*^9, 3.928985955141115*^9, 
   3.9302016099670553`*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"9a515ffa-8abf-4979-ae04-3a9d7e96897e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  RowBox[{"5", " ", "s"}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["s", "2"]}], "+", 
  SuperscriptBox["s", "3"]}]], "Output",
 CellChangeTimes->{
  3.92890662299249*^9, 3.928906855578337*^9, {3.9289071990118628`*^9, 
   3.928907223176617*^9}, 3.928983273709454*^9, 3.928985955141115*^9, 
   3.930201609969808*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"4d3a759a-da93-4cf3-aa4e-128458fd743b"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.92890662299249*^9, 3.928906855578337*^9, {3.9289071990118628`*^9, 
   3.928907223176617*^9}, 3.928983273709454*^9, 3.928985955141115*^9, 
   3.93020160997227*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"3c5508b6-bb4d-45f6-8cd7-b163298bd8b2"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolySimplifyWithHint", "[", 
  RowBox[{"{", 
   RowBox[{"long", ",", "sub"}], "}"}], "]"}]], "Input",ExpressionUUID->\
"c4dd5789-1a2b-4c33-bf37-090f21a4dbda"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", "s", "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["s", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["s", "3"]}]}]], "Output",
 CellChangeTimes->{3.928907183740788*^9, 3.92890722533144*^9, 
  3.928983276434865*^9, 
  3.9289859467528086`*^9},ExpressionUUID->"fce0e66b-4f0b-45e2-9f48-\
e733758d1311"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simplified", "=", 
  RowBox[{
   RowBox[{"PolySimplifyWithHint", "[", 
    RowBox[{"{", 
     RowBox[{"long", ",", "sub"}], "}"}], "]"}], "/.", 
   RowBox[{"s", "\[Rule]", "sub"}]}]}]], "Input",
 CellChangeTimes->{{3.928986149242405*^9, 
  3.928986161217343*^9}},ExpressionUUID->"3b56c4cd-2294-452a-b1a2-\
369bae84ecc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "2"], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "3"]}]}]], "Output",
 CellChangeTimes->{
  3.928986162876316*^9},ExpressionUUID->"4cf3a52c-5b15-49ca-9f24-\
43cf4e4bea24"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simplified", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.92898595884842*^9, 3.928985976542493*^9}, 
   3.92898616733232*^9},ExpressionUUID->"323daaa0-ab6a-48d3-8814-\
dfb29f50829c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "2"], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "3"]}]}]], "Output",
 CellChangeTimes->{{3.92898596116868*^9, 3.9289859773632174`*^9}, 
   3.928986028791195*^9, 
   3.92898616777363*^9},ExpressionUUID->"073b0653-0803-4bbc-994b-\
348c81467ffe"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"simplified", "//", "Expand"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.928985987858872*^9, 3.928985988844455*^9}, 
   3.92898616978089*^9},ExpressionUUID->"688b3551-5832-4486-a10c-\
acf3d0303e9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "6"]}], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "4"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.92898598933115*^9, 3.92898602964654*^9, 
  3.9289861702184734`*^9},ExpressionUUID->"1dccabe1-4eb7-421f-ae9e-\
735fb396c9d2"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["polynomial simplification check hint, short suggestion", "Subsection",
 CellChangeTimes->{{3.928722210297364*^9, 3.928722219247059*^9}, {
  3.932043119419183*^9, 
  3.93204312616103*^9}},ExpressionUUID->"a3a22404-15e3-4ca7-9fa2-\
dad11e872770"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolySimplifyWithHint$Special", "[", 
  RowBox[{"{", 
   RowBox[{"long", ",", "sub"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.92890674018168*^9, 3.928906744599353*^9}, {
  3.928907177598499*^9, 
  3.928907180409904*^9}},ExpressionUUID->"412711d3-bf8a-4b77-88e7-\
109c232ac375"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], "+", 
  RowBox[{"3", " ", "s"}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox["s", "2"]}]}]], "Output",
 CellChangeTimes->{3.928906745171714*^9, 3.928906785578602*^9, 
  3.928906857112666*^9, 
  3.928907180775626*^9},ExpressionUUID->"ffd19277-01a1-42ca-85be-\
de513c7a3a49"]
}, Open  ]],

Cell[TextData[{
 "PolySimplifyWithHint[{long, sub}] : long, short are polynomials of the \
forms:\nlong : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     RowBox[{"..", 
      SubscriptBox["a", "n"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "4ffd79c5-8f2b-41db-890c-d2aa1612817c"],
 "\nsub : ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "(", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     RowBox[{"...", 
      SubscriptBox["a", "n"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "5ee54fce-47f8-495f-a092-59bba5cae887"],
 "\nThis function check if we can write ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     SubscriptBox["a", "1"], ",", 
     RowBox[{"..", 
      SubscriptBox["a", "n"]}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "4fd4f4eb-746b-4bd8-8a73-fe28928f0d2e"],
 " as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{"s", "(", 
     RowBox[{
      SubscriptBox["a", "1"], ",", 
      RowBox[{"...", 
       SubscriptBox["a", "n"]}]}], ")"}], ")"}], TraditionalForm]],
  ExpressionUUID->"5ba82c60-b2a6-4607-8498-50337a06fd4d"],
 ", if yes, check if the complexity is reduced, if so return ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", "s", ")"}], TraditionalForm]],ExpressionUUID->
  "5844cea0-46da-40de-a370-67ed2e78316c"],
 ", otherwise return False."
}], "Text",
 CellChangeTimes->{{3.9287224869680166`*^9, 3.928722500717464*^9}, {
  3.928906863945907*^9, 
  3.928907048148567*^9}},ExpressionUUID->"0c18cdf0-7842-4afb-b670-\
c4c4f2ec4a00"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "PolySimplifyCheckSubShort", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolySimplifyCheckSubShort", "[", 
    RowBox[{"{", 
     RowBox[{"expr$unsimplified_", ",", "expr$sub$short_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"expr$simplified", ",", "expr$sub", ",", "expr$short"}], "}"}], 
     ",", "\n", 
     RowBox[{
      RowBox[{"expr$sub", "=", 
       RowBox[{
       "expr$sub$short", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}]}], ";", "\n", 
      RowBox[{"expr$short", "=", 
       RowBox[{
       "expr$sub$short", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"expr$simplified", "=", 
       RowBox[{
        RowBox[{"expr$short", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"b", "[", "0", "]"}], "->", "expr$sub"}], "}"}]}], "//", 
        "Expand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"expr$unsimplified", "-", "expr$simplified"}], "]"}], "==", 
         "0"}], ",", 
        RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", "\n", 
      RowBox[{"Return", "[", "False", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolySimplifyCheckSubShort", "[", 
    RowBox[{"{", 
     RowBox[{"expr$unsimplified_", ",", "False"}], "}"}], "]"}], ":=", 
   "False"}], ";"}]}], "Code",
 CellChangeTimes->{{3.928907062161486*^9, 3.928907129704965*^9}, {
  3.9295052089509215`*^9, 3.929505272634899*^9}, {3.929508062846659*^9, 
  3.929508064283856*^9}, {3.932043263464503*^9, 3.932043322802227*^9}, {
  3.932051993385451*^9, 3.932051998512549*^9}, {3.9320522064888*^9, 
  3.932052234525261*^9}, {3.932052265263451*^9, 3.932052459887975*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"331ec24b-9b42-45b5-a0da-a3975375a6f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"long", ",", "short", ",", "sub"}], "}"}], "=", 
   RowBox[{"RandomPolynomial$ON$LSS", "[", 
    RowBox[{"5", ",", "3", ",", "2", ",", "3"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.928906530510956*^9, 3.9289065354198527`*^9}},
 CellLabel->
  "In[110]:=",ExpressionUUID->"0b573700-4d58-49eb-9a97-32908fc56a04"],

Cell[CellGroupData[{

Cell[BoxData[{"long", "\[IndentingNewLine]", "short", "\[IndentingNewLine]", \
"sub"}], "Input",
 CellChangeTimes->{{3.928907194973213*^9, 3.9289072045477605`*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"3609424c-ea13-4b25-9db7-ed504049f3db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  RowBox[{"5", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"]}], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "6"], "-", 
  RowBox[{"5", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"8", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
  RowBox[{"3", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "6"]}]], "Output",
 CellChangeTimes->{
  3.92890662299249*^9, 3.928906855578337*^9, {3.9289071990118628`*^9, 
   3.928907223176617*^9}, 3.928983273709454*^9, 3.928985955141115*^9, 
   3.9302016099670553`*^9},
 CellLabel->
  "Out[111]=",ExpressionUUID->"36441d2e-66fa-43c6-8d18-3ea02a1517bf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  RowBox[{"5", " ", "s"}], "+", 
  RowBox[{"4", " ", 
   SuperscriptBox["s", "2"]}], "+", 
  SuperscriptBox["s", "3"]}]], "Output",
 CellChangeTimes->{
  3.92890662299249*^9, 3.928906855578337*^9, {3.9289071990118628`*^9, 
   3.928907223176617*^9}, 3.928983273709454*^9, 3.928985955141115*^9, 
   3.930201609969808*^9},
 CellLabel->
  "Out[112]=",ExpressionUUID->"483594ee-d438-4100-9b08-a837d84db63e"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"]}]], "Output",
 CellChangeTimes->{
  3.92890662299249*^9, 3.928906855578337*^9, {3.9289071990118628`*^9, 
   3.928907223176617*^9}, 3.928983273709454*^9, 3.928985955141115*^9, 
   3.93020160997227*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"9d1b4ed2-58eb-4fe6-a3e5-0c926d2c6de3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolySimplifyWithHint", "[", 
  RowBox[{"{", 
   RowBox[{"long", ",", "sub"}], "}"}], "]"}]], "Input",ExpressionUUID->\
"f8192eed-a7b6-4452-bbd3-35167136be27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", "s", "-", 
  RowBox[{"2", " ", 
   SuperscriptBox["s", "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox["s", "3"]}]}]], "Output",
 CellChangeTimes->{3.928907183740788*^9, 3.92890722533144*^9, 
  3.928983276434865*^9, 
  3.9289859467528086`*^9},ExpressionUUID->"330f08ee-e96e-4a4d-bc0f-\
6e5c444b6199"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simplified", "=", 
  RowBox[{
   RowBox[{"PolySimplifyWithHint", "[", 
    RowBox[{"{", 
     RowBox[{"long", ",", "sub"}], "}"}], "]"}], "/.", 
   RowBox[{"s", "\[Rule]", "sub"}]}]}]], "Input",
 CellChangeTimes->{{3.928986149242405*^9, 
  3.928986161217343*^9}},ExpressionUUID->"ac51c99c-860b-40e7-b33c-\
753ace5f6811"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "2"], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "3"]}]}]], "Output",
 CellChangeTimes->{
  3.928986162876316*^9},ExpressionUUID->"33ba505d-f52e-4b6b-9213-\
ce606f36db8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simplified", "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.92898595884842*^9, 3.928985976542493*^9}, 
   3.92898616733232*^9},ExpressionUUID->"8cb52a1e-60c8-4685-a68b-\
5daed83fc71b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "1", "]"}], "2"], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "2"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], ")"}], "3"]}]}]], "Output",
 CellChangeTimes->{{3.92898596116868*^9, 3.9289859773632174`*^9}, 
   3.928986028791195*^9, 
   3.92898616777363*^9},ExpressionUUID->"2fcf3c32-4587-4e2e-b473-\
f620c9771a39"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"simplified", "//", "Expand"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.928985987858872*^9, 3.928985988844455*^9}, 
   3.92898616978089*^9},ExpressionUUID->"41e93913-bcf6-43cb-b6e2-\
eb1a5f3023e5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "6"]}], "-", 
  SuperscriptBox[
   RowBox[{"a", "[", "2", "]"}], "2"], "-", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "+", 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "6"]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}]}], ")"}]}], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "4"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.92898598933115*^9, 3.92898602964654*^9, 
  3.9289861702184734`*^9},ExpressionUUID->"390ba231-c632-41a6-b539-\
dd0d2165c247"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"Clear", "[", "PolySimplifyCheckSubShort2", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PolySimplifyCheckSubShort2", "[", 
    RowBox[{"{", 
     RowBox[{"expr$unsimplified_", ",", "expr$sub$short_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "expr$simplified", ",", "expr$sub1", ",", "expr$sub2", ",", 
       "expr$short"}], "}"}], ",", "\n", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"expr$sub$short", "==", "False"}], ",", 
        RowBox[{"Return", "[", "False", "]"}]}], "]"}], ";", "\n", 
      RowBox[{"expr$sub1", "=", 
       RowBox[{"expr$sub$short", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
      RowBox[{"expr$sub2", "=", 
       RowBox[{"expr$sub$short", "\[LeftDoubleBracket]", 
        RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", "\n", 
      RowBox[{"expr$short", "=", 
       RowBox[{
       "expr$sub$short", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"expr$simplified", "=", 
       RowBox[{
        RowBox[{"expr$short", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"b", "[", "0", "]"}], "->", "expr$sub1"}], ",", 
           RowBox[{
            RowBox[{"b", "[", "1", "]"}], "->", "expr$sub2"}]}], "}"}]}], "//",
         "Expand"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"expr$unsimplified", "-", "expr$simplified"}], "]"}], "==", 
         "0"}], ",", 
        RowBox[{"Return", "[", "True", "]"}]}], "]"}], ";", "\n", 
      RowBox[{"Return", "[", "False", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}]}], "Code",
 CellChangeTimes->{{3.928907062161486*^9, 3.928907129704965*^9}, {
   3.9295052089509215`*^9, 3.929505272634899*^9}, {3.929508062846659*^9, 
   3.929508064283856*^9}, {3.932043263464503*^9, 3.932043322802227*^9}, {
   3.932051993385451*^9, 3.932051998512549*^9}, {3.9320522064888*^9, 
   3.932052234525261*^9}, {3.932052265263451*^9, 3.932052459887975*^9}, {
   3.9320644872534*^9, 3.932064499635711*^9}, {3.93206463773232*^9, 
   3.932064656056138*^9}, 3.93533315982548*^9, {3.935333200627034*^9, 
   3.935333258758396*^9}},
 CellLabel->"In[91]:=",ExpressionUUID->"1078f37a-856f-42d1-be21-9ced684498cd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PolySimplifyCheckSubShort2", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "3"}], " ", 
      RowBox[{"a", "[", "0", "]"}]}], "-", 
     RowBox[{"7", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"]}], "+", 
     RowBox[{"40", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "3"]}], "+", 
     RowBox[{"107", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "4"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "0", "]"}], " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{"30", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{"120", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "3"], " ", 
      RowBox[{"a", "[", "1", "]"}]}], "-", 
     RowBox[{"27", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "0", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"]}], "+", 
     RowBox[{"48", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "4"]}]}], ",", "False"}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.935333171055242*^9, 3.935333190891157*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"370daf56-9da7-414e-b51c-40d231bd53a1"],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.935333191279017*^9, 3.935333206421839*^9}, {
  3.935333255235166*^9, 3.935333261551515*^9}},
 CellLabel->
  "Out[215]=",ExpressionUUID->"fb11f061-a41f-484c-9c22-66d970a3cd71"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Training data", "Section",
 CellChangeTimes->{{3.828161936786806*^9, 3.828161941567064*^9}, {
  3.928718969127046*^9, 3.9287189778105106`*^9}, {3.9287191263683043`*^9, 
  3.928719129368809*^9}, {3.92871920353821*^9, 3.928719209105693*^9}, {
  3.9287206720904646`*^9, 3.928720673842574*^9}, {3.928722091477496*^9, 
  3.9287220986111*^9}, {3.9291187570632076`*^9, 
  3.929118760290078*^9}},ExpressionUUID->"bca37522-e9b5-432a-a0be-\
ccb7202ea631"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ConvertL2toL1", "[", "str_String", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"str", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"\"\<A\>\"", "~~", 
            RowBox[{"n", ":", "DigitCharacter"}]}], "\[RuleDelayed]", 
           RowBox[{"\"\<a\>\"", "<>", "n"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<B\>\"", "~~", 
            RowBox[{"n", ":", "DigitCharacter"}]}], "\[RuleDelayed]", 
           RowBox[{"\"\<b\>\"", "<>", "n"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\"\<S\>\"", "~~", 
            RowBox[{"n", ":", "DigitCharacter"}]}], "\[RuleDelayed]", "n"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<P2\>\"", "\[RuleDelayed]", "\"\<P\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<N2\>\"", "\[RuleDelayed]", "\"\<N\>\""}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"\"\<*2\>\"", "\[RuleDelayed]", "\"\<*\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<+2\>\"", "\[RuleDelayed]", "\"\<+\>\""}]}], 
         "\[IndentingNewLine]", "}"}]}], "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\n"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"PredictionData$FromFile", "[", "filename_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"#1", ",", "\"\<\>\""}], "]"}], "&"}], ")"}], "[", 
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"ConvertL2toL1", "@", 
           RowBox[{"Import", "[", "filename", "]"}]}], ",", 
          RowBox[{"\"\<\\n\>\"", "|", "\"\<\:2047\>\""}]}], "]"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"data", ",", "\"\<$\>\""}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "/.", 
        RowBox[{"str_String", "\[RuleDelayed]", 
         RowBox[{"JF$Parser", "[", "str", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Code",
 CellChangeTimes->{{3.928019160508872*^9, 3.9280191614267025`*^9}, {
   3.928019451630807*^9, 3.928019452681113*^9}, {3.92801948563614*^9, 
   3.928019488714672*^9}, {3.928019520784462*^9, 3.928019521824671*^9}, 
   3.928023633519183*^9, {3.929505012986656*^9, 3.929505046491371*^9}, {
   3.932043497014859*^9, 3.932043537451875*^9}, {3.932064234945116*^9, 
   3.932064245902457*^9}, {3.938728762398769*^9, 3.938728766320425*^9}, {
   3.938728808870425*^9, 3.9387288282993917`*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"e36f5fc6-4779-4dd2-b633-2de673800a54"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LongSubPair$ReadFile", "[", "filename_", "]"}], ":=", 
    RowBox[{"StringSplit", "[", 
     RowBox[{
      RowBox[{"Import", "[", "filename", "]"}], ",", "\"\<\\n\>\""}], "]"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LongSubPair$FromString", "[", "txt_String", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{"StringSplit", "[", 
        RowBox[{"txt", ",", "\"\< ? \>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Dimensions", "[", "data", "]"}], "=!=", 
         RowBox[{"{", "2", "}"}]}], ",", 
        RowBox[{
        "Print", "[", "\"\<readDataSet failed. Wrong format.\>\"", "]"}]}], 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "/.", 
        RowBox[{"str_String", "\[RuleDelayed]", 
         RowBox[{"JF$Parser", "[", "str", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LongSubPair$FromFile", "[", "filename_", "]"}], ":=", 
   RowBox[{
    RowBox[{"StringSplit", "[", 
     RowBox[{
      RowBox[{"ConvertL2toL1", "@", 
       RowBox[{"Import", "[", "filename", "]"}]}], ",", "\"\<\\n\>\""}], 
     "]"}], "/.", "\[VeryThinSpace]", 
    RowBox[{"str_String", "\[RuleDelayed]", 
     RowBox[{"LongSubPair$FromString", "[", "str", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"TestData$FromFile", "=", "LongSubPair$FromFile"}], ";"}]}], "Code",
 CellChangeTimes->{{3.929117842412506*^9, 3.929117851292366*^9}, {
  3.929118010885827*^9, 3.929118100947709*^9}, {3.929118140825908*^9, 
  3.929118149258647*^9}, {3.92911822551142*^9, 3.929118255500101*^9}, {
  3.929118554773282*^9, 3.929118572411*^9}, {3.929118770630786*^9, 
  3.929118783284549*^9}, {3.929505054363595*^9, 3.929505055754696*^9}, {
  3.929509182118759*^9, 3.9295092102802153`*^9}, {3.938728779594804*^9, 
  3.938728795166376*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"0e63539a-8f97-41aa-8f33-65a1b2862f13"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{"StringSplit", "[", 
     RowBox[{
      RowBox[{
      "Import", "[", "\"\<./Evaluation/Exp44/test_set_Exp44.txt\>\"", "]"}], 
      ",", 
      RowBox[{"\"\<\\n\>\"", "|", "\"\<?\>\""}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data0", "=", 
   RowBox[{
    RowBox[{"StringSplit", "[", 
     RowBox[{
      RowBox[{
      "Import", "[", "\"\<./Evaluation/Exp41/test_set_Exp41.txt\>\"", "]"}], 
      ",", 
      RowBox[{"\"\<\\n\>\"", "|", "\"\<?\>\""}]}], "]"}], "//", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.932045642698489*^9, 3.932045698820945*^9}, {
  3.932045732898185*^9, 3.932045789821736*^9}, {3.9320467248419523`*^9, 
  3.932046732195632*^9}},
 CellLabel->
  "In[697]:=",ExpressionUUID->"8ab3f5fc-260f-45fe-8c35-b6985692acf5"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data2", "=", 
   RowBox[{"data", "[", 
    RowBox[{"[", 
     RowBox[{"2", ";;", 
      RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data2", "=", 
   RowBox[{
    RowBox[{"StringSplit", "[", 
     RowBox[{"data2", ",", "\"\<$\>\""}], "]"}], "//", 
    RowBox[{
     RowBox[{"DeleteCases", "[", 
      RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", "\"\<MMA2TxtFormat3.m\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"data2", "\[LeftDoubleBracket]", "2", 
  "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{"%", "/.", 
  RowBox[{"str_String", "\[RuleDelayed]", 
   RowBox[{"JF$Parser", "[", "str", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data2", "/.", 
   RowBox[{"str_String", "\[RuleDelayed]", 
    RowBox[{"JF$Parser", "[", "str", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "\[LeftDoubleBracket]", "2", 
  "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.932045773935691*^9, 3.932045907470648*^9}, {
  3.932047669192147*^9, 3.932047686383655*^9}},
 CellLabel->
  "In[735]:=",ExpressionUUID->"2776f037-8d5b-4701-9cb4-f2dd9d3a71a8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\" + * N 6 ^ a2 P 2 * N 7 * a1 a3 \"\>", 
   ",", "\<\" + N 9 + * N 3 b0 ^ b0 P 2\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.932045894242766*^9, 3.932045930446623*^9}, {
  3.932046438193192*^9, 3.932046441254739*^9}, {3.932046553581144*^9, 
  3.932046554629759*^9}, {3.932046610015238*^9, 3.932046612045701*^9}, {
  3.932046664054764*^9, 3.932046675937478*^9}, {3.932047674356989*^9, 
  3.932047686716305*^9}},
 CellLabel->
  "Out[738]=",ExpressionUUID->"d51ab59e-f926-4c73-a833-2d8b44adf48d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "6"}], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
    RowBox[{"7", " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"a", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "9"}], "-", 
    RowBox[{"3", " ", 
     RowBox[{"b", "[", "0", "]"}]}], "+", 
    SuperscriptBox[
     RowBox[{"b", "[", "0", "]"}], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.932045894242766*^9, 3.932045930446623*^9}, {
  3.932046438193192*^9, 3.932046441254739*^9}, {3.932046553581144*^9, 
  3.932046554629759*^9}, {3.932046610015238*^9, 3.932046612045701*^9}, {
  3.932046664054764*^9, 3.932046675937478*^9}, {3.932047674356989*^9, 
  3.932047686719182*^9}},
 CellLabel->
  "Out[739]=",ExpressionUUID->"db548e16-4b58-4493-876a-ffc12a451316"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "6"}], " ", 
     SuperscriptBox[
      RowBox[{"a", "[", "2", "]"}], "2"]}], "-", 
    RowBox[{"7", " ", 
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"a", "[", "3", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"-", "9"}], "-", 
    RowBox[{"3", " ", 
     RowBox[{"b", "[", "0", "]"}]}], "+", 
    SuperscriptBox[
     RowBox[{"b", "[", "0", "]"}], "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.932045894242766*^9, 3.932045930446623*^9}, {
  3.932046438193192*^9, 3.932046441254739*^9}, {3.932046553581144*^9, 
  3.932046554629759*^9}, {3.932046610015238*^9, 3.932046612045701*^9}, {
  3.932046664054764*^9, 3.932046675937478*^9}, {3.932047674356989*^9, 
  3.932047688676694*^9}},
 CellLabel->
  "Out[741]=",ExpressionUUID->"ed032e29-5948-4d0b-82cb-3867bdd897dc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TestData$FromFile2", "[", "filename_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"Import", "[", "filename", "]"}], ",", 
          RowBox[{"\"\<\\n\>\"", "|", "\"\<?\>\""}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}], ";;", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "/.", 
        RowBox[{"str_String", "\[RuleDelayed]", 
         RowBox[{"JF$Parser", "[", "str", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.928019160508872*^9, 3.9280191614267025`*^9}, {
   3.928019451630807*^9, 3.928019452681113*^9}, {3.92801948563614*^9, 
   3.928019488714672*^9}, {3.928019520784462*^9, 3.928019521824671*^9}, 
   3.928023633519183*^9, {3.929505012986656*^9, 3.929505046491371*^9}, {
   3.932043497014859*^9, 3.932043537451875*^9}, {3.932047476749448*^9, 
   3.9320474985403757`*^9}, {3.932047795186171*^9, 3.932047796187415*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"bfcf5425-25ed-4730-b3b8-da261a3f601c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TestData$FromFile2$both", "[", "filename_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"data", ",", "dataq", ",", "dataa"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"Import", "[", "filename", "]"}], ",", 
          RowBox[{"\"\<\\n\>\"", "|", "\"\<?\>\""}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dataq", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", 
          RowBox[{"-", "2"}], ";;", "2"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"dataa", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"dataa", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"dataa", ",", "\"\<&\>\""}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "dataq", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "/.", 
             RowBox[{"str_String", "\[RuleDelayed]", 
              RowBox[{"JF$Parser", "[", "str", "]"}]}]}], "}"}], "~", "Join", 
           "~", 
           RowBox[{
           "dataa", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "/.", 
          RowBox[{"str_String", "\[RuleDelayed]", 
           RowBox[{"JF$Parser", "[", "str", "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "dataq", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.928019160508872*^9, 3.9280191614267025`*^9}, {
   3.928019451630807*^9, 3.928019452681113*^9}, {3.92801948563614*^9, 
   3.928019488714672*^9}, {3.928019520784462*^9, 3.928019521824671*^9}, 
   3.928023633519183*^9, {3.929505012986656*^9, 3.929505046491371*^9}, {
   3.932043497014859*^9, 3.932043537451875*^9}, {3.932047476749448*^9, 
   3.9320474985403757`*^9}, {3.932047795186171*^9, 3.932047796187415*^9}, {
   3.942187785815565*^9, 3.942187849548216*^9}, {3.942187880853278*^9, 
   3.9421879011930447`*^9}, {3.942187932228261*^9, 3.942188036048691*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"afc4de16-3c51-4429-b360-8304ac15b935"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TestData$FromFile2$answers", "[", "filename_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"Import", "[", "filename", "]"}], ",", 
          RowBox[{"\"\<\\n\>\"", "|", "\"\<?\>\""}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"data", ",", "\"\<&\>\""}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
             "data", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "]"}], "==", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"StringSplit", "[", 
               RowBox[{
                RowBox[{"data", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                "\"\<$\>\""}], "]"}], "//", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], ",", 
             RowBox[{"data", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
           ",", "False"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "/.", 
        RowBox[{"str_String", "\[RuleDelayed]", 
         RowBox[{"JF$Parser", "[", "str", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.928019160508872*^9, 3.9280191614267025`*^9}, {
   3.928019451630807*^9, 3.928019452681113*^9}, {3.92801948563614*^9, 
   3.928019488714672*^9}, {3.928019520784462*^9, 3.928019521824671*^9}, 
   3.928023633519183*^9, {3.929505012986656*^9, 3.929505046491371*^9}, {
   3.932043497014859*^9, 3.932043537451875*^9}, {3.932047476749448*^9, 
   3.9320474985403757`*^9}, {3.932047795186171*^9, 3.932047796187415*^9}, {
   3.936814847864978*^9, 3.936814860565871*^9}, 3.936815095170447*^9},
 CellLabel->
  "In[101]:=",ExpressionUUID->"e33020c0-281e-4c03-a373-6bcdadb21f95"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "TestData$FromFile2", "[", "\"\<./Evaluation/Exp44/test_set_Exp44.txt\>\"", 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"%", "\[LeftDoubleBracket]", "1", 
  "\[RightDoubleBracket]"}]}], "Input",
 CellChangeTimes->{{3.932047810848835*^9, 3.932047828990563*^9}},
 CellLabel->
  "In[747]:=",ExpressionUUID->"e8c34b32-4d08-47e3-ba6a-4fee4aa2ab82"],

Cell[BoxData[
 RowBox[{"6", "-", 
  RowBox[{"35", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"]}], "+", 
  RowBox[{"25", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "1", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "4"]}], "-", 
  RowBox[{"42", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"60", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "2", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "2"]}], "+", 
  RowBox[{"36", " ", 
   SuperscriptBox[
    RowBox[{"a", "[", "3", "]"}], "4"]}]}]], "Output",
 CellChangeTimes->{{3.932047821931605*^9, 3.932047833437599*^9}},
 CellLabel->
  "Out[748]=",ExpressionUUID->"4b50a8d9-2416-447a-9225-53dccc87c27e"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PredictionData$FromFile2", "[", "filename_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"Import", "[", "filename", "]"}], ",", 
          RowBox[{"\"\<\\n\>\"", "|", "\"\<\:2047\>\""}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"data", ",", "\"\<&\>\""}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
             "data", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "]"}], "==", "2"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"StringSplit", "[", 
               RowBox[{
                RowBox[{"data", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                "\"\<$\>\""}], "]"}], "//", 
              RowBox[{
               RowBox[{"DeleteCases", "[", 
                RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}], ",", 
             RowBox[{"data", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "}"}], 
           ",", "False"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "data", "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "/.", 
        RowBox[{"str_String", "\[RuleDelayed]", 
         RowBox[{"JF$Parser", "[", "str", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.928019160508872*^9, 3.9280191614267025`*^9}, {
   3.928019451630807*^9, 3.928019452681113*^9}, {3.92801948563614*^9, 
   3.928019488714672*^9}, {3.928019520784462*^9, 3.928019521824671*^9}, 
   3.928023633519183*^9, {3.929505012986656*^9, 3.929505046491371*^9}, {
   3.932043497014859*^9, 3.932043537451875*^9}, {3.932063427612282*^9, 
   3.932063435681137*^9}, {3.932063527945074*^9, 3.9320635372165623`*^9}, {
   3.932064281633477*^9, 3.932064312472046*^9}, {3.932064384094896*^9, 
   3.932064387594173*^9}, {3.9353327399949207`*^9, 3.935332819737931*^9}, {
   3.935332865893409*^9, 3.9353328741730337`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"df4bf76d-b3cb-4c0c-b73f-c84c2d279aaa"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PredictionData$FromFile3", "[", "filename_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"Import", "[", "filename", "]"}], ",", 
          RowBox[{"\"\<\\n\>\"", "|", "\"\<\:2047\>\""}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"data", ",", "\"\<&\>\""}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "/.", 
        RowBox[{"str_String", "\[RuleDelayed]", 
         RowBox[{"JF$Parser", "[", "str", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Code",
 CellChangeTimes->{{3.928019160508872*^9, 3.9280191614267025`*^9}, {
   3.928019451630807*^9, 3.928019452681113*^9}, {3.92801948563614*^9, 
   3.928019488714672*^9}, {3.928019520784462*^9, 3.928019521824671*^9}, 
   3.928023633519183*^9, {3.929505012986656*^9, 3.929505046491371*^9}, {
   3.932043497014859*^9, 3.932043537451875*^9}, {3.932063427612282*^9, 
   3.932063435681137*^9}, {3.932063527945074*^9, 3.9320635372165623`*^9}, {
   3.932064281633477*^9, 3.932064312472046*^9}, {3.932064384094896*^9, 
   3.932064387594173*^9}, {3.9353327399949207`*^9, 3.935332819737931*^9}, {
   3.935332865893409*^9, 3.9353328741730337`*^9}, {3.9396579027815027`*^9, 
   3.939657902987262*^9}, {3.9396579487400217`*^9, 3.9396579496816587`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"8bbc0edf-618e-43d2-ae3f-467daf3939ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Evaluation", "Section",
 CellChangeTimes->{{3.931434583244385*^9, 
  3.931434586963332*^9}},ExpressionUUID->"32a35fc5-0414-46f2-8f07-\
adea46ed9ae3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateSimplificationResult", "[", 
    RowBox[{"testfile_", ",", "predictionfile_", ",", 
     RowBox[{"complexityCriteriaQ_", ":", "True"}], ",", 
     RowBox[{"eliminateQ_", ":", "True"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "testdata", ",", "predictiondata", ",", "simplification$result", ",", 
       "pctg$grammaticerr", ",", "pctg$wrong", ",", "pctg$correct"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testdata", "=", 
       RowBox[{"TestData$FromFile", "[", "testfile", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"predictiondata", "=", 
       RowBox[{"PredictionData$FromFile", "[", "predictionfile", "]"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"simplification$result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolySimplifyWithHint", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"testdata", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
             RowBox[{"predictiondata", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
           "complexityCriteriaQ", ",", "eliminateQ"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "predictiondata"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pctg$grammaticerr", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"Count", "[", 
          RowBox[{"predictiondata", ",", "False"}], "]"}], 
         RowBox[{"Length", "[", "predictiondata", "]"}]], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pctg$wrong", "=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]], "-", 
         "pctg$grammaticerr"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pctg$correct", "=", 
       RowBox[{
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]]}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"pctg$grammaticerr", ",", "pctg$wrong", ",", "pctg$correct"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.928019160508872*^9, 3.9280191614267025`*^9}, {
   3.928019451630807*^9, 3.928019452681113*^9}, {3.92801948563614*^9, 
   3.928019488714672*^9}, {3.928019520784462*^9, 3.928019521824671*^9}, 
   3.928023633519183*^9, {3.929505012986656*^9, 3.929505046491371*^9}, {
   3.931434594233966*^9, 3.9314345998278427`*^9}, {3.932046882013945*^9, 
   3.932046882172332*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"98d0183b-36d5-4bb8-86bc-f4e3ff8b926b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateSimplificationResult2", "[", 
    RowBox[{"testfile_", ",", "predictionfile_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "testdata", ",", "predictiondata", ",", "simplification$result", ",", 
       "pctg$grammaticerr", ",", "pctg$wrong", ",", "pctg$correct"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testdata", "=", 
       RowBox[{"TestData$FromFile2", "[", "testfile", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"predictiondata", "=", 
       RowBox[{"PredictionData$FromFile", "[", "predictionfile", "]"}]}], ";",
       "\n", 
      RowBox[{"predictiondata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
             "predictiondata", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}], "==", "2"}], ",", " ", 
           RowBox[{
           "predictiondata", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", " ", "False"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "predictiondata", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"simplification$result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolySimplifyCheckSubShort", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "testdata", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "predictiondata", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "predictiondata"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pctg$grammaticerr", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"Count", "[", 
          RowBox[{"predictiondata", ",", "False"}], "]"}], 
         RowBox[{"Length", "[", "predictiondata", "]"}]], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pctg$wrong", "=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]], "-", 
         "pctg$grammaticerr"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pctg$correct", "=", 
       RowBox[{
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]]}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"pctg$grammaticerr", ",", "pctg$wrong", ",", "pctg$correct"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.928019160508872*^9, 3.9280191614267025`*^9}, {
   3.928019451630807*^9, 3.928019452681113*^9}, {3.92801948563614*^9, 
   3.928019488714672*^9}, {3.928019520784462*^9, 3.928019521824671*^9}, 
   3.928023633519183*^9, {3.929505012986656*^9, 3.929505046491371*^9}, {
   3.931434594233966*^9, 3.9314345998278427`*^9}, {3.932046882013945*^9, 
   3.932046882172332*^9}, {3.932047382215461*^9, 3.932047402245398*^9}, 
   3.932047842804554*^9, {3.932048069595398*^9, 3.932048158367318*^9}, {
   3.932052025741022*^9, 3.932052047196144*^9}, {3.932052082068839*^9, 
   3.932052177727009*^9}, {3.932064537090469*^9, 3.932064595219846*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"8f95c4fc-9c12-4636-9d4f-caec9d953338"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PredictionData$FromFile$test", "[", "filename_", "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "data", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{
          RowBox[{"Import", "[", "filename", "]"}], ",", 
          RowBox[{"\"\<\\n\>\"", "|", "\"\<?\>\""}]}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"2", ";;", 
          RowBox[{"-", "1"}], ";;", "2"}], "]"}], "]"}]}], ";", "\n", 
      RowBox[{"data", "=", 
       RowBox[{
        RowBox[{"StringSplit", "[", 
         RowBox[{"data", ",", "\"\<$\>\""}], "]"}], "//", 
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{"#", ",", "\"\<\>\""}], "]"}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"data", "=", 
       RowBox[{"data", "/.", 
        RowBox[{"str_String", "\[RuleDelayed]", 
         RowBox[{"JF$Parser", "[", "str", "]"}]}]}]}], ";", 
      "\[IndentingNewLine]", "data"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.932052720183906*^9, 3.932052725731402*^9}},
 CellLabel->
  "In[164]:=",ExpressionUUID->"e3997767-edc3-4d17-9866-ce58d22df3fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateSimplificationResult2$test", "[", 
    RowBox[{"testfile_", ",", "predictionfile_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "testdata", ",", "predictiondata", ",", "simplification$result", ",", 
       "pctg$grammaticerr", ",", "pctg$wrong", ",", "pctg$correct", ",", 
       "test$grammaticerr"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testdata", "=", 
       RowBox[{"TestData$FromFile2", "[", "testfile", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"predictiondata", "=", 
       RowBox[{"PredictionData$FromFile$test", "[", "predictionfile", "]"}]}],
       ";", "\n", 
      RowBox[{"predictiondata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
             "predictiondata", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}], "==", "2"}], ",", 
           RowBox[{
           "predictiondata", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "False"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "predictiondata", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"simplification$result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolySimplifyCheckSubShort", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "testdata", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "predictiondata", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "predictiondata"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pctg$grammaticerr", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"Count", "[", 
          RowBox[{"predictiondata", ",", "False"}], "]"}], 
         RowBox[{"Length", "[", "predictiondata", "]"}]], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pctg$wrong", "=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]], "-", 
         "pctg$grammaticerr"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pctg$correct", "=", 
       RowBox[{
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]]}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"pctg$grammaticerr", ",", "pctg$wrong", ",", "pctg$correct"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.932052589613073*^9, 3.932052598340468*^9}, {
   3.932052739999467*^9, 3.93205274318169*^9}, 3.932064773027767*^9, {
   3.935333819824003*^9, 3.935333905311573*^9}},
 CellLabel->
  "In[297]:=",ExpressionUUID->"e40e80a1-7117-4099-ad67-a06fcfeae628"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EvaluateSimplificationResult2$test", "[", 
  RowBox[{
  "\"\<./Evaluation/Exp44/test_set_Exp44.txt\>\"", ",", 
   "\"\<./Evaluation/Exp44/test_set_Exp44.txt\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.9320479629759407`*^9, 3.932047975199997*^9}, 
   3.9320525563154993`*^9, {3.932052601187674*^9, 3.932052618419763*^9}, 
   3.932064776466165*^9},
 CellLabel->
  "In[166]:=",ExpressionUUID->"96c70e42-771d-4ad0-b572-c88881a86b6e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.932047966334708*^9, 3.932047975853594*^9}, 
   3.932048023605021*^9, 3.932052628000925*^9, 3.932052753470586*^9, 
   3.93206478304426*^9},
 CellLabel->
  "Out[166]=",ExpressionUUID->"d599fae9-efb8-4bb9-a414-8c2011ad3096"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateSimplificationResult3", "[", 
    RowBox[{"testfile_", ",", "predictionfile_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "testdata", ",", "predictiondata", ",", "simplification$result", ",", 
       "pctg$grammaticerr", ",", "pctg$wrong", ",", "pctg$correct", ",", 
       "test$grammaticerr"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testdata", "=", 
       RowBox[{"TestData$FromFile2", "[", "testfile", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"predictiondata", "=", 
       RowBox[{"PredictionData$FromFile2", "[", "predictionfile", "]"}]}], 
      ";", "\n", 
      RowBox[{"predictiondata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "predictiondata", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}], "==", "2"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"predictiondata", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "==",
              "2"}]}], ",", 
           RowBox[{
           "predictiondata", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "False"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "predictiondata", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"simplification$result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolySimplifyCheckSubShort2", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "testdata", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "predictiondata", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "predictiondata"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"test$grammaticerr", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"Count", "[", 
          RowBox[{"testdata", ",", "False"}], "]"}], 
         RowBox[{"Length", "[", "testdata", "]"}]], "//", "N"}]}], ";", "\n", 
      RowBox[{"pctg$grammaticerr", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"Count", "[", 
          RowBox[{"predictiondata", ",", "False"}], "]"}], 
         RowBox[{"Length", "[", "predictiondata", "]"}]], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pctg$wrong", "=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]], "-", 
         "pctg$grammaticerr"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pctg$correct", "=", 
       RowBox[{
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]]}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
       "test$grammaticerr", ",", "pctg$grammaticerr", ",", "pctg$wrong", ",", 
        "pctg$correct", ",", "simplification$result"}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Code",
 CellChangeTimes->{{3.928019160508872*^9, 3.9280191614267025`*^9}, {
   3.928019451630807*^9, 3.928019452681113*^9}, {3.92801948563614*^9, 
   3.928019488714672*^9}, {3.928019520784462*^9, 3.928019521824671*^9}, 
   3.928023633519183*^9, {3.929505012986656*^9, 3.929505046491371*^9}, {
   3.931434594233966*^9, 3.9314345998278427`*^9}, {3.932046882013945*^9, 
   3.932046882172332*^9}, {3.932047382215461*^9, 3.932047402245398*^9}, 
   3.932047842804554*^9, {3.932048069595398*^9, 3.932048158367318*^9}, {
   3.932052025741022*^9, 3.932052047196144*^9}, {3.932052082068839*^9, 
   3.932052177727009*^9}, {3.932063460315468*^9, 3.932063460414152*^9}, 
   3.932064457022978*^9, {3.932064604733834*^9, 3.932064606210384*^9}, 
   3.932064715900432*^9, {3.935333885316312*^9, 3.935333901794443*^9}, {
   3.936203119971561*^9, 3.93620312243834*^9}},
 CellLabel->
  "In[106]:=",ExpressionUUID->"c2f7aa21-7e95-470b-bf59-de8e4dcf5d47"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EvaluateSimplificationResult3$test", "[", 
    RowBox[{"testfile_", ",", "predictionfile_"}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "testdata", ",", "predictiondata", ",", "simplification$result", ",", 
       "pctg$grammaticerr", ",", "pctg$wrong", ",", "pctg$correct"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"testdata", "=", 
       RowBox[{"TestData$FromFile2", "[", "testfile", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"predictiondata", "=", 
       RowBox[{
       "PredictionData$FromFile2$test", "[", "predictionfile", "]"}]}], ";", 
      "\n", 
      RowBox[{"predictiondata", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{
              "predictiondata", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}], "==", "2"}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"predictiondata", "\[LeftDoubleBracket]", 
               RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "]"}], "==",
              "2"}]}], ",", 
           RowBox[{
           "predictiondata", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}], ",", "False"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "predictiondata", "]"}]}], "}"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"simplification$result", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"PolySimplifyCheckSubShort2", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "testdata", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{
            "predictiondata", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "predictiondata"}]}], "}"}]}], "]"}]}], ";",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pctg$grammaticerr", "=", 
       RowBox[{
        FractionBox[
         RowBox[{"Count", "[", 
          RowBox[{"predictiondata", ",", "False"}], "]"}], 
         RowBox[{"Length", "[", "predictiondata", "]"}]], "//", "N"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"pctg$wrong", "=", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]], "-", 
         "pctg$grammaticerr"}], "//", "N"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"pctg$correct", "=", 
       RowBox[{
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{"Count", "[", 
           RowBox[{"simplification$result", ",", "False"}], "]"}], 
          RowBox[{"Length", "[", "simplification$result", "]"}]]}], "//", 
        "N"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"pctg$grammaticerr", ",", "pctg$wrong", ",", "pctg$correct"}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.932064693864769*^9, 3.932064700797929*^9}, 
   3.932064735336362*^9},
 CellLabel->
  "In[161]:=",ExpressionUUID->"e6fea111-8ee4-4007-9b20-193da8cc8c74"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EvaluateSimplificationResult3$test", "[", 
  RowBox[{
  "\"\<./Evaluation/Exp45/test_set_Exp45.txt\>\"", ",", 
   "\"\<./Evaluation/Exp45/test_set_Exp45.txt\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.932064788305787*^9, 3.932064795135942*^9}},
 CellLabel->
  "In[167]:=",ExpressionUUID->"6a07c936-7a15-4bd3-87ec-2b516d350b35"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`", ",", "1.`"}], "}"}]], "Output",
 CellChangeTimes->{3.932064802323806*^9},
 CellLabel->
  "Out[167]=",ExpressionUUID->"594d144c-21e9-4ed9-b8c3-6f3156d3abfd"]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1205, 755},
WindowMargins->{{Automatic, 64}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"13.2 for Mac OS X ARM (64-bit) (November 18, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fc544bc8-3dd1-4741-bf8a-7a0de2cbbb16"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 255, 4, 84, "Section",ExpressionUUID->"47ea2f20-16d1-44f4-bbab-2e696ef77cb0"],
Cell[CellGroupData[{
Cell[860, 30, 271, 4, 67, "Subsection",ExpressionUUID->"5dc52680-a29f-4609-9f68-c037a1bab6ee"],
Cell[1134, 36, 235, 6, 44, "Text",ExpressionUUID->"bd4ecb0d-e460-4b6d-b746-91de353d918f"],
Cell[1372, 44, 3170, 77, 306, "Code",ExpressionUUID->"d282661d-5bcf-47fb-8f77-38459f406031"],
Cell[CellGroupData[{
Cell[4567, 125, 350, 8, 37, "Input",ExpressionUUID->"06c4cc07-ea2b-4731-acd5-c1e7922331b9"],
Cell[4920, 135, 2590, 83, 70, "Output",ExpressionUUID->"15a5033b-f2dc-4766-a6ba-62db7d1663bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7547, 223, 376, 8, 37, "Input",ExpressionUUID->"a86103ba-d5be-4b49-806a-4b40f801e7d0"],
Cell[7926, 233, 447, 10, 43, "Output",ExpressionUUID->"3b304af7-08da-46d7-983f-711b5fa9f571"]
}, Open  ]],
Cell[8388, 246, 2386, 56, 258, "Code",ExpressionUUID->"6bb80cd8-247b-4956-9168-e1bf55b7bedf"],
Cell[CellGroupData[{
Cell[10799, 306, 732, 13, 64, "Input",ExpressionUUID->"652e8c0a-1b3f-49a8-9087-0cd3c1da80b9"],
Cell[11534, 321, 573, 13, 43, "Output",ExpressionUUID->"2c7013c1-8abd-460f-9a4a-5feb05022935"],
Cell[12110, 336, 638, 15, 43, "Output",ExpressionUUID->"acaf100e-9d5e-4182-9828-1d65a974ad0a"]
}, Open  ]],
Cell[12763, 354, 3114, 73, 282, "Code",ExpressionUUID->"62705237-0577-434f-824e-1c32165b2fad"],
Cell[CellGroupData[{
Cell[15902, 431, 290, 7, 37, "Input",ExpressionUUID->"23511e11-a739-4801-9b1f-dd5abd84b904"],
Cell[16195, 440, 365, 10, 42, "Output",ExpressionUUID->"d0edc7ff-98b9-48e5-9d89-f6dfdb3fdba6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16597, 455, 333, 7, 37, "Input",ExpressionUUID->"a8684af1-03d4-49ab-bff4-16b20dd4ac14"],
Cell[16933, 464, 224, 6, 43, "Output",ExpressionUUID->"ec0dcd76-4dda-4c56-acd3-a0a638c213ec"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17194, 475, 556, 12, 64, "Input",ExpressionUUID->"9844a4b9-2e81-4fdf-a83f-83eb46874303"],
Cell[17753, 489, 514, 12, 43, "Output",ExpressionUUID->"5d9ffc44-ee7e-4ac1-b325-27d2a4c34216"],
Cell[18270, 503, 546, 13, 43, "Output",ExpressionUUID->"27a7a279-d431-4512-bc67-b66793bb538f"]
}, Open  ]],
Cell[18831, 519, 538, 12, 37, "Input",ExpressionUUID->"acf96fd8-0899-4965-99e6-68413f8d7302"],
Cell[19372, 533, 3088, 70, 308, "Code",ExpressionUUID->"f5c3b839-23a3-441d-9f55-c189dc41d02e"],
Cell[CellGroupData[{
Cell[22485, 607, 628, 14, 64, "Input",ExpressionUUID->"711d3f9e-c8d6-4956-a4e9-8f3064f7ed90"],
Cell[23116, 623, 440, 11, 43, "Output",ExpressionUUID->"b9b54db1-4ccc-4392-a03c-97a1f37ea3fc"],
Cell[23559, 636, 490, 13, 43, "Output",ExpressionUUID->"9c674b4e-1a8c-43e2-9707-c788f0259aa0"]
}, Open  ]],
Cell[24064, 652, 3136, 71, 339, "Code",ExpressionUUID->"66356eb2-9c8a-49fc-bc7c-53fd5ab5001d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27237, 728, 525, 9, 67, "Subsection",ExpressionUUID->"d1119568-e941-4711-8283-8faf049cc0de"],
Cell[27765, 739, 2243, 66, 191, "Text",ExpressionUUID->"2c08e1d0-8d13-4118-ac79-377d21bf36cd",
 InitializationCell->True],
Cell[30011, 807, 5360, 117, 406, "Code",ExpressionUUID->"2de0f464-a529-456f-877f-82002aa97e23"],
Cell[CellGroupData[{
Cell[35396, 928, 260, 5, 37, "Input",ExpressionUUID->"7725faa5-f722-43c6-b235-ff7def720a26"],
Cell[35659, 935, 528, 15, 42, "Output",ExpressionUUID->"96da4854-bd91-407a-b52d-1ade2b92498c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36224, 955, 364, 7, 64, "Input",ExpressionUUID->"168ed261-b080-48e2-8cba-9975efa59674"],
Cell[36591, 964, 1297, 39, 46, "Output",ExpressionUUID->"c7fd5f2a-c609-4e8c-b81f-b10583efc3ca"],
Cell[37891, 1005, 278, 5, 42, "Output",ExpressionUUID->"7c9c811a-63af-48b3-b8b1-0bd90afcecfb"]
}, Open  ]],
Cell[38184, 1013, 7391, 160, 438, "Code",ExpressionUUID->"4a1bcfcd-094e-48a3-8eb4-89103d2d4a54"],
Cell[CellGroupData[{
Cell[45600, 1177, 470, 8, 37, "Input",ExpressionUUID->"6674d628-3c75-4588-9136-9525d7a9f3a1"],
Cell[46073, 1187, 2023, 54, 69, "Output",ExpressionUUID->"d20925fc-7148-4fe3-9a3d-58cd089266ae"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[48145, 1247, 792, 16, 68, "Subsection",ExpressionUUID->"f8e57a12-da04-4e6b-8a30-039291c42b49"],
Cell[48940, 1265, 729, 22, 44, "Text",ExpressionUUID->"86ac6048-ad8b-4f82-97a4-ea109d5a8671"],
Cell[49672, 1289, 3115, 74, 378, "Code",ExpressionUUID->"9f2d8806-a63c-4e43-8414-4909eb6ede8e"],
Cell[CellGroupData[{
Cell[52812, 1367, 290, 6, 37, "Input",ExpressionUUID->"cc262240-bebd-49d5-953b-865cb9919693"],
Cell[53105, 1375, 1181, 37, 46, "Output",ExpressionUUID->"ab89e591-fd63-4546-baa0-c852ab6f8f28"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54335, 1418, 884, 19, 68, "Subsection",ExpressionUUID->"4853c4bb-4ef1-43bc-a87f-29787e9ff5ed"],
Cell[55222, 1439, 4453, 101, 471, "Code",ExpressionUUID->"3835ec57-d96b-403a-8b55-1f83554ed57e"],
Cell[CellGroupData[{
Cell[59700, 1544, 314, 7, 37, "Input",ExpressionUUID->"f53f99bd-b65b-4ac8-92cc-01b2fb59d318"],
Cell[60017, 1553, 4336, 130, 127, "Output",ExpressionUUID->"ffc8130f-f18e-47ea-8eb8-38336dbc4e98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64390, 1688, 357, 7, 37, "Input",ExpressionUUID->"f42ef64a-7d91-4dc5-81ee-b1308f75b858"],
Cell[64750, 1697, 2632, 78, 101, "Output",ExpressionUUID->"f0208593-fd78-4b0b-8912-997b0d11a0a3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67419, 1780, 366, 9, 37, "Input",ExpressionUUID->"322dbe4c-5ffb-4be5-a6d3-3d7f99c1accb"],
Cell[67788, 1791, 466, 11, 42, "Output",ExpressionUUID->"638009fa-1227-4e2b-bbec-37ef512ac755"]
}, Open  ]],
Cell[68269, 1805, 225, 5, 37, "Input",ExpressionUUID->"6ec50d3b-6c0e-4624-badb-22f467ba4854"],
Cell[68497, 1812, 4700, 107, 471, "Code",ExpressionUUID->"62fab334-9db8-4fb7-9985-dfce717f3a5d"],
Cell[73200, 1921, 215, 5, 37, "Input",ExpressionUUID->"f2828ab3-b02e-4c8b-bf6b-e0db8c2e3f29"],
Cell[73418, 1928, 732, 19, 64, "Input",ExpressionUUID->"8078b2bd-ae4f-4746-9d61-69d60a096952"],
Cell[74153, 1949, 2994, 69, 287, "Code",ExpressionUUID->"2c06e0cd-4de3-420f-955f-b7f09da9f5bc"],
Cell[CellGroupData[{
Cell[77172, 2022, 611, 18, 37, "Input",ExpressionUUID->"8e0eb940-d091-4bda-914d-abd34b21c4f2"],
Cell[77786, 2042, 413, 9, 43, "Output",ExpressionUUID->"fa7c54a8-5d60-4edc-9133-3a666fe5fcd9"]
}, Open  ]],
Cell[78214, 2054, 502, 12, 64, "Input",ExpressionUUID->"cab622b5-c8d1-4435-a566-91a48d72e10a"],
Cell[78719, 2068, 4618, 105, 471, "Code",ExpressionUUID->"1f963fac-9674-494b-a1b5-ed7a36698ac5"],
Cell[CellGroupData[{
Cell[83362, 2177, 805, 23, 37, "Input",ExpressionUUID->"0d62dc3d-9809-4aec-ae35-88b9e258bb17"],
Cell[84170, 2202, 1548, 48, 75, "Output",ExpressionUUID->"65f4b572-735d-4329-aae2-ecf8add15948"]
}, Open  ]],
Cell[85733, 2253, 404, 10, 37, "Input",ExpressionUUID->"73de9172-e96d-4d5e-b620-2ba8a08b7281"],
Cell[86140, 2265, 4627, 104, 494, "Code",ExpressionUUID->"8fd27721-d8d0-4d2b-8ee6-7b51e13db78a"],
Cell[90770, 2371, 256, 6, 37, "Input",ExpressionUUID->"d5e800ee-fa46-4740-b6d4-97793909ced5"],
Cell[91029, 2379, 9448, 202, 1450, "Code",ExpressionUUID->"f32eefd3-b588-40e7-ba5d-354402e9591c"],
Cell[CellGroupData[{
Cell[100502, 2585, 235, 5, 37, "Input",ExpressionUUID->"d29d9378-e47b-4f79-ad75-e38af646cc2b"],
Cell[100740, 2592, 240, 6, 42, "Output",ExpressionUUID->"af225d40-7bd1-4269-b2a8-2df2539bc216"]
}, Open  ]],
Cell[100995, 2601, 8506, 213, 1561, "Code",ExpressionUUID->"e17d62d6-5adb-4a6c-978b-7a32ade9a3c8"],
Cell[CellGroupData[{
Cell[109526, 2818, 394, 11, 37, "Input",ExpressionUUID->"b05abe98-fd0c-4238-87fe-d92993771c50"],
Cell[109923, 2831, 437, 12, 42, "Output",ExpressionUUID->"037838d6-39c1-4e8f-9471-2e70b1a2ea9f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110397, 2848, 590, 12, 116, "Input",ExpressionUUID->"aa47d33a-cdbf-4a61-b46b-c2b197fad0fd"],
Cell[110990, 2862, 249, 4, 42, "Output",ExpressionUUID->"2df3dff0-bfc2-4353-ac5c-622397bcdfec"],
Cell[111242, 2868, 249, 4, 42, "Output",ExpressionUUID->"01c212de-6607-43b9-be7d-310b5c5aa234"],
Cell[111494, 2874, 249, 4, 42, "Output",ExpressionUUID->"34947183-3ba5-4ceb-b54a-acc915a9122e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111780, 2883, 251, 5, 37, "Input",ExpressionUUID->"ac0afd2a-b7b8-41be-9fe5-b45c9a1231c7"],
Cell[112034, 2890, 175, 3, 42, "Output",ExpressionUUID->"3a5248a8-a287-45cc-a393-0522674e2b57"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112246, 2898, 248, 5, 37, "Input",ExpressionUUID->"d0d79c55-0885-40d7-8c38-724f66f8ef60"],
Cell[112497, 2905, 177, 3, 42, "Output",ExpressionUUID->"97c0dd14-e230-4a22-83c2-aeb2b4f2cdac"]
}, Open  ]],
Cell[112689, 2911, 22803, 540, 3660, "Code",ExpressionUUID->"da38e9f0-8159-4954-9e9d-aa705ce0aad9"],
Cell[135495, 3453, 5786, 137, 817, "Code",ExpressionUUID->"6849b25d-ea31-48b3-8d3f-31f9ed8fbac5"],
Cell[CellGroupData[{
Cell[141306, 3594, 778, 15, 64, "Input",ExpressionUUID->"cdf3aa0a-9b06-48b6-898b-82778a169101"],
Cell[142087, 3611, 2872, 85, 101, "Output",ExpressionUUID->"9042e276-5cd5-4427-9daa-3f899f2ba4ea"]
}, Open  ]],
Cell[144974, 3699, 4165, 83, 418, "Code",ExpressionUUID->"43840fc5-eed8-49e0-a79b-9cefe9637d4f"],
Cell[149142, 3784, 19381, 437, 2591, "Code",ExpressionUUID->"12e6674e-4fbf-4ea0-b36f-e460120950af"],
Cell[CellGroupData[{
Cell[168548, 4225, 636, 16, 37, "Input",ExpressionUUID->"99dba830-ccaa-49f6-9e8e-e46c686b5153"],
Cell[169187, 4243, 3877, 126, 101, "Output",ExpressionUUID->"7251a974-7256-4b00-9519-aa9d1522d8e3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173101, 4374, 682, 16, 37, "Input",ExpressionUUID->"54b5cd35-2a97-4aaf-b5aa-1b1ec88103c0"],
Cell[173786, 4392, 1704, 51, 113, "Output",ExpressionUUID->"a1617ce6-ae8b-4163-b4a9-ad46ed08ee80"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175527, 4448, 893, 21, 64, "Input",ExpressionUUID->"8b966f82-b280-4089-9418-8c9a7bd15263"],
Cell[176423, 4471, 9164, 281, 165, "Output",ExpressionUUID->"03381b27-9b75-4c29-9295-c5400db70a0a"]
}, Open  ]],
Cell[185602, 4755, 6472, 135, 684, "Code",ExpressionUUID->"a361d19b-3013-48aa-ab8d-c36660f35b65"],
Cell[192077, 4892, 4872, 112, 471, "Code",ExpressionUUID->"0710ef65-f65c-477f-8796-2ca96ce9ccb2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196998, 5010, 307, 5, 84, "Section",ExpressionUUID->"6ffe5af5-f713-4271-bed7-c8d0992678c9"],
Cell[197308, 5017, 8325, 198, 882, "Code",ExpressionUUID->"b01c757f-9229-42e3-8f3e-3a0bdedbeb93"],
Cell[CellGroupData[{
Cell[205658, 5219, 1271, 40, 65, "Input",ExpressionUUID->"1493daa5-775e-4e46-a0b4-05691e922be2"],
Cell[206932, 5261, 4225, 110, 199, "Output",ExpressionUUID->"f2066ebf-577b-4f97-a810-cd576f9c604f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211194, 5376, 1203, 39, 65, "Input",ExpressionUUID->"ef5873a8-61c3-434c-96e8-1eacae7d0cbb"],
Cell[212400, 5417, 1314, 26, 121, "Output",ExpressionUUID->"c83bc3b0-fa87-4d53-95ee-7e8a1fdc3f75"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[213763, 5449, 353, 6, 84, "Section",ExpressionUUID->"e06a793a-3944-4709-923a-5808c6197e2f"],
Cell[CellGroupData[{
Cell[214141, 5459, 168, 3, 67, "Subsection",ExpressionUUID->"fb18b420-293b-4338-b650-1b6ddbf742bc"],
Cell[214312, 5464, 1527, 42, 274, "Text",ExpressionUUID->"56665d1d-1912-45ac-ba97-33c149083783"],
Cell[215842, 5508, 2299, 59, 273, "Code",ExpressionUUID->"ab21d539-1b8e-4814-ab31-dbf1a55073b5"],
Cell[218144, 5569, 130, 3, 37, "Input",ExpressionUUID->"3204fa87-ba06-4da1-9707-d9c5bcc61fa2"],
Cell[CellGroupData[{
Cell[218299, 5576, 999, 27, 91, "Input",ExpressionUUID->"c8ac940d-702f-45dc-aa1b-0453c679252b"],
Cell[219301, 5605, 910, 28, 43, "Output",ExpressionUUID->"fb3d50c3-adba-497e-b46e-ef30731d7e93"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220248, 5638, 507, 12, 64, "Input",ExpressionUUID->"b3debe16-6ed3-416e-9e8e-b1b42b93a759"],
Cell[220758, 5652, 258, 6, 42, "Output",ExpressionUUID->"db6907bb-7606-4f8c-b62d-ecc81ca6fcf3"],
Cell[221019, 5660, 205, 4, 42, "Output",ExpressionUUID->"1ee2a770-d2cb-4b98-8da3-6bf6c9e41327"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221261, 5669, 643, 17, 91, "Input",ExpressionUUID->"ee3a4be5-56b4-4bc0-a33e-974afb743037"],
Cell[221907, 5688, 342, 9, 43, "Output",ExpressionUUID->"02339499-29e3-493a-97e6-24a895400a98"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222286, 5702, 454, 11, 64, "Input",ExpressionUUID->"0ad6cfff-33bd-4fb6-8c68-082224c3b334"],
Cell[222743, 5715, 228, 4, 42, "Output",ExpressionUUID->"a461aa7b-d0d4-47c2-9779-537a26af4506"],
Cell[222974, 5721, 178, 3, 42, "Output",ExpressionUUID->"3e9eb4ed-e612-43c6-aa44-2331dd4d1044"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223189, 5729, 617, 16, 91, "Input",ExpressionUUID->"a770d7d0-9e6d-4f92-91ec-c88100d2b847"],
Cell[223809, 5747, 316, 9, 43, "Output",ExpressionUUID->"70c2f718-6a64-41be-a07d-11bd686d5fc8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224162, 5761, 454, 11, 64, "Input",ExpressionUUID->"a0ea07ef-2c04-4e9d-bc73-3e0c1bb179dc"],
Cell[224619, 5774, 209, 5, 42, "Output",ExpressionUUID->"8e54834f-1883-43e6-b283-3cb1510123f5"],
Cell[224831, 5781, 153, 2, 42, "Output",ExpressionUUID->"c1f33026-6dda-4965-ad96-e1a070973667"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[225033, 5789, 277, 4, 46, "Subsection",ExpressionUUID->"97bf0781-6699-4c10-93f9-80aed0b58dc0"],
Cell[225313, 5795, 6225, 155, 687, "Code",ExpressionUUID->"bfe03cf6-0191-49d2-a179-3d9afd2cb8d0"],
Cell[231541, 5952, 922, 29, 41, "Input",ExpressionUUID->"5c018f5c-c519-4b59-99f7-f19a6da3cb83"],
Cell[232466, 5983, 733, 24, 41, "Input",ExpressionUUID->"f6483205-75ae-4b04-a16d-c235e41adad6"],
Cell[CellGroupData[{
Cell[233224, 6011, 218, 4, 37, "Input",ExpressionUUID->"d73c72ac-e837-48e4-be30-d69bb93624c0"],
Cell[233445, 6017, 1131, 34, 46, "Output",ExpressionUUID->"59a5310e-b1b6-4263-a9a1-549227bd3d3d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234613, 6056, 1050, 33, 41, "Input",ExpressionUUID->"1203c425-8556-4ae8-8d9b-1e15781f665f"],
Cell[235666, 6091, 336, 11, 43, "Output",ExpressionUUID->"6cf9cc12-4594-4c71-b1cd-c275be5f81e7"]
}, Open  ]],
Cell[236017, 6105, 2190, 49, 287, "Code",ExpressionUUID->"c4ed4f01-df02-4d21-9548-6ee50cea53d4"],
Cell[238210, 6156, 1964, 44, 193, "Code",ExpressionUUID->"add395aa-eddf-4903-831a-86e0d3e75cd0"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[240223, 6206, 409, 5, 65, "Section",ExpressionUUID->"535884c1-6f13-4052-b8d4-c10cca0a0bb0"],
Cell[240635, 6213, 787, 23, 131, "Text",ExpressionUUID->"025a88af-0feb-4d8e-abae-387dd91657ff"],
Cell[CellGroupData[{
Cell[241447, 6240, 320, 5, 67, "Subsection",ExpressionUUID->"3c791ca7-85d0-43ec-9580-facf2b61bd4b"],
Cell[241770, 6247, 889, 28, 44, "Text",ExpressionUUID->"41e0e93d-9f0f-4434-9580-91dc8770380b",
 InitializationCell->True],
Cell[242662, 6277, 1968, 43, 330, "Code",ExpressionUUID->"13920dfb-3342-468d-b0d5-cc7f0c63938e"],
Cell[CellGroupData[{
Cell[244655, 6324, 941, 29, 90, "Input",ExpressionUUID->"797f501c-b548-490f-9fe1-a81ee07074e8"],
Cell[245599, 6355, 878, 27, 43, "Output",ExpressionUUID->"55817788-7aae-45ba-bd8e-f1fb6477774a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246514, 6387, 252, 5, 37, "Input",ExpressionUUID->"46d69b6a-fc9b-4b27-b18d-0cb1d1b63567"],
Cell[246769, 6394, 391, 11, 42, "Output",ExpressionUUID->"dceaa6bd-1dfd-4c65-9dfa-df72f628e60e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[247197, 6410, 885, 24, 66, "Input",ExpressionUUID->"e53af68c-b083-4ad6-a783-c9adb6199f8b"],
Cell[248085, 6436, 9552, 297, 322, "Output",ExpressionUUID->"0cbdfd3b-7977-4f6c-968d-ac6a9292f234"]
}, Open  ]],
Cell[CellGroupData[{
Cell[257674, 6738, 978, 28, 91, "Input",ExpressionUUID->"ad392133-ba06-4b9b-8969-9bd22beb913b"],
Cell[258655, 6768, 10687, 334, 330, "Output",ExpressionUUID->"0125c4cb-75ac-4076-a907-12a43fdf3ed1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269379, 7107, 282, 6, 37, "Input",ExpressionUUID->"d4df5f8b-88b0-4fc1-a2a9-8e8ca3ff26e3"],
Cell[269664, 7115, 460, 11, 43, "Output",ExpressionUUID->"d9494b22-6336-4950-b758-652d2bd994bd"]
}, Open  ]],
Cell[CellGroupData[{
Cell[270161, 7131, 540, 16, 41, "Input",ExpressionUUID->"0d3e8ab8-2603-49c3-b452-5c5d46df92ce"],
Cell[270704, 7149, 952, 30, 43, "Output",ExpressionUUID->"e5af0aa3-31a7-4244-975c-8e3648d2b497"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[271705, 7185, 183, 3, 46, "Subsection",ExpressionUUID->"8ca52342-10b7-406a-b387-3612dafc1d04"],
Cell[271891, 7190, 1533, 49, 131, "Text",ExpressionUUID->"30e534ed-ee84-427e-a2be-9b5b6a68328f"],
Cell[273427, 7241, 1903, 40, 231, "Code",ExpressionUUID->"c62697b3-912e-423e-bf0f-db88c36f2f1f"],
Cell[275333, 7283, 359, 9, 37, "Input",ExpressionUUID->"f9e3c803-67dc-45cc-9ca1-78f975d4e0e4"],
Cell[CellGroupData[{
Cell[275717, 7296, 224, 4, 90, "Input",ExpressionUUID->"35a170d5-6122-4c56-a467-7cc8a59d4c77"],
Cell[275944, 7302, 1195, 38, 70, "Output",ExpressionUUID->"dc08a5bb-900d-4bad-8754-b2c81044fd9e"],
Cell[277142, 7342, 384, 11, 43, "Output",ExpressionUUID->"ba501a0a-509c-4e0f-86f2-a348d78f50e6"],
Cell[277529, 7355, 356, 10, 43, "Output",ExpressionUUID->"4aef17b9-7879-4917-95ad-ac195a4628ae"]
}, Open  ]],
Cell[CellGroupData[{
Cell[277922, 7370, 307, 7, 37, "Input",ExpressionUUID->"448cdae0-48ec-4c24-8b20-09411f5d8b4c"],
Cell[278232, 7379, 320, 9, 43, "Output",ExpressionUUID->"3d2a9a78-1555-440b-9cf0-55a6a9663fb1"]
}, Open  ]],
Cell[278567, 7391, 1568, 49, 159, "Text",ExpressionUUID->"4d89010c-218d-4491-8388-b54906f1222f"],
Cell[280138, 7442, 2319, 56, 309, "Code",ExpressionUUID->"39635004-f4cd-4474-aaf1-a90dcb0b0302"],
Cell[282460, 7500, 382, 9, 37, "Input",ExpressionUUID->"7fb526f3-f7c1-4468-9db7-21f87e412da8"],
Cell[CellGroupData[{
Cell[282867, 7513, 247, 4, 90, "Input",ExpressionUUID->"987fc0e7-2946-4d00-bdf5-df965a18d1a7"],
Cell[283117, 7519, 1268, 39, 70, "Output",ExpressionUUID->"9a515ffa-8abf-4979-ae04-3a9d7e96897e"],
Cell[284388, 7560, 454, 12, 43, "Output",ExpressionUUID->"4d3a759a-da93-4cf3-aa4e-128458fd743b"],
Cell[284845, 7574, 426, 11, 43, "Output",ExpressionUUID->"3c5508b6-bb4d-45f6-8cd7-b163298bd8b2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[285308, 7590, 182, 4, 37, "Input",ExpressionUUID->"c4dd5789-1a2b-4c33-bf37-090f21a4dbda"],
Cell[285493, 7596, 356, 10, 43, "Output",ExpressionUUID->"fce0e66b-4f0b-45e2-9f48-e733758d1311"]
}, Open  ]],
Cell[CellGroupData[{
Cell[285886, 7611, 344, 9, 37, "Input",ExpressionUUID->"3b56c4cd-2294-452a-b1a2-369bae84ecc2"],
Cell[286233, 7622, 748, 25, 46, "Output",ExpressionUUID->"4cf3a52c-5b15-49ca-9f24-43cf4e4bea24"]
}, Open  ]],
Cell[CellGroupData[{
Cell[287018, 7652, 217, 4, 37, "Input",ExpressionUUID->"323daaa0-ab6a-48d3-8814-dfb29f50829c"],
Cell[287238, 7658, 821, 26, 46, "Output",ExpressionUUID->"073b0653-0803-4bbc-994b-348c81467ffe"]
}, Open  ]],
Cell[CellGroupData[{
Cell[288096, 7689, 247, 5, 37, "Input",ExpressionUUID->"688b3551-5832-4486-a10c-acf3d0303e9b"],
Cell[288346, 7696, 1118, 37, 46, "Output",ExpressionUUID->"1dccabe1-4eb7-421f-ae9e-735fb396c9d2"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[289513, 7739, 250, 4, 67, "Subsection",ExpressionUUID->"a3a22404-15e3-4ca7-9fa2-dad11e872770"],
Cell[CellGroupData[{
Cell[289788, 7747, 307, 7, 37, "Input",ExpressionUUID->"412711d3-bf8a-4b77-88e7-109c232ac375"],
Cell[290098, 7756, 320, 9, 43, "Output",ExpressionUUID->"ffd19277-01a1-42ca-85be-de513c7a3a49"]
}, Open  ]],
Cell[290433, 7768, 1568, 49, 159, "Text",ExpressionUUID->"0c18cdf0-7842-4afb-b670-c4c4f2ec4a00"],
Cell[292004, 7819, 2047, 49, 298, "Code",ExpressionUUID->"331ec24b-9b42-45b5-a0da-a3975375a6f1"],
Cell[294054, 7870, 382, 9, 37, "Input",ExpressionUUID->"0b573700-4d58-49eb-9a97-32908fc56a04"],
Cell[CellGroupData[{
Cell[294461, 7883, 247, 4, 90, "Input",ExpressionUUID->"3609424c-ea13-4b25-9db7-ed504049f3db"],
Cell[294711, 7889, 1268, 39, 70, "Output",ExpressionUUID->"36441d2e-66fa-43c6-8d18-3ea02a1517bf"],
Cell[295982, 7930, 454, 12, 43, "Output",ExpressionUUID->"483594ee-d438-4100-9b08-a837d84db63e"],
Cell[296439, 7944, 426, 11, 43, "Output",ExpressionUUID->"9d1b4ed2-58eb-4fe6-a3e5-0c926d2c6de3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[296902, 7960, 182, 4, 37, "Input",ExpressionUUID->"f8192eed-a7b6-4452-bbd3-35167136be27"],
Cell[297087, 7966, 356, 10, 43, "Output",ExpressionUUID->"330f08ee-e96e-4a4d-bc0f-6e5c444b6199"]
}, Open  ]],
Cell[CellGroupData[{
Cell[297480, 7981, 344, 9, 37, "Input",ExpressionUUID->"ac51c99c-860b-40e7-b33c-753ace5f6811"],
Cell[297827, 7992, 748, 25, 46, "Output",ExpressionUUID->"33ba505d-f52e-4b6b-9213-ce606f36db8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298612, 8022, 217, 4, 37, "Input",ExpressionUUID->"8cb52a1e-60c8-4685-a68b-5daed83fc71b"],
Cell[298832, 8028, 821, 26, 46, "Output",ExpressionUUID->"2fcf3c32-4587-4e2e-b473-f620c9771a39"]
}, Open  ]],
Cell[CellGroupData[{
Cell[299690, 8059, 247, 5, 37, "Input",ExpressionUUID->"41e93913-bcf6-43cb-b6e2-eb1a5f3023e5"],
Cell[299940, 8066, 1118, 37, 46, "Output",ExpressionUUID->"390ba231-c632-41a6-b539-dd0d2165c247"]
}, Open  ]],
Cell[301073, 8106, 2505, 56, 322, "Code",ExpressionUUID->"1078f37a-856f-42d1-be21-9ced684498cd"],
Cell[CellGroupData[{
Cell[303603, 8166, 1329, 39, 98, "Input",ExpressionUUID->"370daf56-9da7-414e-b51c-40d231bd53a1"],
Cell[304935, 8207, 230, 4, 42, "Output",ExpressionUUID->"fb11f061-a41f-484c-9c22-66d970a3cd71"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[305226, 8218, 451, 7, 84, "Section",ExpressionUUID->"bca37522-e9b5-432a-a0be-ccb7202ea631"],
Cell[305680, 8227, 3421, 78, 554, "Code",ExpressionUUID->"e36f5fc6-4779-4dd2-b633-2de673800a54"],
Cell[309104, 8307, 2295, 54, 310, "Code",ExpressionUUID->"0e63539a-8f97-41aa-8f33-65a1b2862f13"],
Cell[311402, 8363, 1048, 30, 65, "Input",ExpressionUUID->"8ab3f5fc-260f-45fe-8c35-b6985692acf5"],
Cell[CellGroupData[{
Cell[312475, 8397, 1257, 34, 194, "Input",ExpressionUUID->"2776f037-8d5b-4701-9cb4-f2dd9d3a71a8"],
Cell[313735, 8433, 540, 10, 42, "Output",ExpressionUUID->"d51ab59e-f926-4c73-a833-2d8b44adf48d"],
Cell[314278, 8445, 857, 23, 46, "Output",ExpressionUUID->"db548e16-4b58-4493-876a-ffc12a451316"],
Cell[315138, 8470, 857, 23, 46, "Output",ExpressionUUID->"ed032e29-5948-4d0b-82cb-3867bdd897dc"]
}, Open  ]],
Cell[316010, 8496, 1590, 36, 216, "Code",ExpressionUUID->"bfcf5425-25ed-4730-b3b8-da261a3f601c"],
Cell[317603, 8534, 2841, 69, 266, "Code",ExpressionUUID->"afc4de16-3c51-4429-b360-8304ac15b935"],
Cell[320447, 8605, 3035, 73, 266, "Code",ExpressionUUID->"e33020c0-281e-4c03-a373-6bcdadb21f95"],
Cell[CellGroupData[{
Cell[323507, 8682, 388, 9, 64, "Input",ExpressionUUID->"e8c34b32-4d08-47e3-ba6a-4fee4aa2ab82"],
Cell[323898, 8693, 842, 25, 43, "Output",ExpressionUUID->"4b50a8d9-2416-447a-9225-53dccc87c27e"]
}, Open  ]],
Cell[324755, 8721, 3142, 74, 266, "Code",ExpressionUUID->"df4bf76d-b3cb-4c0c-b73f-c84c2d279aaa"],
Cell[327900, 8797, 2174, 48, 240, "Code",ExpressionUUID->"8bbc0edf-618e-43d2-ae3f-467daf3939ac"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330111, 8850, 155, 3, 84, "Section",ExpressionUUID->"32a35fc5-0414-46f2-8f07-adea46ed9ae3"],
Cell[330269, 8855, 3167, 72, 453, "Code",ExpressionUUID->"98d0183b-36d5-4bb8-86bc-f4e3ff8b926b"],
Cell[333439, 8929, 3883, 88, 477, "Code",ExpressionUUID->"8f95c4fc-9c12-4636-9d4f-caec9d953338"],
Cell[337325, 9019, 1505, 39, 221, "Input",ExpressionUUID->"e3997767-edc3-4d17-9866-ce58d22df3fd"],
Cell[338833, 9060, 3448, 82, 455, "Input",ExpressionUUID->"e40e80a1-7117-4099-ad67-a06fcfeae628"],
Cell[CellGroupData[{
Cell[342306, 9146, 456, 9, 37, "Input",ExpressionUUID->"96c70e42-771d-4ad0-b572-c88881a86b6e"],
Cell[342765, 9157, 333, 7, 42, "Output",ExpressionUUID->"d599fae9-efb8-4bb9-a414-8c2011ad3096"]
}, Open  ]],
Cell[343113, 9167, 4677, 105, 529, "Code",ExpressionUUID->"c2f7aa21-7e95-470b-bf59-de8e4dcf5d47"],
Cell[347793, 9274, 3603, 88, 481, "Input",ExpressionUUID->"e6fea111-8ee4-4007-9b20-193da8cc8c74"],
Cell[CellGroupData[{
Cell[351421, 9366, 354, 7, 37, "Input",ExpressionUUID->"6a07c936-7a15-4bd3-87ec-2b516d350b35"],
Cell[351778, 9375, 214, 5, 42, "Output",ExpressionUUID->"594d144c-21e9-4ed9-b8c3-6f3156d3abfd"]
}, Open  ]]
}, Open  ]]
}
]
*)

